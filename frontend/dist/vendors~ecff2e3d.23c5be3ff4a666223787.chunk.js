(window["webpackJsonp"] = window["webpackJsonp"] || []).push([["vendors~ecff2e3d"],{

/***/ "K/SW":
/*!***********************************************************************************!*\
  !*** ./node_modules/aurelia-task-queue/dist/native-modules/aurelia-task-queue.js ***!
  \***********************************************************************************/
/*! exports provided: TaskQueue */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"TaskQueue\", function() { return TaskQueue; });\n/* harmony import */ var aurelia_pal__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! aurelia-pal */ \"70NS\");\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\n\n\n\n\nvar stackSeparator = '\\nEnqueued in TaskQueue by:\\n';\nvar microStackSeparator = '\\nEnqueued in MicroTaskQueue by:\\n';\n\nfunction makeRequestFlushFromMutationObserver(flush) {\n  var observer = aurelia_pal__WEBPACK_IMPORTED_MODULE_0__[\"DOM\"].createMutationObserver(flush);\n  var val = 'a';\n  var node = aurelia_pal__WEBPACK_IMPORTED_MODULE_0__[\"DOM\"].createTextNode('a');\n  var values = Object.create(null);\n  values.a = 'b';\n  values.b = 'a';\n  observer.observe(node, { characterData: true });\n  return function requestFlush() {\n    node.data = val = values[val];\n  };\n}\n\nfunction makeRequestFlushFromTimer(flush) {\n  return function requestFlush() {\n    var timeoutHandle = setTimeout(handleFlushTimer, 0);\n\n    var intervalHandle = setInterval(handleFlushTimer, 50);\n    function handleFlushTimer() {\n      clearTimeout(timeoutHandle);\n      clearInterval(intervalHandle);\n      flush();\n    }\n  };\n}\n\nfunction onError(error, task, longStacks) {\n  if (longStacks && task.stack && (typeof error === 'undefined' ? 'undefined' : _typeof(error)) === 'object' && error !== null) {\n    error.stack = filterFlushStack(error.stack) + task.stack;\n  }\n\n  if ('onError' in task) {\n    task.onError(error);\n  } else {\n    setTimeout(function () {\n      throw error;\n    }, 0);\n  }\n}\n\nvar TaskQueue = function () {\n  function TaskQueue() {\n    var _this = this;\n\n    \n\n    this.flushing = false;\n    this.longStacks = false;\n\n    this.microTaskQueue = [];\n    this.microTaskQueueCapacity = 1024;\n    this.taskQueue = [];\n\n    if (aurelia_pal__WEBPACK_IMPORTED_MODULE_0__[\"FEATURE\"].mutationObserver) {\n      this.requestFlushMicroTaskQueue = makeRequestFlushFromMutationObserver(function () {\n        return _this.flushMicroTaskQueue();\n      });\n    } else {\n      this.requestFlushMicroTaskQueue = makeRequestFlushFromTimer(function () {\n        return _this.flushMicroTaskQueue();\n      });\n    }\n\n    this.requestFlushTaskQueue = makeRequestFlushFromTimer(function () {\n      return _this.flushTaskQueue();\n    });\n  }\n\n  TaskQueue.prototype._flushQueue = function _flushQueue(queue, capacity) {\n    var index = 0;\n    var task = void 0;\n\n    try {\n      this.flushing = true;\n      while (index < queue.length) {\n        task = queue[index];\n        if (this.longStacks) {\n          this.stack = typeof task.stack === 'string' ? task.stack : undefined;\n        }\n        task.call();\n        index++;\n\n        if (index > capacity) {\n          for (var scan = 0, newLength = queue.length - index; scan < newLength; scan++) {\n            queue[scan] = queue[scan + index];\n          }\n\n          queue.length -= index;\n          index = 0;\n        }\n      }\n    } catch (error) {\n      onError(error, task, this.longStacks);\n    } finally {\n      this.flushing = false;\n    }\n  };\n\n  TaskQueue.prototype.queueMicroTask = function queueMicroTask(task) {\n    if (this.microTaskQueue.length < 1) {\n      this.requestFlushMicroTaskQueue();\n    }\n\n    if (this.longStacks) {\n      task.stack = this.prepareQueueStack(microStackSeparator);\n    }\n\n    this.microTaskQueue.push(task);\n  };\n\n  TaskQueue.prototype.queueTask = function queueTask(task) {\n    if (this.taskQueue.length < 1) {\n      this.requestFlushTaskQueue();\n    }\n\n    if (this.longStacks) {\n      task.stack = this.prepareQueueStack(stackSeparator);\n    }\n\n    this.taskQueue.push(task);\n  };\n\n  TaskQueue.prototype.flushTaskQueue = function flushTaskQueue() {\n    var queue = this.taskQueue;\n    this.taskQueue = [];\n    this._flushQueue(queue, Number.MAX_VALUE);\n  };\n\n  TaskQueue.prototype.flushMicroTaskQueue = function flushMicroTaskQueue() {\n    var queue = this.microTaskQueue;\n    this._flushQueue(queue, this.microTaskQueueCapacity);\n    queue.length = 0;\n  };\n\n  TaskQueue.prototype.prepareQueueStack = function prepareQueueStack(separator) {\n    var stack = separator + filterQueueStack(captureStack());\n\n    if (typeof this.stack === 'string') {\n      stack = filterFlushStack(stack) + this.stack;\n    }\n\n    return stack;\n  };\n\n  return TaskQueue;\n}();\n\nfunction captureStack() {\n  var error = new Error();\n\n  if (error.stack) {\n    return error.stack;\n  }\n\n  try {\n    throw error;\n  } catch (e) {\n    return e.stack;\n  }\n}\n\nfunction filterQueueStack(stack) {\n  return stack.replace(/^[\\s\\S]*?\\bqueue(Micro)?Task\\b[^\\n]*\\n/, '');\n}\n\nfunction filterFlushStack(stack) {\n  var index = stack.lastIndexOf('flushMicroTaskQueue');\n\n  if (index < 0) {\n    index = stack.lastIndexOf('flushTaskQueue');\n    if (index < 0) {\n      return stack;\n    }\n  }\n\n  index = stack.lastIndexOf('\\n', index);\n\n  return index < 0 ? stack : stack.substr(0, index);\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiSy9TVy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9hdXJlbGlhLXRhc2stcXVldWUvZGlzdC9uYXRpdmUtbW9kdWxlcy9hdXJlbGlhLXRhc2stcXVldWUuanM/MmJmNCJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgX3R5cGVvZiA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID09PSBcInN5bWJvbFwiID8gZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gdHlwZW9mIG9iajsgfSA6IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gXCJzeW1ib2xcIiA6IHR5cGVvZiBvYmo7IH07XG5cblxuXG5pbXBvcnQgeyBET00sIEZFQVRVUkUgfSBmcm9tICdhdXJlbGlhLXBhbCc7XG5cbnZhciBzdGFja1NlcGFyYXRvciA9ICdcXG5FbnF1ZXVlZCBpbiBUYXNrUXVldWUgYnk6XFxuJztcbnZhciBtaWNyb1N0YWNrU2VwYXJhdG9yID0gJ1xcbkVucXVldWVkIGluIE1pY3JvVGFza1F1ZXVlIGJ5Olxcbic7XG5cbmZ1bmN0aW9uIG1ha2VSZXF1ZXN0Rmx1c2hGcm9tTXV0YXRpb25PYnNlcnZlcihmbHVzaCkge1xuICB2YXIgb2JzZXJ2ZXIgPSBET00uY3JlYXRlTXV0YXRpb25PYnNlcnZlcihmbHVzaCk7XG4gIHZhciB2YWwgPSAnYSc7XG4gIHZhciBub2RlID0gRE9NLmNyZWF0ZVRleHROb2RlKCdhJyk7XG4gIHZhciB2YWx1ZXMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuICB2YWx1ZXMuYSA9ICdiJztcbiAgdmFsdWVzLmIgPSAnYSc7XG4gIG9ic2VydmVyLm9ic2VydmUobm9kZSwgeyBjaGFyYWN0ZXJEYXRhOiB0cnVlIH0pO1xuICByZXR1cm4gZnVuY3Rpb24gcmVxdWVzdEZsdXNoKCkge1xuICAgIG5vZGUuZGF0YSA9IHZhbCA9IHZhbHVlc1t2YWxdO1xuICB9O1xufVxuXG5mdW5jdGlvbiBtYWtlUmVxdWVzdEZsdXNoRnJvbVRpbWVyKGZsdXNoKSB7XG4gIHJldHVybiBmdW5jdGlvbiByZXF1ZXN0Rmx1c2goKSB7XG4gICAgdmFyIHRpbWVvdXRIYW5kbGUgPSBzZXRUaW1lb3V0KGhhbmRsZUZsdXNoVGltZXIsIDApO1xuXG4gICAgdmFyIGludGVydmFsSGFuZGxlID0gc2V0SW50ZXJ2YWwoaGFuZGxlRmx1c2hUaW1lciwgNTApO1xuICAgIGZ1bmN0aW9uIGhhbmRsZUZsdXNoVGltZXIoKSB7XG4gICAgICBjbGVhclRpbWVvdXQodGltZW91dEhhbmRsZSk7XG4gICAgICBjbGVhckludGVydmFsKGludGVydmFsSGFuZGxlKTtcbiAgICAgIGZsdXNoKCk7XG4gICAgfVxuICB9O1xufVxuXG5mdW5jdGlvbiBvbkVycm9yKGVycm9yLCB0YXNrLCBsb25nU3RhY2tzKSB7XG4gIGlmIChsb25nU3RhY2tzICYmIHRhc2suc3RhY2sgJiYgKHR5cGVvZiBlcnJvciA9PT0gJ3VuZGVmaW5lZCcgPyAndW5kZWZpbmVkJyA6IF90eXBlb2YoZXJyb3IpKSA9PT0gJ29iamVjdCcgJiYgZXJyb3IgIT09IG51bGwpIHtcbiAgICBlcnJvci5zdGFjayA9IGZpbHRlckZsdXNoU3RhY2soZXJyb3Iuc3RhY2spICsgdGFzay5zdGFjaztcbiAgfVxuXG4gIGlmICgnb25FcnJvcicgaW4gdGFzaykge1xuICAgIHRhc2sub25FcnJvcihlcnJvcik7XG4gIH0gZWxzZSB7XG4gICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9LCAwKTtcbiAgfVxufVxuXG5leHBvcnQgdmFyIFRhc2tRdWV1ZSA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gVGFza1F1ZXVlKCkge1xuICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgICBcblxuICAgIHRoaXMuZmx1c2hpbmcgPSBmYWxzZTtcbiAgICB0aGlzLmxvbmdTdGFja3MgPSBmYWxzZTtcblxuICAgIHRoaXMubWljcm9UYXNrUXVldWUgPSBbXTtcbiAgICB0aGlzLm1pY3JvVGFza1F1ZXVlQ2FwYWNpdHkgPSAxMDI0O1xuICAgIHRoaXMudGFza1F1ZXVlID0gW107XG5cbiAgICBpZiAoRkVBVFVSRS5tdXRhdGlvbk9ic2VydmVyKSB7XG4gICAgICB0aGlzLnJlcXVlc3RGbHVzaE1pY3JvVGFza1F1ZXVlID0gbWFrZVJlcXVlc3RGbHVzaEZyb21NdXRhdGlvbk9ic2VydmVyKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIF90aGlzLmZsdXNoTWljcm9UYXNrUXVldWUoKTtcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnJlcXVlc3RGbHVzaE1pY3JvVGFza1F1ZXVlID0gbWFrZVJlcXVlc3RGbHVzaEZyb21UaW1lcihmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBfdGhpcy5mbHVzaE1pY3JvVGFza1F1ZXVlKCk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICB0aGlzLnJlcXVlc3RGbHVzaFRhc2tRdWV1ZSA9IG1ha2VSZXF1ZXN0Rmx1c2hGcm9tVGltZXIoZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIF90aGlzLmZsdXNoVGFza1F1ZXVlKCk7XG4gICAgfSk7XG4gIH1cblxuICBUYXNrUXVldWUucHJvdG90eXBlLl9mbHVzaFF1ZXVlID0gZnVuY3Rpb24gX2ZsdXNoUXVldWUocXVldWUsIGNhcGFjaXR5KSB7XG4gICAgdmFyIGluZGV4ID0gMDtcbiAgICB2YXIgdGFzayA9IHZvaWQgMDtcblxuICAgIHRyeSB7XG4gICAgICB0aGlzLmZsdXNoaW5nID0gdHJ1ZTtcbiAgICAgIHdoaWxlIChpbmRleCA8IHF1ZXVlLmxlbmd0aCkge1xuICAgICAgICB0YXNrID0gcXVldWVbaW5kZXhdO1xuICAgICAgICBpZiAodGhpcy5sb25nU3RhY2tzKSB7XG4gICAgICAgICAgdGhpcy5zdGFjayA9IHR5cGVvZiB0YXNrLnN0YWNrID09PSAnc3RyaW5nJyA/IHRhc2suc3RhY2sgOiB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgICAgdGFzay5jYWxsKCk7XG4gICAgICAgIGluZGV4Kys7XG5cbiAgICAgICAgaWYgKGluZGV4ID4gY2FwYWNpdHkpIHtcbiAgICAgICAgICBmb3IgKHZhciBzY2FuID0gMCwgbmV3TGVuZ3RoID0gcXVldWUubGVuZ3RoIC0gaW5kZXg7IHNjYW4gPCBuZXdMZW5ndGg7IHNjYW4rKykge1xuICAgICAgICAgICAgcXVldWVbc2Nhbl0gPSBxdWV1ZVtzY2FuICsgaW5kZXhdO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHF1ZXVlLmxlbmd0aCAtPSBpbmRleDtcbiAgICAgICAgICBpbmRleCA9IDA7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgb25FcnJvcihlcnJvciwgdGFzaywgdGhpcy5sb25nU3RhY2tzKTtcbiAgICB9IGZpbmFsbHkge1xuICAgICAgdGhpcy5mbHVzaGluZyA9IGZhbHNlO1xuICAgIH1cbiAgfTtcblxuICBUYXNrUXVldWUucHJvdG90eXBlLnF1ZXVlTWljcm9UYXNrID0gZnVuY3Rpb24gcXVldWVNaWNyb1Rhc2sodGFzaykge1xuICAgIGlmICh0aGlzLm1pY3JvVGFza1F1ZXVlLmxlbmd0aCA8IDEpIHtcbiAgICAgIHRoaXMucmVxdWVzdEZsdXNoTWljcm9UYXNrUXVldWUoKTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5sb25nU3RhY2tzKSB7XG4gICAgICB0YXNrLnN0YWNrID0gdGhpcy5wcmVwYXJlUXVldWVTdGFjayhtaWNyb1N0YWNrU2VwYXJhdG9yKTtcbiAgICB9XG5cbiAgICB0aGlzLm1pY3JvVGFza1F1ZXVlLnB1c2godGFzayk7XG4gIH07XG5cbiAgVGFza1F1ZXVlLnByb3RvdHlwZS5xdWV1ZVRhc2sgPSBmdW5jdGlvbiBxdWV1ZVRhc2sodGFzaykge1xuICAgIGlmICh0aGlzLnRhc2tRdWV1ZS5sZW5ndGggPCAxKSB7XG4gICAgICB0aGlzLnJlcXVlc3RGbHVzaFRhc2tRdWV1ZSgpO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmxvbmdTdGFja3MpIHtcbiAgICAgIHRhc2suc3RhY2sgPSB0aGlzLnByZXBhcmVRdWV1ZVN0YWNrKHN0YWNrU2VwYXJhdG9yKTtcbiAgICB9XG5cbiAgICB0aGlzLnRhc2tRdWV1ZS5wdXNoKHRhc2spO1xuICB9O1xuXG4gIFRhc2tRdWV1ZS5wcm90b3R5cGUuZmx1c2hUYXNrUXVldWUgPSBmdW5jdGlvbiBmbHVzaFRhc2tRdWV1ZSgpIHtcbiAgICB2YXIgcXVldWUgPSB0aGlzLnRhc2tRdWV1ZTtcbiAgICB0aGlzLnRhc2tRdWV1ZSA9IFtdO1xuICAgIHRoaXMuX2ZsdXNoUXVldWUocXVldWUsIE51bWJlci5NQVhfVkFMVUUpO1xuICB9O1xuXG4gIFRhc2tRdWV1ZS5wcm90b3R5cGUuZmx1c2hNaWNyb1Rhc2tRdWV1ZSA9IGZ1bmN0aW9uIGZsdXNoTWljcm9UYXNrUXVldWUoKSB7XG4gICAgdmFyIHF1ZXVlID0gdGhpcy5taWNyb1Rhc2tRdWV1ZTtcbiAgICB0aGlzLl9mbHVzaFF1ZXVlKHF1ZXVlLCB0aGlzLm1pY3JvVGFza1F1ZXVlQ2FwYWNpdHkpO1xuICAgIHF1ZXVlLmxlbmd0aCA9IDA7XG4gIH07XG5cbiAgVGFza1F1ZXVlLnByb3RvdHlwZS5wcmVwYXJlUXVldWVTdGFjayA9IGZ1bmN0aW9uIHByZXBhcmVRdWV1ZVN0YWNrKHNlcGFyYXRvcikge1xuICAgIHZhciBzdGFjayA9IHNlcGFyYXRvciArIGZpbHRlclF1ZXVlU3RhY2soY2FwdHVyZVN0YWNrKCkpO1xuXG4gICAgaWYgKHR5cGVvZiB0aGlzLnN0YWNrID09PSAnc3RyaW5nJykge1xuICAgICAgc3RhY2sgPSBmaWx0ZXJGbHVzaFN0YWNrKHN0YWNrKSArIHRoaXMuc3RhY2s7XG4gICAgfVxuXG4gICAgcmV0dXJuIHN0YWNrO1xuICB9O1xuXG4gIHJldHVybiBUYXNrUXVldWU7XG59KCk7XG5cbmZ1bmN0aW9uIGNhcHR1cmVTdGFjaygpIHtcbiAgdmFyIGVycm9yID0gbmV3IEVycm9yKCk7XG5cbiAgaWYgKGVycm9yLnN0YWNrKSB7XG4gICAgcmV0dXJuIGVycm9yLnN0YWNrO1xuICB9XG5cbiAgdHJ5IHtcbiAgICB0aHJvdyBlcnJvcjtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHJldHVybiBlLnN0YWNrO1xuICB9XG59XG5cbmZ1bmN0aW9uIGZpbHRlclF1ZXVlU3RhY2soc3RhY2spIHtcbiAgcmV0dXJuIHN0YWNrLnJlcGxhY2UoL15bXFxzXFxTXSo/XFxicXVldWUoTWljcm8pP1Rhc2tcXGJbXlxcbl0qXFxuLywgJycpO1xufVxuXG5mdW5jdGlvbiBmaWx0ZXJGbHVzaFN0YWNrKHN0YWNrKSB7XG4gIHZhciBpbmRleCA9IHN0YWNrLmxhc3RJbmRleE9mKCdmbHVzaE1pY3JvVGFza1F1ZXVlJyk7XG5cbiAgaWYgKGluZGV4IDwgMCkge1xuICAgIGluZGV4ID0gc3RhY2subGFzdEluZGV4T2YoJ2ZsdXNoVGFza1F1ZXVlJyk7XG4gICAgaWYgKGluZGV4IDwgMCkge1xuICAgICAgcmV0dXJuIHN0YWNrO1xuICAgIH1cbiAgfVxuXG4gIGluZGV4ID0gc3RhY2subGFzdEluZGV4T2YoJ1xcbicsIGluZGV4KTtcblxuICByZXR1cm4gaW5kZXggPCAwID8gc3RhY2sgOiBzdGFjay5zdWJzdHIoMCwgaW5kZXgpO1xufSJdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///K/SW\n");

/***/ }),

/***/ "aurelia-templating-binding":
/*!***************************************************************************************************!*\
  !*** ./node_modules/aurelia-templating-binding/dist/native-modules/aurelia-templating-binding.js ***!
  \***************************************************************************************************/
/*! exports provided: AttributeMap, ChildInterpolationBinding, InterpolationBinding, InterpolationBindingExpression, LetBinding, LetExpression, LetInterpolationBinding, LetInterpolationBindingExpression, SyntaxInterpreter, TemplatingBindingLanguage, configure */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"AttributeMap\", function() { return AttributeMap; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ChildInterpolationBinding\", function() { return ChildInterpolationBinding; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"InterpolationBinding\", function() { return InterpolationBinding; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"InterpolationBindingExpression\", function() { return InterpolationBindingExpression; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"LetBinding\", function() { return LetBinding; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"LetExpression\", function() { return LetExpression; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"LetInterpolationBinding\", function() { return LetInterpolationBinding; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"LetInterpolationBindingExpression\", function() { return LetInterpolationBindingExpression; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SyntaxInterpreter\", function() { return SyntaxInterpreter; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"TemplatingBindingLanguage\", function() { return TemplatingBindingLanguage; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"configure\", function() { return configure; });\n/* harmony import */ var aurelia_templating__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! aurelia-templating */ \"hij8\");\n/* harmony import */ var aurelia_binding__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! aurelia-binding */ \"X5gX\");\n/* harmony import */ var aurelia_logging__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! aurelia-logging */ \"MP1E\");\n\n\n\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nfunction __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nfunction __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\n\nvar AttributeMap = (function () {\r\n    function AttributeMap(svg) {\r\n        this.elements = Object.create(null);\r\n        this.allElements = Object.create(null);\r\n        this.svg = svg;\r\n        this.registerUniversal('accesskey', 'accessKey');\r\n        this.registerUniversal('contenteditable', 'contentEditable');\r\n        this.registerUniversal('tabindex', 'tabIndex');\r\n        this.registerUniversal('textcontent', 'textContent');\r\n        this.registerUniversal('innerhtml', 'innerHTML');\r\n        this.registerUniversal('scrolltop', 'scrollTop');\r\n        this.registerUniversal('scrollleft', 'scrollLeft');\r\n        this.registerUniversal('readonly', 'readOnly');\r\n        this.register('label', 'for', 'htmlFor');\r\n        this.register('img', 'usemap', 'useMap');\r\n        this.register('input', 'maxlength', 'maxLength');\r\n        this.register('input', 'minlength', 'minLength');\r\n        this.register('input', 'formaction', 'formAction');\r\n        this.register('input', 'formenctype', 'formEncType');\r\n        this.register('input', 'formmethod', 'formMethod');\r\n        this.register('input', 'formnovalidate', 'formNoValidate');\r\n        this.register('input', 'formtarget', 'formTarget');\r\n        this.register('textarea', 'maxlength', 'maxLength');\r\n        this.register('td', 'rowspan', 'rowSpan');\r\n        this.register('td', 'colspan', 'colSpan');\r\n        this.register('th', 'rowspan', 'rowSpan');\r\n        this.register('th', 'colspan', 'colSpan');\r\n    }\r\n    AttributeMap.prototype.register = function (elementName, attributeName, propertyName) {\r\n        elementName = elementName.toLowerCase();\r\n        attributeName = attributeName.toLowerCase();\r\n        var element = this.elements[elementName] = (this.elements[elementName] || Object.create(null));\r\n        element[attributeName] = propertyName;\r\n    };\r\n    AttributeMap.prototype.registerUniversal = function (attributeName, propertyName) {\r\n        attributeName = attributeName.toLowerCase();\r\n        this.allElements[attributeName] = propertyName;\r\n    };\r\n    AttributeMap.prototype.map = function (elementName, attributeName) {\r\n        if (this.svg.isStandardSvgAttribute(elementName, attributeName)) {\r\n            return attributeName;\r\n        }\r\n        elementName = elementName.toLowerCase();\r\n        attributeName = attributeName.toLowerCase();\r\n        var element = this.elements[elementName];\r\n        if (element !== undefined && attributeName in element) {\r\n            return element[attributeName];\r\n        }\r\n        if (attributeName in this.allElements) {\r\n            return this.allElements[attributeName];\r\n        }\r\n        if (/(?:^data-)|(?:^aria-)|:/.test(attributeName)) {\r\n            return attributeName;\r\n        }\r\n        return Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"camelCase\"])(attributeName);\r\n    };\r\n    AttributeMap.inject = [aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"SVGAnalyzer\"]];\r\n    return AttributeMap;\r\n}());\n\nvar InterpolationBindingExpression = (function () {\r\n    function InterpolationBindingExpression(observerLocator, targetProperty, parts, mode, lookupFunctions, attribute) {\r\n        this.observerLocator = observerLocator;\r\n        this.targetProperty = targetProperty;\r\n        this.parts = parts;\r\n        this.mode = mode;\r\n        this.lookupFunctions = lookupFunctions;\r\n        this.attribute = this.attrToRemove = attribute;\r\n        this.discrete = false;\r\n    }\r\n    InterpolationBindingExpression.prototype.createBinding = function (target) {\r\n        if (this.parts.length === 3) {\r\n            return new ChildInterpolationBinding(target, this.observerLocator, this.parts[1], this.mode, this.lookupFunctions, this.targetProperty, this.parts[0], this.parts[2]);\r\n        }\r\n        return new InterpolationBinding(this.observerLocator, this.parts, target, this.targetProperty, this.mode, this.lookupFunctions);\r\n    };\r\n    return InterpolationBindingExpression;\r\n}());\r\nfunction validateTarget(target, propertyName) {\r\n    if (propertyName === 'style') {\r\n        aurelia_logging__WEBPACK_IMPORTED_MODULE_2__[\"getLogger\"]('templating-binding')\r\n            .info('Internet Explorer does not support interpolation in \"style\" attributes.  Use the style attribute\\'s alias, \"css\" instead.');\r\n    }\r\n    else if (target.parentElement && target.parentElement.nodeName === 'TEXTAREA' && propertyName === 'textContent') {\r\n        throw new Error('Interpolation binding cannot be used in the content of a textarea element.  Use <textarea value.bind=\"expression\"></textarea> instead.');\r\n    }\r\n}\r\nvar InterpolationBinding = (function () {\r\n    function InterpolationBinding(observerLocator, parts, target, targetProperty, mode, lookupFunctions) {\r\n        validateTarget(target, targetProperty);\r\n        this.observerLocator = observerLocator;\r\n        this.parts = parts;\r\n        this.target = target;\r\n        this.targetProperty = targetProperty;\r\n        this.targetAccessor = observerLocator.getAccessor(target, targetProperty);\r\n        this.mode = mode;\r\n        this.lookupFunctions = lookupFunctions;\r\n    }\r\n    InterpolationBinding.prototype.interpolate = function () {\r\n        if (this.isBound) {\r\n            var value = '';\r\n            var parts = this.parts;\r\n            for (var i = 0, ii = parts.length; i < ii; i++) {\r\n                value += (i % 2 === 0 ? parts[i] : this[\"childBinding\".concat(i)].value);\r\n            }\r\n            this.targetAccessor.setValue(value, this.target, this.targetProperty);\r\n        }\r\n    };\r\n    InterpolationBinding.prototype.updateOneTimeBindings = function () {\r\n        for (var i = 1, ii = this.parts.length; i < ii; i += 2) {\r\n            var child = this[\"childBinding\".concat(i)];\r\n            if (child.mode === aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"bindingMode\"].oneTime) {\r\n                child.call();\r\n            }\r\n        }\r\n    };\r\n    InterpolationBinding.prototype.bind = function (source) {\r\n        if (this.isBound) {\r\n            if (this.source === source) {\r\n                return;\r\n            }\r\n            this.unbind();\r\n        }\r\n        this.source = source;\r\n        var parts = this.parts;\r\n        for (var i = 1, ii = parts.length; i < ii; i += 2) {\r\n            var binding = new ChildInterpolationBinding(this, this.observerLocator, parts[i], this.mode, this.lookupFunctions);\r\n            binding.bind(source);\r\n            this[\"childBinding\".concat(i)] = binding;\r\n        }\r\n        this.isBound = true;\r\n        this.interpolate();\r\n    };\r\n    InterpolationBinding.prototype.unbind = function () {\r\n        if (!this.isBound) {\r\n            return;\r\n        }\r\n        this.isBound = false;\r\n        this.source = null;\r\n        var parts = this.parts;\r\n        for (var i = 1, ii = parts.length; i < ii; i += 2) {\r\n            var name_1 = \"childBinding\".concat(i);\r\n            this[name_1].unbind();\r\n        }\r\n    };\r\n    return InterpolationBinding;\r\n}());\r\nvar ChildInterpolationBinding = (function () {\r\n    function ChildInterpolationBinding(target, observerLocator, sourceExpression, mode, lookupFunctions, targetProperty, left, right) {\r\n        if (target instanceof InterpolationBinding) {\r\n            this.parent = target;\r\n        }\r\n        else {\r\n            validateTarget(target, targetProperty);\r\n            this.target = target;\r\n            this.targetProperty = targetProperty;\r\n            this.targetAccessor = observerLocator.getAccessor(target, targetProperty);\r\n        }\r\n        this.observerLocator = observerLocator;\r\n        this.sourceExpression = sourceExpression;\r\n        this.mode = mode;\r\n        this.lookupFunctions = lookupFunctions;\r\n        this.left = left;\r\n        this.right = right;\r\n    }\r\n    ChildInterpolationBinding.prototype.updateTarget = function (value) {\r\n        value = value === null || value === undefined ? '' : value.toString();\r\n        if (value !== this.value) {\r\n            this.value = value;\r\n            if (this.parent) {\r\n                this.parent.interpolate();\r\n            }\r\n            else {\r\n                this.targetAccessor.setValue(this.left + value + this.right, this.target, this.targetProperty);\r\n            }\r\n        }\r\n    };\r\n    ChildInterpolationBinding.prototype.call = function () {\r\n        if (!this.isBound) {\r\n            return;\r\n        }\r\n        this.rawValue = this.sourceExpression.evaluate(this.source, this.lookupFunctions);\r\n        this.updateTarget(this.rawValue);\r\n        if (this.mode !== aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"bindingMode\"].oneTime) {\r\n            this._version++;\r\n            this.sourceExpression.connect(this, this.source);\r\n            if (this.rawValue instanceof Array) {\r\n                this.observeArray(this.rawValue);\r\n            }\r\n            this.unobserve(false);\r\n        }\r\n    };\r\n    ChildInterpolationBinding.prototype.bind = function (source) {\r\n        if (this.isBound) {\r\n            if (this.source === source) {\r\n                return;\r\n            }\r\n            this.unbind();\r\n        }\r\n        this.isBound = true;\r\n        this.source = source;\r\n        var sourceExpression = this.sourceExpression;\r\n        if (sourceExpression.bind) {\r\n            sourceExpression.bind(this, source, this.lookupFunctions);\r\n        }\r\n        this.rawValue = sourceExpression.evaluate(source, this.lookupFunctions);\r\n        this.updateTarget(this.rawValue);\r\n        if (this.mode === aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"bindingMode\"].oneWay) {\r\n            Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"enqueueBindingConnect\"])(this);\r\n        }\r\n    };\r\n    ChildInterpolationBinding.prototype.unbind = function () {\r\n        if (!this.isBound) {\r\n            return;\r\n        }\r\n        this.isBound = false;\r\n        var sourceExpression = this.sourceExpression;\r\n        if (sourceExpression.unbind) {\r\n            sourceExpression.unbind(this, this.source);\r\n        }\r\n        this.source = null;\r\n        this.value = null;\r\n        this.rawValue = null;\r\n        this.unobserve(true);\r\n    };\r\n    ChildInterpolationBinding.prototype.connect = function (evaluate) {\r\n        if (!this.isBound) {\r\n            return;\r\n        }\r\n        if (evaluate) {\r\n            this.rawValue = this.sourceExpression.evaluate(this.source, this.lookupFunctions);\r\n            this.updateTarget(this.rawValue);\r\n        }\r\n        this.sourceExpression.connect(this, this.source);\r\n        if (this.rawValue instanceof Array) {\r\n            this.observeArray(this.rawValue);\r\n        }\r\n    };\r\n    ChildInterpolationBinding = __decorate([\r\n        Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"connectable\"])()\r\n    ], ChildInterpolationBinding);\r\n    return ChildInterpolationBinding;\r\n}());\n\nvar LetExpression = (function () {\r\n    function LetExpression(observerLocator, targetProperty, sourceExpression, lookupFunctions, toBindingContext) {\r\n        this.observerLocator = observerLocator;\r\n        this.sourceExpression = sourceExpression;\r\n        this.targetProperty = targetProperty;\r\n        this.lookupFunctions = lookupFunctions;\r\n        this.toBindingContext = toBindingContext;\r\n    }\r\n    LetExpression.prototype.createBinding = function () {\r\n        return new LetBinding(this.observerLocator, this.sourceExpression, this.targetProperty, this.lookupFunctions, this.toBindingContext);\r\n    };\r\n    return LetExpression;\r\n}());\r\nvar LetBinding = (function () {\r\n    function LetBinding(observerLocator, sourceExpression, targetProperty, lookupFunctions, toBindingContext) {\r\n        this.observerLocator = observerLocator;\r\n        this.sourceExpression = sourceExpression;\r\n        this.targetProperty = targetProperty;\r\n        this.lookupFunctions = lookupFunctions;\r\n        this.source = null;\r\n        this.target = null;\r\n        this.toBindingContext = toBindingContext;\r\n    }\r\n    LetBinding.prototype.updateTarget = function () {\r\n        var value = this.sourceExpression.evaluate(this.source, this.lookupFunctions);\r\n        this.target[this.targetProperty] = value;\r\n    };\r\n    LetBinding.prototype.call = function (context) {\r\n        if (!this.isBound) {\r\n            return;\r\n        }\r\n        if (context === aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"sourceContext\"]) {\r\n            this.updateTarget();\r\n            return;\r\n        }\r\n        throw new Error(\"Unexpected call context \".concat(context));\r\n    };\r\n    LetBinding.prototype.bind = function (source) {\r\n        if (this.isBound) {\r\n            if (this.source === source) {\r\n                return;\r\n            }\r\n            this.unbind();\r\n        }\r\n        this.isBound = true;\r\n        this.source = source;\r\n        this.target = this.toBindingContext ? source.bindingContext : source.overrideContext;\r\n        if (this.sourceExpression.bind) {\r\n            this.sourceExpression.bind(this, source, this.lookupFunctions);\r\n        }\r\n        Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"enqueueBindingConnect\"])(this);\r\n    };\r\n    LetBinding.prototype.unbind = function () {\r\n        if (!this.isBound) {\r\n            return;\r\n        }\r\n        this.isBound = false;\r\n        if (this.sourceExpression.unbind) {\r\n            this.sourceExpression.unbind(this, this.source);\r\n        }\r\n        this.source = null;\r\n        this.target = null;\r\n        this.unobserve(true);\r\n    };\r\n    LetBinding.prototype.unobserve = function (arg0) {\r\n        throw new Error('Method not implemented.');\r\n    };\r\n    LetBinding.prototype.connect = function () {\r\n        if (!this.isBound) {\r\n            return;\r\n        }\r\n        this.updateTarget();\r\n        this.sourceExpression.connect(this, this.source);\r\n    };\r\n    LetBinding = __decorate([\r\n        Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"connectable\"])()\r\n    ], LetBinding);\r\n    return LetBinding;\r\n}());\n\nvar LetInterpolationBindingExpression = (function () {\r\n    function LetInterpolationBindingExpression(observerLocator, targetProperty, parts, lookupFunctions, toBindingContext) {\r\n        this.observerLocator = observerLocator;\r\n        this.targetProperty = targetProperty;\r\n        this.parts = parts;\r\n        this.lookupFunctions = lookupFunctions;\r\n        this.toBindingContext = toBindingContext;\r\n    }\r\n    LetInterpolationBindingExpression.prototype.createBinding = function () {\r\n        return new LetInterpolationBinding(this.observerLocator, this.targetProperty, this.parts, this.lookupFunctions, this.toBindingContext);\r\n    };\r\n    return LetInterpolationBindingExpression;\r\n}());\r\nvar LetInterpolationBinding = (function () {\r\n    function LetInterpolationBinding(observerLocator, targetProperty, parts, lookupFunctions, toBindingContext) {\r\n        this.observerLocator = observerLocator;\r\n        this.parts = parts;\r\n        this.targetProperty = targetProperty;\r\n        this.lookupFunctions = lookupFunctions;\r\n        this.toBindingContext = toBindingContext;\r\n        this.target = null;\r\n    }\r\n    LetInterpolationBinding.prototype.bind = function (source) {\r\n        if (this.isBound) {\r\n            if (this.source === source) {\r\n                return;\r\n            }\r\n            this.unbind();\r\n        }\r\n        this.isBound = true;\r\n        this.source = source;\r\n        this.target = this.toBindingContext ? source.bindingContext : source.overrideContext;\r\n        this.interpolationBinding = this.createInterpolationBinding();\r\n        this.interpolationBinding.bind(source);\r\n    };\r\n    LetInterpolationBinding.prototype.unbind = function () {\r\n        if (!this.isBound) {\r\n            return;\r\n        }\r\n        this.isBound = false;\r\n        this.source = null;\r\n        this.target = null;\r\n        this.interpolationBinding.unbind();\r\n        this.interpolationBinding = null;\r\n    };\r\n    LetInterpolationBinding.prototype.createInterpolationBinding = function () {\r\n        if (this.parts.length === 3) {\r\n            return new ChildInterpolationBinding(this.target, this.observerLocator, this.parts[1], aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"bindingMode\"].toView, this.lookupFunctions, this.targetProperty, this.parts[0], this.parts[2]);\r\n        }\r\n        return new InterpolationBinding(this.observerLocator, this.parts, this.target, this.targetProperty, aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"bindingMode\"].toView, this.lookupFunctions);\r\n    };\r\n    return LetInterpolationBinding;\r\n}());\n\nvar SyntaxInterpreter = (function () {\r\n    function SyntaxInterpreter(parser, observerLocator, eventManager, attributeMap) {\r\n        this.parser = parser;\r\n        this.observerLocator = observerLocator;\r\n        this.eventManager = eventManager;\r\n        this.attributeMap = attributeMap;\r\n    }\r\n    SyntaxInterpreter.prototype.interpret = function (resources, element, info, existingInstruction, context) {\r\n        if (info.command in this) {\r\n            return this[info.command](resources, element, info, existingInstruction, context);\r\n        }\r\n        return this.handleUnknownCommand(resources, element, info, existingInstruction, context);\r\n    };\r\n    SyntaxInterpreter.prototype.handleUnknownCommand = function (resources, element, info, existingInstruction, context) {\r\n        aurelia_logging__WEBPACK_IMPORTED_MODULE_2__[\"getLogger\"]('templating-binding').warn('Unknown binding command.', info);\r\n        return existingInstruction;\r\n    };\r\n    SyntaxInterpreter.prototype.determineDefaultBindingMode = function (element, attrName, context) {\r\n        var tagName = element.tagName.toLowerCase();\r\n        if (tagName === 'input' && (attrName === 'value' || attrName === 'files') && element.type !== 'checkbox' && element.type !== 'radio'\r\n            || tagName === 'input' && attrName === 'checked' && (element.type === 'checkbox' || element.type === 'radio')\r\n            || (tagName === 'textarea' || tagName === 'select') && attrName === 'value'\r\n            || (attrName === 'textcontent' || attrName === 'innerhtml') && element.contentEditable === 'true'\r\n            || attrName === 'scrolltop'\r\n            || attrName === 'scrollleft') {\r\n            return aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"bindingMode\"].twoWay;\r\n        }\r\n        if (context\r\n            && attrName in context.attributes\r\n            && context.attributes[attrName]\r\n            && context.attributes[attrName].defaultBindingMode >= aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"bindingMode\"].oneTime) {\r\n            return context.attributes[attrName].defaultBindingMode;\r\n        }\r\n        return aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"bindingMode\"].toView;\r\n    };\r\n    SyntaxInterpreter.prototype.bind = function (resources, element, info, existingInstruction, context) {\r\n        var instruction = existingInstruction || aurelia_templating__WEBPACK_IMPORTED_MODULE_0__[\"BehaviorInstruction\"].attribute(info.attrName);\r\n        instruction.attributes[info.attrName] = new aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"BindingExpression\"](this.observerLocator, this.attributeMap.map(element.tagName, info.attrName), this.parser.parse(info.attrValue), info.defaultBindingMode === undefined || info.defaultBindingMode === null\r\n            ? this.determineDefaultBindingMode(element, info.attrName, context)\r\n            : info.defaultBindingMode, resources.lookupFunctions);\r\n        return instruction;\r\n    };\r\n    SyntaxInterpreter.prototype.trigger = function (resources, element, info) {\r\n        return new aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"ListenerExpression\"](this.eventManager, info.attrName, this.parser.parse(info.attrValue), aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"delegationStrategy\"].none, true, resources.lookupFunctions);\r\n    };\r\n    SyntaxInterpreter.prototype.capture = function (resources, element, info) {\r\n        return new aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"ListenerExpression\"](this.eventManager, info.attrName, this.parser.parse(info.attrValue), aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"delegationStrategy\"].capturing, true, resources.lookupFunctions);\r\n    };\r\n    SyntaxInterpreter.prototype.delegate = function (resources, element, info) {\r\n        return new aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"ListenerExpression\"](this.eventManager, info.attrName, this.parser.parse(info.attrValue), aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"delegationStrategy\"].bubbling, true, resources.lookupFunctions);\r\n    };\r\n    SyntaxInterpreter.prototype.call = function (resources, element, info, existingInstruction) {\r\n        var instruction = existingInstruction || aurelia_templating__WEBPACK_IMPORTED_MODULE_0__[\"BehaviorInstruction\"].attribute(info.attrName);\r\n        instruction.attributes[info.attrName] = new aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"CallExpression\"](this.observerLocator, info.attrName, this.parser.parse(info.attrValue), resources.lookupFunctions);\r\n        return instruction;\r\n    };\r\n    SyntaxInterpreter.prototype.options = function (resources, element, info, existingInstruction, context) {\r\n        var instruction = existingInstruction || aurelia_templating__WEBPACK_IMPORTED_MODULE_0__[\"BehaviorInstruction\"].attribute(info.attrName);\r\n        var attrValue = info.attrValue;\r\n        var language = this.language;\r\n        var name = null;\r\n        var target = '';\r\n        var current;\r\n        var i;\r\n        var ii;\r\n        var inString = false;\r\n        var inEscape = false;\r\n        var foundName = false;\r\n        for (i = 0, ii = attrValue.length; i < ii; ++i) {\r\n            current = attrValue[i];\r\n            if (current === ';' && !inString) {\r\n                if (!foundName) {\r\n                    name = this._getPrimaryPropertyName(resources, context);\r\n                }\r\n                info = language.inspectAttribute(resources, '?', name, target.trim());\r\n                language.createAttributeInstruction(resources, element, info, instruction, context);\r\n                if (!instruction.attributes[info.attrName]) {\r\n                    instruction.attributes[info.attrName] = info.attrValue;\r\n                }\r\n                target = '';\r\n                name = null;\r\n            }\r\n            else if (current === ':' && name === null) {\r\n                foundName = true;\r\n                name = target.trim();\r\n                target = '';\r\n            }\r\n            else if (current === '\\\\') {\r\n                target += current;\r\n                inEscape = true;\r\n                continue;\r\n            }\r\n            else {\r\n                target += current;\r\n                if (name !== null && inEscape === false && current === '\\'') {\r\n                    inString = !inString;\r\n                }\r\n            }\r\n            inEscape = false;\r\n        }\r\n        if (!foundName) {\r\n            name = this._getPrimaryPropertyName(resources, context);\r\n        }\r\n        if (name !== null) {\r\n            info = language.inspectAttribute(resources, '?', name, target.trim());\r\n            language.createAttributeInstruction(resources, element, info, instruction, context);\r\n            if (!instruction.attributes[info.attrName]) {\r\n                instruction.attributes[info.attrName] = info.attrValue;\r\n            }\r\n        }\r\n        return instruction;\r\n    };\r\n    SyntaxInterpreter.prototype._getPrimaryPropertyName = function (resources, context) {\r\n        var type = resources.getAttribute(context.attributeName);\r\n        if (type && type.primaryProperty) {\r\n            return type.primaryProperty.attribute;\r\n        }\r\n        return null;\r\n    };\r\n    SyntaxInterpreter.prototype['for'] = function (resources, element, info, existingInstruction) {\r\n        var parts;\r\n        var keyValue;\r\n        var instruction;\r\n        var attrValue;\r\n        var isDestructuring;\r\n        attrValue = info.attrValue;\r\n        isDestructuring = attrValue.match(/^ *[[].+[\\]]/);\r\n        parts = isDestructuring ? attrValue.split('of ') : attrValue.split(' of ');\r\n        if (parts.length !== 2) {\r\n            throw new Error('Incorrect syntax for \"for\". The form is: \"$local of $items\" or \"[$key, $value] of $items\".');\r\n        }\r\n        instruction = existingInstruction || aurelia_templating__WEBPACK_IMPORTED_MODULE_0__[\"BehaviorInstruction\"].attribute(info.attrName);\r\n        if (isDestructuring) {\r\n            keyValue = parts[0].replace(/[[\\]]/g, '').replace(/,/g, ' ').replace(/\\s+/g, ' ').trim().split(' ');\r\n            instruction.attributes.key = keyValue[0];\r\n            instruction.attributes.value = keyValue[1];\r\n        }\r\n        else {\r\n            instruction.attributes.local = parts[0];\r\n        }\r\n        instruction.attributes.items = new aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"BindingExpression\"](this.observerLocator, 'items', this.parser.parse(parts[1]), aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"bindingMode\"].toView, resources.lookupFunctions);\r\n        return instruction;\r\n    };\r\n    SyntaxInterpreter.prototype['two-way'] = function (resources, element, info, existingInstruction) {\r\n        var instruction = existingInstruction || aurelia_templating__WEBPACK_IMPORTED_MODULE_0__[\"BehaviorInstruction\"].attribute(info.attrName);\r\n        instruction.attributes[info.attrName] = new aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"BindingExpression\"](this.observerLocator, this.attributeMap.map(element.tagName, info.attrName), this.parser.parse(info.attrValue), aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"bindingMode\"].twoWay, resources.lookupFunctions);\r\n        return instruction;\r\n    };\r\n    SyntaxInterpreter.prototype['to-view'] = function (resources, element, info, existingInstruction) {\r\n        var instruction = existingInstruction || aurelia_templating__WEBPACK_IMPORTED_MODULE_0__[\"BehaviorInstruction\"].attribute(info.attrName);\r\n        instruction.attributes[info.attrName] = new aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"BindingExpression\"](this.observerLocator, this.attributeMap.map(element.tagName, info.attrName), this.parser.parse(info.attrValue), aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"bindingMode\"].toView, resources.lookupFunctions);\r\n        return instruction;\r\n    };\r\n    SyntaxInterpreter.prototype['from-view'] = function (resources, element, info, existingInstruction) {\r\n        var instruction = existingInstruction || aurelia_templating__WEBPACK_IMPORTED_MODULE_0__[\"BehaviorInstruction\"].attribute(info.attrName);\r\n        instruction.attributes[info.attrName] = new aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"BindingExpression\"](this.observerLocator, this.attributeMap.map(element.tagName, info.attrName), this.parser.parse(info.attrValue), aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"bindingMode\"].fromView, resources.lookupFunctions);\r\n        return instruction;\r\n    };\r\n    SyntaxInterpreter.prototype['one-time'] = function (resources, element, info, existingInstruction) {\r\n        var instruction = existingInstruction || aurelia_templating__WEBPACK_IMPORTED_MODULE_0__[\"BehaviorInstruction\"].attribute(info.attrName);\r\n        instruction.attributes[info.attrName] = new aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"BindingExpression\"](this.observerLocator, this.attributeMap.map(element.tagName, info.attrName), this.parser.parse(info.attrValue), aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"bindingMode\"].oneTime, resources.lookupFunctions);\r\n        return instruction;\r\n    };\r\n    SyntaxInterpreter.inject = [aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"Parser\"], aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"ObserverLocator\"], aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"EventManager\"], AttributeMap];\r\n    return SyntaxInterpreter;\r\n}());\r\nObject.defineProperty(SyntaxInterpreter.prototype, 'one-way', Object.getOwnPropertyDescriptor(SyntaxInterpreter.prototype, 'to-view'));\n\nvar info = {};\r\nvar TemplatingBindingLanguage = (function (_super) {\r\n    __extends(TemplatingBindingLanguage, _super);\r\n    function TemplatingBindingLanguage(parser, observerLocator, syntaxInterpreter, attributeMap) {\r\n        var _this = _super.call(this) || this;\r\n        _this.parser = parser;\r\n        _this.observerLocator = observerLocator;\r\n        _this.syntaxInterpreter = syntaxInterpreter;\r\n        _this.emptyStringExpression = _this.parser.parse('\\'\\'');\r\n        syntaxInterpreter.language = _this;\r\n        _this.attributeMap = attributeMap;\r\n        _this.toBindingContextAttr = 'to-binding-context';\r\n        return _this;\r\n    }\r\n    TemplatingBindingLanguage.prototype.inspectAttribute = function (resources, elementName, attrName, attrValue) {\r\n        var parts = attrName.split('.');\r\n        info.defaultBindingMode = null;\r\n        if (parts.length === 2) {\r\n            info.attrName = parts[0].trim();\r\n            info.attrValue = attrValue;\r\n            info.command = parts[1].trim();\r\n            if (info.command === 'ref') {\r\n                info.expression = new aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"NameExpression\"](this.parser.parse(attrValue), info.attrName, resources.lookupFunctions);\r\n                info.command = null;\r\n                info.attrName = 'ref';\r\n            }\r\n            else {\r\n                info.expression = null;\r\n            }\r\n        }\r\n        else if (attrName === 'ref') {\r\n            info.attrName = attrName;\r\n            info.attrValue = attrValue;\r\n            info.command = null;\r\n            info.expression = new aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"NameExpression\"](this.parser.parse(attrValue), 'element', resources.lookupFunctions);\r\n        }\r\n        else {\r\n            info.attrName = attrName;\r\n            info.attrValue = attrValue;\r\n            info.command = null;\r\n            var interpolationParts = this.parseInterpolation(resources, attrValue);\r\n            if (interpolationParts === null) {\r\n                info.expression = null;\r\n            }\r\n            else {\r\n                info.expression = new InterpolationBindingExpression(this.observerLocator, this.attributeMap.map(elementName, attrName), interpolationParts, aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"bindingMode\"].toView, resources.lookupFunctions, attrName);\r\n            }\r\n        }\r\n        return info;\r\n    };\r\n    TemplatingBindingLanguage.prototype.createAttributeInstruction = function (resources, element, theInfo, existingInstruction, context) {\r\n        var instruction;\r\n        if (theInfo.expression) {\r\n            if (theInfo.attrName === 'ref') {\r\n                return theInfo.expression;\r\n            }\r\n            instruction = existingInstruction || aurelia_templating__WEBPACK_IMPORTED_MODULE_0__[\"BehaviorInstruction\"].attribute(theInfo.attrName);\r\n            instruction.attributes[theInfo.attrName] = theInfo.expression;\r\n        }\r\n        else if (theInfo.command) {\r\n            instruction = this.syntaxInterpreter.interpret(resources, element, theInfo, existingInstruction, context);\r\n        }\r\n        return instruction;\r\n    };\r\n    TemplatingBindingLanguage.prototype.createLetExpressions = function (resources, letElement) {\r\n        var expressions = [];\r\n        var attributes = letElement.attributes;\r\n        var attr;\r\n        var parts;\r\n        var attrName;\r\n        var attrValue;\r\n        var command;\r\n        var toBindingContextAttr = this.toBindingContextAttr;\r\n        var toBindingContext = letElement.hasAttribute(toBindingContextAttr);\r\n        for (var i = 0, ii = attributes.length; ii > i; ++i) {\r\n            attr = attributes[i];\r\n            attrName = attr.name;\r\n            attrValue = attr.nodeValue;\r\n            parts = attrName.split('.');\r\n            if (attrName === toBindingContextAttr) {\r\n                continue;\r\n            }\r\n            if (parts.length === 2) {\r\n                command = parts[1];\r\n                if (command !== 'bind') {\r\n                    aurelia_logging__WEBPACK_IMPORTED_MODULE_2__[\"getLogger\"]('templating-binding-language')\r\n                        .warn(\"Detected invalid let command. Expected \\\"\".concat(parts[0], \".bind\\\", given \\\"\").concat(attrName, \"\\\"\"));\r\n                    continue;\r\n                }\r\n                expressions.push(new LetExpression(this.observerLocator, Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"camelCase\"])(parts[0]), this.parser.parse(attrValue), resources.lookupFunctions, toBindingContext));\r\n            }\r\n            else {\r\n                attrName = Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"camelCase\"])(attrName);\r\n                parts = this.parseInterpolation(resources, attrValue);\r\n                if (parts === null) {\r\n                    aurelia_logging__WEBPACK_IMPORTED_MODULE_2__[\"getLogger\"]('templating-binding-language')\r\n                        .warn(\"Detected string literal in let bindings. Did you mean \\\"\".concat(attrName, \".bind=\").concat(attrValue, \"\\\" or \\\"\").concat(attrName, \"=${\").concat(attrValue, \"}\\\" ?\"));\r\n                }\r\n                if (parts) {\r\n                    expressions.push(new LetInterpolationBindingExpression(this.observerLocator, attrName, parts, resources.lookupFunctions, toBindingContext));\r\n                }\r\n                else {\r\n                    expressions.push(new LetExpression(this.observerLocator, attrName, new aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"LiteralString\"](attrValue), resources.lookupFunctions, toBindingContext));\r\n                }\r\n            }\r\n        }\r\n        return expressions;\r\n    };\r\n    TemplatingBindingLanguage.prototype.inspectTextContent = function (resources, value) {\r\n        var parts = this.parseInterpolation(resources, value);\r\n        if (parts === null) {\r\n            return null;\r\n        }\r\n        return new InterpolationBindingExpression(this.observerLocator, 'textContent', parts, aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"bindingMode\"].toView, resources.lookupFunctions, 'textContent');\r\n    };\r\n    TemplatingBindingLanguage.prototype.parseInterpolation = function (resources, value) {\r\n        var i = value.indexOf('${', 0);\r\n        var ii = value.length;\r\n        var char;\r\n        var pos = 0;\r\n        var open = 0;\r\n        var quote = null;\r\n        var interpolationStart;\r\n        var parts;\r\n        var partIndex = 0;\r\n        while (i >= 0 && i < ii - 2) {\r\n            open = 1;\r\n            interpolationStart = i;\r\n            i += 2;\r\n            do {\r\n                char = value[i];\r\n                i++;\r\n                if (char === \"'\" || char === '\"') {\r\n                    if (quote === null) {\r\n                        quote = char;\r\n                    }\r\n                    else if (quote === char) {\r\n                        quote = null;\r\n                    }\r\n                    continue;\r\n                }\r\n                if (char === '\\\\') {\r\n                    i++;\r\n                    continue;\r\n                }\r\n                if (quote !== null) {\r\n                    continue;\r\n                }\r\n                if (char === '{') {\r\n                    open++;\r\n                }\r\n                else if (char === '}') {\r\n                    open--;\r\n                }\r\n            } while (open > 0 && i < ii);\r\n            if (open === 0) {\r\n                parts = parts || [];\r\n                if (value[interpolationStart - 1] === '\\\\' && value[interpolationStart - 2] !== '\\\\') {\r\n                    parts[partIndex] = value.substring(pos, interpolationStart - 1) + value.substring(interpolationStart, i);\r\n                    partIndex++;\r\n                    parts[partIndex] = this.emptyStringExpression;\r\n                    partIndex++;\r\n                }\r\n                else {\r\n                    parts[partIndex] = value.substring(pos, interpolationStart);\r\n                    partIndex++;\r\n                    parts[partIndex] = this.parser.parse(value.substring(interpolationStart + 2, i - 1));\r\n                    partIndex++;\r\n                }\r\n                pos = i;\r\n                i = value.indexOf('${', i);\r\n            }\r\n            else {\r\n                break;\r\n            }\r\n        }\r\n        if (partIndex === 0) {\r\n            return null;\r\n        }\r\n        parts[partIndex] = value.substr(pos);\r\n        return parts;\r\n    };\r\n    TemplatingBindingLanguage.inject = [aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"Parser\"], aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"ObserverLocator\"], SyntaxInterpreter, AttributeMap];\r\n    return TemplatingBindingLanguage;\r\n}(aurelia_templating__WEBPACK_IMPORTED_MODULE_0__[\"BindingLanguage\"]));\n\nfunction configure(config) {\r\n    config.container.registerSingleton(aurelia_templating__WEBPACK_IMPORTED_MODULE_0__[\"BindingLanguage\"], TemplatingBindingLanguage);\r\n    config.container.registerAlias(aurelia_templating__WEBPACK_IMPORTED_MODULE_0__[\"BindingLanguage\"], TemplatingBindingLanguage);\r\n}\n\n\n//# sourceMappingURL=aurelia-templating-binding.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXVyZWxpYS10ZW1wbGF0aW5nLWJpbmRpbmcuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvYXVyZWxpYS10ZW1wbGF0aW5nLWJpbmRpbmcvZGlzdC9uYXRpdmUtbW9kdWxlcy9hdXJlbGlhLXRlbXBsYXRpbmctYmluZGluZy5qcz81NzBkIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEJlaGF2aW9ySW5zdHJ1Y3Rpb24sIEJpbmRpbmdMYW5ndWFnZSB9IGZyb20gJ2F1cmVsaWEtdGVtcGxhdGluZyc7XG5pbXBvcnQgeyBjYW1lbENhc2UsIFNWR0FuYWx5emVyLCBiaW5kaW5nTW9kZSwgZW5xdWV1ZUJpbmRpbmdDb25uZWN0LCBjb25uZWN0YWJsZSwgc291cmNlQ29udGV4dCwgQmluZGluZ0V4cHJlc3Npb24sIExpc3RlbmVyRXhwcmVzc2lvbiwgZGVsZWdhdGlvblN0cmF0ZWd5LCBDYWxsRXhwcmVzc2lvbiwgUGFyc2VyLCBPYnNlcnZlckxvY2F0b3IsIEV2ZW50TWFuYWdlciwgTmFtZUV4cHJlc3Npb24sIExpdGVyYWxTdHJpbmcgfSBmcm9tICdhdXJlbGlhLWJpbmRpbmcnO1xuaW1wb3J0ICogYXMgTG9nTWFuYWdlciBmcm9tICdhdXJlbGlhLWxvZ2dpbmcnO1xuXG4vKiEgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcclxuQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uXHJcblxyXG5QZXJtaXNzaW9uIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBhbmQvb3IgZGlzdHJpYnV0ZSB0aGlzIHNvZnR3YXJlIGZvciBhbnlcclxucHVycG9zZSB3aXRoIG9yIHdpdGhvdXQgZmVlIGlzIGhlcmVieSBncmFudGVkLlxyXG5cclxuVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiBBTkQgVEhFIEFVVEhPUiBESVNDTEFJTVMgQUxMIFdBUlJBTlRJRVMgV0lUSFxyXG5SRUdBUkQgVE8gVEhJUyBTT0ZUV0FSRSBJTkNMVURJTkcgQUxMIElNUExJRUQgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFlcclxuQU5EIEZJVE5FU1MuIElOIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1IgQkUgTElBQkxFIEZPUiBBTlkgU1BFQ0lBTCwgRElSRUNULFxyXG5JTkRJUkVDVCwgT1IgQ09OU0VRVUVOVElBTCBEQU1BR0VTIE9SIEFOWSBEQU1BR0VTIFdIQVRTT0VWRVIgUkVTVUxUSU5HIEZST01cclxuTE9TUyBPRiBVU0UsIERBVEEgT1IgUFJPRklUUywgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIE5FR0xJR0VOQ0UgT1JcclxuT1RIRVIgVE9SVElPVVMgQUNUSU9OLCBBUklTSU5HIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFVTRSBPUlxyXG5QRVJGT1JNQU5DRSBPRiBUSElTIFNPRlRXQVJFLlxyXG4qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiAqL1xyXG4vKiBnbG9iYWwgUmVmbGVjdCwgUHJvbWlzZSAqL1xyXG5cclxudmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbihkLCBiKSB7XHJcbiAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XHJcbiAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxyXG4gICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9O1xyXG4gICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbn07XHJcblxyXG5mdW5jdGlvbiBfX2V4dGVuZHMoZCwgYikge1xyXG4gICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcclxuICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxyXG4gICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBfX2RlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKSB7XHJcbiAgICB2YXIgYyA9IGFyZ3VtZW50cy5sZW5ndGgsIHIgPSBjIDwgMyA/IHRhcmdldCA6IGRlc2MgPT09IG51bGwgPyBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0YXJnZXQsIGtleSkgOiBkZXNjLCBkO1xyXG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0LmRlY29yYXRlID09PSBcImZ1bmN0aW9uXCIpIHIgPSBSZWZsZWN0LmRlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKTtcclxuICAgIGVsc2UgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIGlmIChkID0gZGVjb3JhdG9yc1tpXSkgciA9IChjIDwgMyA/IGQocikgOiBjID4gMyA/IGQodGFyZ2V0LCBrZXksIHIpIDogZCh0YXJnZXQsIGtleSkpIHx8IHI7XHJcbiAgICByZXR1cm4gYyA+IDMgJiYgciAmJiBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHIpLCByO1xyXG59XG5cbnZhciBBdHRyaWJ1dGVNYXAgPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gQXR0cmlidXRlTWFwKHN2Zykge1xyXG4gICAgICAgIHRoaXMuZWxlbWVudHMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xyXG4gICAgICAgIHRoaXMuYWxsRWxlbWVudHMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xyXG4gICAgICAgIHRoaXMuc3ZnID0gc3ZnO1xyXG4gICAgICAgIHRoaXMucmVnaXN0ZXJVbml2ZXJzYWwoJ2FjY2Vzc2tleScsICdhY2Nlc3NLZXknKTtcclxuICAgICAgICB0aGlzLnJlZ2lzdGVyVW5pdmVyc2FsKCdjb250ZW50ZWRpdGFibGUnLCAnY29udGVudEVkaXRhYmxlJyk7XHJcbiAgICAgICAgdGhpcy5yZWdpc3RlclVuaXZlcnNhbCgndGFiaW5kZXgnLCAndGFiSW5kZXgnKTtcclxuICAgICAgICB0aGlzLnJlZ2lzdGVyVW5pdmVyc2FsKCd0ZXh0Y29udGVudCcsICd0ZXh0Q29udGVudCcpO1xyXG4gICAgICAgIHRoaXMucmVnaXN0ZXJVbml2ZXJzYWwoJ2lubmVyaHRtbCcsICdpbm5lckhUTUwnKTtcclxuICAgICAgICB0aGlzLnJlZ2lzdGVyVW5pdmVyc2FsKCdzY3JvbGx0b3AnLCAnc2Nyb2xsVG9wJyk7XHJcbiAgICAgICAgdGhpcy5yZWdpc3RlclVuaXZlcnNhbCgnc2Nyb2xsbGVmdCcsICdzY3JvbGxMZWZ0Jyk7XHJcbiAgICAgICAgdGhpcy5yZWdpc3RlclVuaXZlcnNhbCgncmVhZG9ubHknLCAncmVhZE9ubHknKTtcclxuICAgICAgICB0aGlzLnJlZ2lzdGVyKCdsYWJlbCcsICdmb3InLCAnaHRtbEZvcicpO1xyXG4gICAgICAgIHRoaXMucmVnaXN0ZXIoJ2ltZycsICd1c2VtYXAnLCAndXNlTWFwJyk7XHJcbiAgICAgICAgdGhpcy5yZWdpc3RlcignaW5wdXQnLCAnbWF4bGVuZ3RoJywgJ21heExlbmd0aCcpO1xyXG4gICAgICAgIHRoaXMucmVnaXN0ZXIoJ2lucHV0JywgJ21pbmxlbmd0aCcsICdtaW5MZW5ndGgnKTtcclxuICAgICAgICB0aGlzLnJlZ2lzdGVyKCdpbnB1dCcsICdmb3JtYWN0aW9uJywgJ2Zvcm1BY3Rpb24nKTtcclxuICAgICAgICB0aGlzLnJlZ2lzdGVyKCdpbnB1dCcsICdmb3JtZW5jdHlwZScsICdmb3JtRW5jVHlwZScpO1xyXG4gICAgICAgIHRoaXMucmVnaXN0ZXIoJ2lucHV0JywgJ2Zvcm1tZXRob2QnLCAnZm9ybU1ldGhvZCcpO1xyXG4gICAgICAgIHRoaXMucmVnaXN0ZXIoJ2lucHV0JywgJ2Zvcm1ub3ZhbGlkYXRlJywgJ2Zvcm1Ob1ZhbGlkYXRlJyk7XHJcbiAgICAgICAgdGhpcy5yZWdpc3RlcignaW5wdXQnLCAnZm9ybXRhcmdldCcsICdmb3JtVGFyZ2V0Jyk7XHJcbiAgICAgICAgdGhpcy5yZWdpc3RlcigndGV4dGFyZWEnLCAnbWF4bGVuZ3RoJywgJ21heExlbmd0aCcpO1xyXG4gICAgICAgIHRoaXMucmVnaXN0ZXIoJ3RkJywgJ3Jvd3NwYW4nLCAncm93U3BhbicpO1xyXG4gICAgICAgIHRoaXMucmVnaXN0ZXIoJ3RkJywgJ2NvbHNwYW4nLCAnY29sU3BhbicpO1xyXG4gICAgICAgIHRoaXMucmVnaXN0ZXIoJ3RoJywgJ3Jvd3NwYW4nLCAncm93U3BhbicpO1xyXG4gICAgICAgIHRoaXMucmVnaXN0ZXIoJ3RoJywgJ2NvbHNwYW4nLCAnY29sU3BhbicpO1xyXG4gICAgfVxyXG4gICAgQXR0cmlidXRlTWFwLnByb3RvdHlwZS5yZWdpc3RlciA9IGZ1bmN0aW9uIChlbGVtZW50TmFtZSwgYXR0cmlidXRlTmFtZSwgcHJvcGVydHlOYW1lKSB7XHJcbiAgICAgICAgZWxlbWVudE5hbWUgPSBlbGVtZW50TmFtZS50b0xvd2VyQ2FzZSgpO1xyXG4gICAgICAgIGF0dHJpYnV0ZU5hbWUgPSBhdHRyaWJ1dGVOYW1lLnRvTG93ZXJDYXNlKCk7XHJcbiAgICAgICAgdmFyIGVsZW1lbnQgPSB0aGlzLmVsZW1lbnRzW2VsZW1lbnROYW1lXSA9ICh0aGlzLmVsZW1lbnRzW2VsZW1lbnROYW1lXSB8fCBPYmplY3QuY3JlYXRlKG51bGwpKTtcclxuICAgICAgICBlbGVtZW50W2F0dHJpYnV0ZU5hbWVdID0gcHJvcGVydHlOYW1lO1xyXG4gICAgfTtcclxuICAgIEF0dHJpYnV0ZU1hcC5wcm90b3R5cGUucmVnaXN0ZXJVbml2ZXJzYWwgPSBmdW5jdGlvbiAoYXR0cmlidXRlTmFtZSwgcHJvcGVydHlOYW1lKSB7XHJcbiAgICAgICAgYXR0cmlidXRlTmFtZSA9IGF0dHJpYnV0ZU5hbWUudG9Mb3dlckNhc2UoKTtcclxuICAgICAgICB0aGlzLmFsbEVsZW1lbnRzW2F0dHJpYnV0ZU5hbWVdID0gcHJvcGVydHlOYW1lO1xyXG4gICAgfTtcclxuICAgIEF0dHJpYnV0ZU1hcC5wcm90b3R5cGUubWFwID0gZnVuY3Rpb24gKGVsZW1lbnROYW1lLCBhdHRyaWJ1dGVOYW1lKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuc3ZnLmlzU3RhbmRhcmRTdmdBdHRyaWJ1dGUoZWxlbWVudE5hbWUsIGF0dHJpYnV0ZU5hbWUpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBhdHRyaWJ1dGVOYW1lO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbGVtZW50TmFtZSA9IGVsZW1lbnROYW1lLnRvTG93ZXJDYXNlKCk7XHJcbiAgICAgICAgYXR0cmlidXRlTmFtZSA9IGF0dHJpYnV0ZU5hbWUudG9Mb3dlckNhc2UoKTtcclxuICAgICAgICB2YXIgZWxlbWVudCA9IHRoaXMuZWxlbWVudHNbZWxlbWVudE5hbWVdO1xyXG4gICAgICAgIGlmIChlbGVtZW50ICE9PSB1bmRlZmluZWQgJiYgYXR0cmlidXRlTmFtZSBpbiBlbGVtZW50KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBlbGVtZW50W2F0dHJpYnV0ZU5hbWVdO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoYXR0cmlidXRlTmFtZSBpbiB0aGlzLmFsbEVsZW1lbnRzKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmFsbEVsZW1lbnRzW2F0dHJpYnV0ZU5hbWVdO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoLyg/Ol5kYXRhLSl8KD86XmFyaWEtKXw6Ly50ZXN0KGF0dHJpYnV0ZU5hbWUpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBhdHRyaWJ1dGVOYW1lO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gY2FtZWxDYXNlKGF0dHJpYnV0ZU5hbWUpO1xyXG4gICAgfTtcclxuICAgIEF0dHJpYnV0ZU1hcC5pbmplY3QgPSBbU1ZHQW5hbHl6ZXJdO1xyXG4gICAgcmV0dXJuIEF0dHJpYnV0ZU1hcDtcclxufSgpKTtcblxudmFyIEludGVycG9sYXRpb25CaW5kaW5nRXhwcmVzc2lvbiA9IChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBJbnRlcnBvbGF0aW9uQmluZGluZ0V4cHJlc3Npb24ob2JzZXJ2ZXJMb2NhdG9yLCB0YXJnZXRQcm9wZXJ0eSwgcGFydHMsIG1vZGUsIGxvb2t1cEZ1bmN0aW9ucywgYXR0cmlidXRlKSB7XHJcbiAgICAgICAgdGhpcy5vYnNlcnZlckxvY2F0b3IgPSBvYnNlcnZlckxvY2F0b3I7XHJcbiAgICAgICAgdGhpcy50YXJnZXRQcm9wZXJ0eSA9IHRhcmdldFByb3BlcnR5O1xyXG4gICAgICAgIHRoaXMucGFydHMgPSBwYXJ0cztcclxuICAgICAgICB0aGlzLm1vZGUgPSBtb2RlO1xyXG4gICAgICAgIHRoaXMubG9va3VwRnVuY3Rpb25zID0gbG9va3VwRnVuY3Rpb25zO1xyXG4gICAgICAgIHRoaXMuYXR0cmlidXRlID0gdGhpcy5hdHRyVG9SZW1vdmUgPSBhdHRyaWJ1dGU7XHJcbiAgICAgICAgdGhpcy5kaXNjcmV0ZSA9IGZhbHNlO1xyXG4gICAgfVxyXG4gICAgSW50ZXJwb2xhdGlvbkJpbmRpbmdFeHByZXNzaW9uLnByb3RvdHlwZS5jcmVhdGVCaW5kaW5nID0gZnVuY3Rpb24gKHRhcmdldCkge1xyXG4gICAgICAgIGlmICh0aGlzLnBhcnRzLmxlbmd0aCA9PT0gMykge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IENoaWxkSW50ZXJwb2xhdGlvbkJpbmRpbmcodGFyZ2V0LCB0aGlzLm9ic2VydmVyTG9jYXRvciwgdGhpcy5wYXJ0c1sxXSwgdGhpcy5tb2RlLCB0aGlzLmxvb2t1cEZ1bmN0aW9ucywgdGhpcy50YXJnZXRQcm9wZXJ0eSwgdGhpcy5wYXJ0c1swXSwgdGhpcy5wYXJ0c1syXSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBuZXcgSW50ZXJwb2xhdGlvbkJpbmRpbmcodGhpcy5vYnNlcnZlckxvY2F0b3IsIHRoaXMucGFydHMsIHRhcmdldCwgdGhpcy50YXJnZXRQcm9wZXJ0eSwgdGhpcy5tb2RlLCB0aGlzLmxvb2t1cEZ1bmN0aW9ucyk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEludGVycG9sYXRpb25CaW5kaW5nRXhwcmVzc2lvbjtcclxufSgpKTtcclxuZnVuY3Rpb24gdmFsaWRhdGVUYXJnZXQodGFyZ2V0LCBwcm9wZXJ0eU5hbWUpIHtcclxuICAgIGlmIChwcm9wZXJ0eU5hbWUgPT09ICdzdHlsZScpIHtcclxuICAgICAgICBMb2dNYW5hZ2VyLmdldExvZ2dlcigndGVtcGxhdGluZy1iaW5kaW5nJylcclxuICAgICAgICAgICAgLmluZm8oJ0ludGVybmV0IEV4cGxvcmVyIGRvZXMgbm90IHN1cHBvcnQgaW50ZXJwb2xhdGlvbiBpbiBcInN0eWxlXCIgYXR0cmlidXRlcy4gIFVzZSB0aGUgc3R5bGUgYXR0cmlidXRlXFwncyBhbGlhcywgXCJjc3NcIiBpbnN0ZWFkLicpO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAodGFyZ2V0LnBhcmVudEVsZW1lbnQgJiYgdGFyZ2V0LnBhcmVudEVsZW1lbnQubm9kZU5hbWUgPT09ICdURVhUQVJFQScgJiYgcHJvcGVydHlOYW1lID09PSAndGV4dENvbnRlbnQnKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnRlcnBvbGF0aW9uIGJpbmRpbmcgY2Fubm90IGJlIHVzZWQgaW4gdGhlIGNvbnRlbnQgb2YgYSB0ZXh0YXJlYSBlbGVtZW50LiAgVXNlIDx0ZXh0YXJlYSB2YWx1ZS5iaW5kPVwiZXhwcmVzc2lvblwiPjwvdGV4dGFyZWE+IGluc3RlYWQuJyk7XHJcbiAgICB9XHJcbn1cclxudmFyIEludGVycG9sYXRpb25CaW5kaW5nID0gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEludGVycG9sYXRpb25CaW5kaW5nKG9ic2VydmVyTG9jYXRvciwgcGFydHMsIHRhcmdldCwgdGFyZ2V0UHJvcGVydHksIG1vZGUsIGxvb2t1cEZ1bmN0aW9ucykge1xyXG4gICAgICAgIHZhbGlkYXRlVGFyZ2V0KHRhcmdldCwgdGFyZ2V0UHJvcGVydHkpO1xyXG4gICAgICAgIHRoaXMub2JzZXJ2ZXJMb2NhdG9yID0gb2JzZXJ2ZXJMb2NhdG9yO1xyXG4gICAgICAgIHRoaXMucGFydHMgPSBwYXJ0cztcclxuICAgICAgICB0aGlzLnRhcmdldCA9IHRhcmdldDtcclxuICAgICAgICB0aGlzLnRhcmdldFByb3BlcnR5ID0gdGFyZ2V0UHJvcGVydHk7XHJcbiAgICAgICAgdGhpcy50YXJnZXRBY2Nlc3NvciA9IG9ic2VydmVyTG9jYXRvci5nZXRBY2Nlc3Nvcih0YXJnZXQsIHRhcmdldFByb3BlcnR5KTtcclxuICAgICAgICB0aGlzLm1vZGUgPSBtb2RlO1xyXG4gICAgICAgIHRoaXMubG9va3VwRnVuY3Rpb25zID0gbG9va3VwRnVuY3Rpb25zO1xyXG4gICAgfVxyXG4gICAgSW50ZXJwb2xhdGlvbkJpbmRpbmcucHJvdG90eXBlLmludGVycG9sYXRlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICh0aGlzLmlzQm91bmQpIHtcclxuICAgICAgICAgICAgdmFyIHZhbHVlID0gJyc7XHJcbiAgICAgICAgICAgIHZhciBwYXJ0cyA9IHRoaXMucGFydHM7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBpaSA9IHBhcnRzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIHZhbHVlICs9IChpICUgMiA9PT0gMCA/IHBhcnRzW2ldIDogdGhpc1tcImNoaWxkQmluZGluZ1wiLmNvbmNhdChpKV0udmFsdWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMudGFyZ2V0QWNjZXNzb3Iuc2V0VmFsdWUodmFsdWUsIHRoaXMudGFyZ2V0LCB0aGlzLnRhcmdldFByb3BlcnR5KTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgSW50ZXJwb2xhdGlvbkJpbmRpbmcucHJvdG90eXBlLnVwZGF0ZU9uZVRpbWVCaW5kaW5ncyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBmb3IgKHZhciBpID0gMSwgaWkgPSB0aGlzLnBhcnRzLmxlbmd0aDsgaSA8IGlpOyBpICs9IDIpIHtcclxuICAgICAgICAgICAgdmFyIGNoaWxkID0gdGhpc1tcImNoaWxkQmluZGluZ1wiLmNvbmNhdChpKV07XHJcbiAgICAgICAgICAgIGlmIChjaGlsZC5tb2RlID09PSBiaW5kaW5nTW9kZS5vbmVUaW1lKSB7XHJcbiAgICAgICAgICAgICAgICBjaGlsZC5jYWxsKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgSW50ZXJwb2xhdGlvbkJpbmRpbmcucHJvdG90eXBlLmJpbmQgPSBmdW5jdGlvbiAoc291cmNlKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuaXNCb3VuZCkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5zb3VyY2UgPT09IHNvdXJjZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMudW5iaW5kKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xyXG4gICAgICAgIHZhciBwYXJ0cyA9IHRoaXMucGFydHM7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDEsIGlpID0gcGFydHMubGVuZ3RoOyBpIDwgaWk7IGkgKz0gMikge1xyXG4gICAgICAgICAgICB2YXIgYmluZGluZyA9IG5ldyBDaGlsZEludGVycG9sYXRpb25CaW5kaW5nKHRoaXMsIHRoaXMub2JzZXJ2ZXJMb2NhdG9yLCBwYXJ0c1tpXSwgdGhpcy5tb2RlLCB0aGlzLmxvb2t1cEZ1bmN0aW9ucyk7XHJcbiAgICAgICAgICAgIGJpbmRpbmcuYmluZChzb3VyY2UpO1xyXG4gICAgICAgICAgICB0aGlzW1wiY2hpbGRCaW5kaW5nXCIuY29uY2F0KGkpXSA9IGJpbmRpbmc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuaXNCb3VuZCA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5pbnRlcnBvbGF0ZSgpO1xyXG4gICAgfTtcclxuICAgIEludGVycG9sYXRpb25CaW5kaW5nLnByb3RvdHlwZS51bmJpbmQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmlzQm91bmQpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmlzQm91bmQgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLnNvdXJjZSA9IG51bGw7XHJcbiAgICAgICAgdmFyIHBhcnRzID0gdGhpcy5wYXJ0cztcclxuICAgICAgICBmb3IgKHZhciBpID0gMSwgaWkgPSBwYXJ0cy5sZW5ndGg7IGkgPCBpaTsgaSArPSAyKSB7XHJcbiAgICAgICAgICAgIHZhciBuYW1lXzEgPSBcImNoaWxkQmluZGluZ1wiLmNvbmNhdChpKTtcclxuICAgICAgICAgICAgdGhpc1tuYW1lXzFdLnVuYmluZCgpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICByZXR1cm4gSW50ZXJwb2xhdGlvbkJpbmRpbmc7XHJcbn0oKSk7XHJcbnZhciBDaGlsZEludGVycG9sYXRpb25CaW5kaW5nID0gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIENoaWxkSW50ZXJwb2xhdGlvbkJpbmRpbmcodGFyZ2V0LCBvYnNlcnZlckxvY2F0b3IsIHNvdXJjZUV4cHJlc3Npb24sIG1vZGUsIGxvb2t1cEZ1bmN0aW9ucywgdGFyZ2V0UHJvcGVydHksIGxlZnQsIHJpZ2h0KSB7XHJcbiAgICAgICAgaWYgKHRhcmdldCBpbnN0YW5jZW9mIEludGVycG9sYXRpb25CaW5kaW5nKSB7XHJcbiAgICAgICAgICAgIHRoaXMucGFyZW50ID0gdGFyZ2V0O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdmFsaWRhdGVUYXJnZXQodGFyZ2V0LCB0YXJnZXRQcm9wZXJ0eSk7XHJcbiAgICAgICAgICAgIHRoaXMudGFyZ2V0ID0gdGFyZ2V0O1xyXG4gICAgICAgICAgICB0aGlzLnRhcmdldFByb3BlcnR5ID0gdGFyZ2V0UHJvcGVydHk7XHJcbiAgICAgICAgICAgIHRoaXMudGFyZ2V0QWNjZXNzb3IgPSBvYnNlcnZlckxvY2F0b3IuZ2V0QWNjZXNzb3IodGFyZ2V0LCB0YXJnZXRQcm9wZXJ0eSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMub2JzZXJ2ZXJMb2NhdG9yID0gb2JzZXJ2ZXJMb2NhdG9yO1xyXG4gICAgICAgIHRoaXMuc291cmNlRXhwcmVzc2lvbiA9IHNvdXJjZUV4cHJlc3Npb247XHJcbiAgICAgICAgdGhpcy5tb2RlID0gbW9kZTtcclxuICAgICAgICB0aGlzLmxvb2t1cEZ1bmN0aW9ucyA9IGxvb2t1cEZ1bmN0aW9ucztcclxuICAgICAgICB0aGlzLmxlZnQgPSBsZWZ0O1xyXG4gICAgICAgIHRoaXMucmlnaHQgPSByaWdodDtcclxuICAgIH1cclxuICAgIENoaWxkSW50ZXJwb2xhdGlvbkJpbmRpbmcucHJvdG90eXBlLnVwZGF0ZVRhcmdldCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xyXG4gICAgICAgIHZhbHVlID0gdmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09IHVuZGVmaW5lZCA/ICcnIDogdmFsdWUudG9TdHJpbmcoKTtcclxuICAgICAgICBpZiAodmFsdWUgIT09IHRoaXMudmFsdWUpIHtcclxuICAgICAgICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5wYXJlbnQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucGFyZW50LmludGVycG9sYXRlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnRhcmdldEFjY2Vzc29yLnNldFZhbHVlKHRoaXMubGVmdCArIHZhbHVlICsgdGhpcy5yaWdodCwgdGhpcy50YXJnZXQsIHRoaXMudGFyZ2V0UHJvcGVydHkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIENoaWxkSW50ZXJwb2xhdGlvbkJpbmRpbmcucHJvdG90eXBlLmNhbGwgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmlzQm91bmQpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnJhd1ZhbHVlID0gdGhpcy5zb3VyY2VFeHByZXNzaW9uLmV2YWx1YXRlKHRoaXMuc291cmNlLCB0aGlzLmxvb2t1cEZ1bmN0aW9ucyk7XHJcbiAgICAgICAgdGhpcy51cGRhdGVUYXJnZXQodGhpcy5yYXdWYWx1ZSk7XHJcbiAgICAgICAgaWYgKHRoaXMubW9kZSAhPT0gYmluZGluZ01vZGUub25lVGltZSkge1xyXG4gICAgICAgICAgICB0aGlzLl92ZXJzaW9uKys7XHJcbiAgICAgICAgICAgIHRoaXMuc291cmNlRXhwcmVzc2lvbi5jb25uZWN0KHRoaXMsIHRoaXMuc291cmNlKTtcclxuICAgICAgICAgICAgaWYgKHRoaXMucmF3VmFsdWUgaW5zdGFuY2VvZiBBcnJheSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5vYnNlcnZlQXJyYXkodGhpcy5yYXdWYWx1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy51bm9ic2VydmUoZmFsc2UpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBDaGlsZEludGVycG9sYXRpb25CaW5kaW5nLnByb3RvdHlwZS5iaW5kID0gZnVuY3Rpb24gKHNvdXJjZSkge1xyXG4gICAgICAgIGlmICh0aGlzLmlzQm91bmQpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuc291cmNlID09PSBzb3VyY2UpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLnVuYmluZCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmlzQm91bmQgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xyXG4gICAgICAgIHZhciBzb3VyY2VFeHByZXNzaW9uID0gdGhpcy5zb3VyY2VFeHByZXNzaW9uO1xyXG4gICAgICAgIGlmIChzb3VyY2VFeHByZXNzaW9uLmJpbmQpIHtcclxuICAgICAgICAgICAgc291cmNlRXhwcmVzc2lvbi5iaW5kKHRoaXMsIHNvdXJjZSwgdGhpcy5sb29rdXBGdW5jdGlvbnMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnJhd1ZhbHVlID0gc291cmNlRXhwcmVzc2lvbi5ldmFsdWF0ZShzb3VyY2UsIHRoaXMubG9va3VwRnVuY3Rpb25zKTtcclxuICAgICAgICB0aGlzLnVwZGF0ZVRhcmdldCh0aGlzLnJhd1ZhbHVlKTtcclxuICAgICAgICBpZiAodGhpcy5tb2RlID09PSBiaW5kaW5nTW9kZS5vbmVXYXkpIHtcclxuICAgICAgICAgICAgZW5xdWV1ZUJpbmRpbmdDb25uZWN0KHRoaXMpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBDaGlsZEludGVycG9sYXRpb25CaW5kaW5nLnByb3RvdHlwZS51bmJpbmQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmlzQm91bmQpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmlzQm91bmQgPSBmYWxzZTtcclxuICAgICAgICB2YXIgc291cmNlRXhwcmVzc2lvbiA9IHRoaXMuc291cmNlRXhwcmVzc2lvbjtcclxuICAgICAgICBpZiAoc291cmNlRXhwcmVzc2lvbi51bmJpbmQpIHtcclxuICAgICAgICAgICAgc291cmNlRXhwcmVzc2lvbi51bmJpbmQodGhpcywgdGhpcy5zb3VyY2UpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnNvdXJjZSA9IG51bGw7XHJcbiAgICAgICAgdGhpcy52YWx1ZSA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5yYXdWYWx1ZSA9IG51bGw7XHJcbiAgICAgICAgdGhpcy51bm9ic2VydmUodHJ1ZSk7XHJcbiAgICB9O1xyXG4gICAgQ2hpbGRJbnRlcnBvbGF0aW9uQmluZGluZy5wcm90b3R5cGUuY29ubmVjdCA9IGZ1bmN0aW9uIChldmFsdWF0ZSkge1xyXG4gICAgICAgIGlmICghdGhpcy5pc0JvdW5kKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGV2YWx1YXRlKSB7XHJcbiAgICAgICAgICAgIHRoaXMucmF3VmFsdWUgPSB0aGlzLnNvdXJjZUV4cHJlc3Npb24uZXZhbHVhdGUodGhpcy5zb3VyY2UsIHRoaXMubG9va3VwRnVuY3Rpb25zKTtcclxuICAgICAgICAgICAgdGhpcy51cGRhdGVUYXJnZXQodGhpcy5yYXdWYWx1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuc291cmNlRXhwcmVzc2lvbi5jb25uZWN0KHRoaXMsIHRoaXMuc291cmNlKTtcclxuICAgICAgICBpZiAodGhpcy5yYXdWYWx1ZSBpbnN0YW5jZW9mIEFycmF5KSB7XHJcbiAgICAgICAgICAgIHRoaXMub2JzZXJ2ZUFycmF5KHRoaXMucmF3VmFsdWUpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBDaGlsZEludGVycG9sYXRpb25CaW5kaW5nID0gX19kZWNvcmF0ZShbXHJcbiAgICAgICAgY29ubmVjdGFibGUoKVxyXG4gICAgXSwgQ2hpbGRJbnRlcnBvbGF0aW9uQmluZGluZyk7XHJcbiAgICByZXR1cm4gQ2hpbGRJbnRlcnBvbGF0aW9uQmluZGluZztcclxufSgpKTtcblxudmFyIExldEV4cHJlc3Npb24gPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gTGV0RXhwcmVzc2lvbihvYnNlcnZlckxvY2F0b3IsIHRhcmdldFByb3BlcnR5LCBzb3VyY2VFeHByZXNzaW9uLCBsb29rdXBGdW5jdGlvbnMsIHRvQmluZGluZ0NvbnRleHQpIHtcclxuICAgICAgICB0aGlzLm9ic2VydmVyTG9jYXRvciA9IG9ic2VydmVyTG9jYXRvcjtcclxuICAgICAgICB0aGlzLnNvdXJjZUV4cHJlc3Npb24gPSBzb3VyY2VFeHByZXNzaW9uO1xyXG4gICAgICAgIHRoaXMudGFyZ2V0UHJvcGVydHkgPSB0YXJnZXRQcm9wZXJ0eTtcclxuICAgICAgICB0aGlzLmxvb2t1cEZ1bmN0aW9ucyA9IGxvb2t1cEZ1bmN0aW9ucztcclxuICAgICAgICB0aGlzLnRvQmluZGluZ0NvbnRleHQgPSB0b0JpbmRpbmdDb250ZXh0O1xyXG4gICAgfVxyXG4gICAgTGV0RXhwcmVzc2lvbi5wcm90b3R5cGUuY3JlYXRlQmluZGluZyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gbmV3IExldEJpbmRpbmcodGhpcy5vYnNlcnZlckxvY2F0b3IsIHRoaXMuc291cmNlRXhwcmVzc2lvbiwgdGhpcy50YXJnZXRQcm9wZXJ0eSwgdGhpcy5sb29rdXBGdW5jdGlvbnMsIHRoaXMudG9CaW5kaW5nQ29udGV4dCk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIExldEV4cHJlc3Npb247XHJcbn0oKSk7XHJcbnZhciBMZXRCaW5kaW5nID0gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIExldEJpbmRpbmcob2JzZXJ2ZXJMb2NhdG9yLCBzb3VyY2VFeHByZXNzaW9uLCB0YXJnZXRQcm9wZXJ0eSwgbG9va3VwRnVuY3Rpb25zLCB0b0JpbmRpbmdDb250ZXh0KSB7XHJcbiAgICAgICAgdGhpcy5vYnNlcnZlckxvY2F0b3IgPSBvYnNlcnZlckxvY2F0b3I7XHJcbiAgICAgICAgdGhpcy5zb3VyY2VFeHByZXNzaW9uID0gc291cmNlRXhwcmVzc2lvbjtcclxuICAgICAgICB0aGlzLnRhcmdldFByb3BlcnR5ID0gdGFyZ2V0UHJvcGVydHk7XHJcbiAgICAgICAgdGhpcy5sb29rdXBGdW5jdGlvbnMgPSBsb29rdXBGdW5jdGlvbnM7XHJcbiAgICAgICAgdGhpcy5zb3VyY2UgPSBudWxsO1xyXG4gICAgICAgIHRoaXMudGFyZ2V0ID0gbnVsbDtcclxuICAgICAgICB0aGlzLnRvQmluZGluZ0NvbnRleHQgPSB0b0JpbmRpbmdDb250ZXh0O1xyXG4gICAgfVxyXG4gICAgTGV0QmluZGluZy5wcm90b3R5cGUudXBkYXRlVGFyZ2V0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciB2YWx1ZSA9IHRoaXMuc291cmNlRXhwcmVzc2lvbi5ldmFsdWF0ZSh0aGlzLnNvdXJjZSwgdGhpcy5sb29rdXBGdW5jdGlvbnMpO1xyXG4gICAgICAgIHRoaXMudGFyZ2V0W3RoaXMudGFyZ2V0UHJvcGVydHldID0gdmFsdWU7XHJcbiAgICB9O1xyXG4gICAgTGV0QmluZGluZy5wcm90b3R5cGUuY2FsbCA9IGZ1bmN0aW9uIChjb250ZXh0KSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmlzQm91bmQpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoY29udGV4dCA9PT0gc291cmNlQ29udGV4dCkge1xyXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVRhcmdldCgpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIlVuZXhwZWN0ZWQgY2FsbCBjb250ZXh0IFwiLmNvbmNhdChjb250ZXh0KSk7XHJcbiAgICB9O1xyXG4gICAgTGV0QmluZGluZy5wcm90b3R5cGUuYmluZCA9IGZ1bmN0aW9uIChzb3VyY2UpIHtcclxuICAgICAgICBpZiAodGhpcy5pc0JvdW5kKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnNvdXJjZSA9PT0gc291cmNlKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy51bmJpbmQoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5pc0JvdW5kID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcclxuICAgICAgICB0aGlzLnRhcmdldCA9IHRoaXMudG9CaW5kaW5nQ29udGV4dCA/IHNvdXJjZS5iaW5kaW5nQ29udGV4dCA6IHNvdXJjZS5vdmVycmlkZUNvbnRleHQ7XHJcbiAgICAgICAgaWYgKHRoaXMuc291cmNlRXhwcmVzc2lvbi5iaW5kKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc291cmNlRXhwcmVzc2lvbi5iaW5kKHRoaXMsIHNvdXJjZSwgdGhpcy5sb29rdXBGdW5jdGlvbnMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbnF1ZXVlQmluZGluZ0Nvbm5lY3QodGhpcyk7XHJcbiAgICB9O1xyXG4gICAgTGV0QmluZGluZy5wcm90b3R5cGUudW5iaW5kID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICghdGhpcy5pc0JvdW5kKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5pc0JvdW5kID0gZmFsc2U7XHJcbiAgICAgICAgaWYgKHRoaXMuc291cmNlRXhwcmVzc2lvbi51bmJpbmQpIHtcclxuICAgICAgICAgICAgdGhpcy5zb3VyY2VFeHByZXNzaW9uLnVuYmluZCh0aGlzLCB0aGlzLnNvdXJjZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuc291cmNlID0gbnVsbDtcclxuICAgICAgICB0aGlzLnRhcmdldCA9IG51bGw7XHJcbiAgICAgICAgdGhpcy51bm9ic2VydmUodHJ1ZSk7XHJcbiAgICB9O1xyXG4gICAgTGV0QmluZGluZy5wcm90b3R5cGUudW5vYnNlcnZlID0gZnVuY3Rpb24gKGFyZzApIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01ldGhvZCBub3QgaW1wbGVtZW50ZWQuJyk7XHJcbiAgICB9O1xyXG4gICAgTGV0QmluZGluZy5wcm90b3R5cGUuY29ubmVjdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAoIXRoaXMuaXNCb3VuZCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMudXBkYXRlVGFyZ2V0KCk7XHJcbiAgICAgICAgdGhpcy5zb3VyY2VFeHByZXNzaW9uLmNvbm5lY3QodGhpcywgdGhpcy5zb3VyY2UpO1xyXG4gICAgfTtcclxuICAgIExldEJpbmRpbmcgPSBfX2RlY29yYXRlKFtcclxuICAgICAgICBjb25uZWN0YWJsZSgpXHJcbiAgICBdLCBMZXRCaW5kaW5nKTtcclxuICAgIHJldHVybiBMZXRCaW5kaW5nO1xyXG59KCkpO1xuXG52YXIgTGV0SW50ZXJwb2xhdGlvbkJpbmRpbmdFeHByZXNzaW9uID0gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIExldEludGVycG9sYXRpb25CaW5kaW5nRXhwcmVzc2lvbihvYnNlcnZlckxvY2F0b3IsIHRhcmdldFByb3BlcnR5LCBwYXJ0cywgbG9va3VwRnVuY3Rpb25zLCB0b0JpbmRpbmdDb250ZXh0KSB7XHJcbiAgICAgICAgdGhpcy5vYnNlcnZlckxvY2F0b3IgPSBvYnNlcnZlckxvY2F0b3I7XHJcbiAgICAgICAgdGhpcy50YXJnZXRQcm9wZXJ0eSA9IHRhcmdldFByb3BlcnR5O1xyXG4gICAgICAgIHRoaXMucGFydHMgPSBwYXJ0cztcclxuICAgICAgICB0aGlzLmxvb2t1cEZ1bmN0aW9ucyA9IGxvb2t1cEZ1bmN0aW9ucztcclxuICAgICAgICB0aGlzLnRvQmluZGluZ0NvbnRleHQgPSB0b0JpbmRpbmdDb250ZXh0O1xyXG4gICAgfVxyXG4gICAgTGV0SW50ZXJwb2xhdGlvbkJpbmRpbmdFeHByZXNzaW9uLnByb3RvdHlwZS5jcmVhdGVCaW5kaW5nID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiBuZXcgTGV0SW50ZXJwb2xhdGlvbkJpbmRpbmcodGhpcy5vYnNlcnZlckxvY2F0b3IsIHRoaXMudGFyZ2V0UHJvcGVydHksIHRoaXMucGFydHMsIHRoaXMubG9va3VwRnVuY3Rpb25zLCB0aGlzLnRvQmluZGluZ0NvbnRleHQpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBMZXRJbnRlcnBvbGF0aW9uQmluZGluZ0V4cHJlc3Npb247XHJcbn0oKSk7XHJcbnZhciBMZXRJbnRlcnBvbGF0aW9uQmluZGluZyA9IChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBMZXRJbnRlcnBvbGF0aW9uQmluZGluZyhvYnNlcnZlckxvY2F0b3IsIHRhcmdldFByb3BlcnR5LCBwYXJ0cywgbG9va3VwRnVuY3Rpb25zLCB0b0JpbmRpbmdDb250ZXh0KSB7XHJcbiAgICAgICAgdGhpcy5vYnNlcnZlckxvY2F0b3IgPSBvYnNlcnZlckxvY2F0b3I7XHJcbiAgICAgICAgdGhpcy5wYXJ0cyA9IHBhcnRzO1xyXG4gICAgICAgIHRoaXMudGFyZ2V0UHJvcGVydHkgPSB0YXJnZXRQcm9wZXJ0eTtcclxuICAgICAgICB0aGlzLmxvb2t1cEZ1bmN0aW9ucyA9IGxvb2t1cEZ1bmN0aW9ucztcclxuICAgICAgICB0aGlzLnRvQmluZGluZ0NvbnRleHQgPSB0b0JpbmRpbmdDb250ZXh0O1xyXG4gICAgICAgIHRoaXMudGFyZ2V0ID0gbnVsbDtcclxuICAgIH1cclxuICAgIExldEludGVycG9sYXRpb25CaW5kaW5nLnByb3RvdHlwZS5iaW5kID0gZnVuY3Rpb24gKHNvdXJjZSkge1xyXG4gICAgICAgIGlmICh0aGlzLmlzQm91bmQpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuc291cmNlID09PSBzb3VyY2UpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLnVuYmluZCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmlzQm91bmQgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xyXG4gICAgICAgIHRoaXMudGFyZ2V0ID0gdGhpcy50b0JpbmRpbmdDb250ZXh0ID8gc291cmNlLmJpbmRpbmdDb250ZXh0IDogc291cmNlLm92ZXJyaWRlQ29udGV4dDtcclxuICAgICAgICB0aGlzLmludGVycG9sYXRpb25CaW5kaW5nID0gdGhpcy5jcmVhdGVJbnRlcnBvbGF0aW9uQmluZGluZygpO1xyXG4gICAgICAgIHRoaXMuaW50ZXJwb2xhdGlvbkJpbmRpbmcuYmluZChzb3VyY2UpO1xyXG4gICAgfTtcclxuICAgIExldEludGVycG9sYXRpb25CaW5kaW5nLnByb3RvdHlwZS51bmJpbmQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmlzQm91bmQpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmlzQm91bmQgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLnNvdXJjZSA9IG51bGw7XHJcbiAgICAgICAgdGhpcy50YXJnZXQgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuaW50ZXJwb2xhdGlvbkJpbmRpbmcudW5iaW5kKCk7XHJcbiAgICAgICAgdGhpcy5pbnRlcnBvbGF0aW9uQmluZGluZyA9IG51bGw7XHJcbiAgICB9O1xyXG4gICAgTGV0SW50ZXJwb2xhdGlvbkJpbmRpbmcucHJvdG90eXBlLmNyZWF0ZUludGVycG9sYXRpb25CaW5kaW5nID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICh0aGlzLnBhcnRzLmxlbmd0aCA9PT0gMykge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IENoaWxkSW50ZXJwb2xhdGlvbkJpbmRpbmcodGhpcy50YXJnZXQsIHRoaXMub2JzZXJ2ZXJMb2NhdG9yLCB0aGlzLnBhcnRzWzFdLCBiaW5kaW5nTW9kZS50b1ZpZXcsIHRoaXMubG9va3VwRnVuY3Rpb25zLCB0aGlzLnRhcmdldFByb3BlcnR5LCB0aGlzLnBhcnRzWzBdLCB0aGlzLnBhcnRzWzJdKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG5ldyBJbnRlcnBvbGF0aW9uQmluZGluZyh0aGlzLm9ic2VydmVyTG9jYXRvciwgdGhpcy5wYXJ0cywgdGhpcy50YXJnZXQsIHRoaXMudGFyZ2V0UHJvcGVydHksIGJpbmRpbmdNb2RlLnRvVmlldywgdGhpcy5sb29rdXBGdW5jdGlvbnMpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBMZXRJbnRlcnBvbGF0aW9uQmluZGluZztcclxufSgpKTtcblxudmFyIFN5bnRheEludGVycHJldGVyID0gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFN5bnRheEludGVycHJldGVyKHBhcnNlciwgb2JzZXJ2ZXJMb2NhdG9yLCBldmVudE1hbmFnZXIsIGF0dHJpYnV0ZU1hcCkge1xyXG4gICAgICAgIHRoaXMucGFyc2VyID0gcGFyc2VyO1xyXG4gICAgICAgIHRoaXMub2JzZXJ2ZXJMb2NhdG9yID0gb2JzZXJ2ZXJMb2NhdG9yO1xyXG4gICAgICAgIHRoaXMuZXZlbnRNYW5hZ2VyID0gZXZlbnRNYW5hZ2VyO1xyXG4gICAgICAgIHRoaXMuYXR0cmlidXRlTWFwID0gYXR0cmlidXRlTWFwO1xyXG4gICAgfVxyXG4gICAgU3ludGF4SW50ZXJwcmV0ZXIucHJvdG90eXBlLmludGVycHJldCA9IGZ1bmN0aW9uIChyZXNvdXJjZXMsIGVsZW1lbnQsIGluZm8sIGV4aXN0aW5nSW5zdHJ1Y3Rpb24sIGNvbnRleHQpIHtcclxuICAgICAgICBpZiAoaW5mby5jb21tYW5kIGluIHRoaXMpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXNbaW5mby5jb21tYW5kXShyZXNvdXJjZXMsIGVsZW1lbnQsIGluZm8sIGV4aXN0aW5nSW5zdHJ1Y3Rpb24sIGNvbnRleHQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5oYW5kbGVVbmtub3duQ29tbWFuZChyZXNvdXJjZXMsIGVsZW1lbnQsIGluZm8sIGV4aXN0aW5nSW5zdHJ1Y3Rpb24sIGNvbnRleHQpO1xyXG4gICAgfTtcclxuICAgIFN5bnRheEludGVycHJldGVyLnByb3RvdHlwZS5oYW5kbGVVbmtub3duQ29tbWFuZCA9IGZ1bmN0aW9uIChyZXNvdXJjZXMsIGVsZW1lbnQsIGluZm8sIGV4aXN0aW5nSW5zdHJ1Y3Rpb24sIGNvbnRleHQpIHtcclxuICAgICAgICBMb2dNYW5hZ2VyLmdldExvZ2dlcigndGVtcGxhdGluZy1iaW5kaW5nJykud2FybignVW5rbm93biBiaW5kaW5nIGNvbW1hbmQuJywgaW5mbyk7XHJcbiAgICAgICAgcmV0dXJuIGV4aXN0aW5nSW5zdHJ1Y3Rpb247XHJcbiAgICB9O1xyXG4gICAgU3ludGF4SW50ZXJwcmV0ZXIucHJvdG90eXBlLmRldGVybWluZURlZmF1bHRCaW5kaW5nTW9kZSA9IGZ1bmN0aW9uIChlbGVtZW50LCBhdHRyTmFtZSwgY29udGV4dCkge1xyXG4gICAgICAgIHZhciB0YWdOYW1lID0gZWxlbWVudC50YWdOYW1lLnRvTG93ZXJDYXNlKCk7XHJcbiAgICAgICAgaWYgKHRhZ05hbWUgPT09ICdpbnB1dCcgJiYgKGF0dHJOYW1lID09PSAndmFsdWUnIHx8IGF0dHJOYW1lID09PSAnZmlsZXMnKSAmJiBlbGVtZW50LnR5cGUgIT09ICdjaGVja2JveCcgJiYgZWxlbWVudC50eXBlICE9PSAncmFkaW8nXHJcbiAgICAgICAgICAgIHx8IHRhZ05hbWUgPT09ICdpbnB1dCcgJiYgYXR0ck5hbWUgPT09ICdjaGVja2VkJyAmJiAoZWxlbWVudC50eXBlID09PSAnY2hlY2tib3gnIHx8IGVsZW1lbnQudHlwZSA9PT0gJ3JhZGlvJylcclxuICAgICAgICAgICAgfHwgKHRhZ05hbWUgPT09ICd0ZXh0YXJlYScgfHwgdGFnTmFtZSA9PT0gJ3NlbGVjdCcpICYmIGF0dHJOYW1lID09PSAndmFsdWUnXHJcbiAgICAgICAgICAgIHx8IChhdHRyTmFtZSA9PT0gJ3RleHRjb250ZW50JyB8fCBhdHRyTmFtZSA9PT0gJ2lubmVyaHRtbCcpICYmIGVsZW1lbnQuY29udGVudEVkaXRhYmxlID09PSAndHJ1ZSdcclxuICAgICAgICAgICAgfHwgYXR0ck5hbWUgPT09ICdzY3JvbGx0b3AnXHJcbiAgICAgICAgICAgIHx8IGF0dHJOYW1lID09PSAnc2Nyb2xsbGVmdCcpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGJpbmRpbmdNb2RlLnR3b1dheTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGNvbnRleHRcclxuICAgICAgICAgICAgJiYgYXR0ck5hbWUgaW4gY29udGV4dC5hdHRyaWJ1dGVzXHJcbiAgICAgICAgICAgICYmIGNvbnRleHQuYXR0cmlidXRlc1thdHRyTmFtZV1cclxuICAgICAgICAgICAgJiYgY29udGV4dC5hdHRyaWJ1dGVzW2F0dHJOYW1lXS5kZWZhdWx0QmluZGluZ01vZGUgPj0gYmluZGluZ01vZGUub25lVGltZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gY29udGV4dC5hdHRyaWJ1dGVzW2F0dHJOYW1lXS5kZWZhdWx0QmluZGluZ01vZGU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBiaW5kaW5nTW9kZS50b1ZpZXc7XHJcbiAgICB9O1xyXG4gICAgU3ludGF4SW50ZXJwcmV0ZXIucHJvdG90eXBlLmJpbmQgPSBmdW5jdGlvbiAocmVzb3VyY2VzLCBlbGVtZW50LCBpbmZvLCBleGlzdGluZ0luc3RydWN0aW9uLCBjb250ZXh0KSB7XHJcbiAgICAgICAgdmFyIGluc3RydWN0aW9uID0gZXhpc3RpbmdJbnN0cnVjdGlvbiB8fCBCZWhhdmlvckluc3RydWN0aW9uLmF0dHJpYnV0ZShpbmZvLmF0dHJOYW1lKTtcclxuICAgICAgICBpbnN0cnVjdGlvbi5hdHRyaWJ1dGVzW2luZm8uYXR0ck5hbWVdID0gbmV3IEJpbmRpbmdFeHByZXNzaW9uKHRoaXMub2JzZXJ2ZXJMb2NhdG9yLCB0aGlzLmF0dHJpYnV0ZU1hcC5tYXAoZWxlbWVudC50YWdOYW1lLCBpbmZvLmF0dHJOYW1lKSwgdGhpcy5wYXJzZXIucGFyc2UoaW5mby5hdHRyVmFsdWUpLCBpbmZvLmRlZmF1bHRCaW5kaW5nTW9kZSA9PT0gdW5kZWZpbmVkIHx8IGluZm8uZGVmYXVsdEJpbmRpbmdNb2RlID09PSBudWxsXHJcbiAgICAgICAgICAgID8gdGhpcy5kZXRlcm1pbmVEZWZhdWx0QmluZGluZ01vZGUoZWxlbWVudCwgaW5mby5hdHRyTmFtZSwgY29udGV4dClcclxuICAgICAgICAgICAgOiBpbmZvLmRlZmF1bHRCaW5kaW5nTW9kZSwgcmVzb3VyY2VzLmxvb2t1cEZ1bmN0aW9ucyk7XHJcbiAgICAgICAgcmV0dXJuIGluc3RydWN0aW9uO1xyXG4gICAgfTtcclxuICAgIFN5bnRheEludGVycHJldGVyLnByb3RvdHlwZS50cmlnZ2VyID0gZnVuY3Rpb24gKHJlc291cmNlcywgZWxlbWVudCwgaW5mbykge1xyXG4gICAgICAgIHJldHVybiBuZXcgTGlzdGVuZXJFeHByZXNzaW9uKHRoaXMuZXZlbnRNYW5hZ2VyLCBpbmZvLmF0dHJOYW1lLCB0aGlzLnBhcnNlci5wYXJzZShpbmZvLmF0dHJWYWx1ZSksIGRlbGVnYXRpb25TdHJhdGVneS5ub25lLCB0cnVlLCByZXNvdXJjZXMubG9va3VwRnVuY3Rpb25zKTtcclxuICAgIH07XHJcbiAgICBTeW50YXhJbnRlcnByZXRlci5wcm90b3R5cGUuY2FwdHVyZSA9IGZ1bmN0aW9uIChyZXNvdXJjZXMsIGVsZW1lbnQsIGluZm8pIHtcclxuICAgICAgICByZXR1cm4gbmV3IExpc3RlbmVyRXhwcmVzc2lvbih0aGlzLmV2ZW50TWFuYWdlciwgaW5mby5hdHRyTmFtZSwgdGhpcy5wYXJzZXIucGFyc2UoaW5mby5hdHRyVmFsdWUpLCBkZWxlZ2F0aW9uU3RyYXRlZ3kuY2FwdHVyaW5nLCB0cnVlLCByZXNvdXJjZXMubG9va3VwRnVuY3Rpb25zKTtcclxuICAgIH07XHJcbiAgICBTeW50YXhJbnRlcnByZXRlci5wcm90b3R5cGUuZGVsZWdhdGUgPSBmdW5jdGlvbiAocmVzb3VyY2VzLCBlbGVtZW50LCBpbmZvKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBMaXN0ZW5lckV4cHJlc3Npb24odGhpcy5ldmVudE1hbmFnZXIsIGluZm8uYXR0ck5hbWUsIHRoaXMucGFyc2VyLnBhcnNlKGluZm8uYXR0clZhbHVlKSwgZGVsZWdhdGlvblN0cmF0ZWd5LmJ1YmJsaW5nLCB0cnVlLCByZXNvdXJjZXMubG9va3VwRnVuY3Rpb25zKTtcclxuICAgIH07XHJcbiAgICBTeW50YXhJbnRlcnByZXRlci5wcm90b3R5cGUuY2FsbCA9IGZ1bmN0aW9uIChyZXNvdXJjZXMsIGVsZW1lbnQsIGluZm8sIGV4aXN0aW5nSW5zdHJ1Y3Rpb24pIHtcclxuICAgICAgICB2YXIgaW5zdHJ1Y3Rpb24gPSBleGlzdGluZ0luc3RydWN0aW9uIHx8IEJlaGF2aW9ySW5zdHJ1Y3Rpb24uYXR0cmlidXRlKGluZm8uYXR0ck5hbWUpO1xyXG4gICAgICAgIGluc3RydWN0aW9uLmF0dHJpYnV0ZXNbaW5mby5hdHRyTmFtZV0gPSBuZXcgQ2FsbEV4cHJlc3Npb24odGhpcy5vYnNlcnZlckxvY2F0b3IsIGluZm8uYXR0ck5hbWUsIHRoaXMucGFyc2VyLnBhcnNlKGluZm8uYXR0clZhbHVlKSwgcmVzb3VyY2VzLmxvb2t1cEZ1bmN0aW9ucyk7XHJcbiAgICAgICAgcmV0dXJuIGluc3RydWN0aW9uO1xyXG4gICAgfTtcclxuICAgIFN5bnRheEludGVycHJldGVyLnByb3RvdHlwZS5vcHRpb25zID0gZnVuY3Rpb24gKHJlc291cmNlcywgZWxlbWVudCwgaW5mbywgZXhpc3RpbmdJbnN0cnVjdGlvbiwgY29udGV4dCkge1xyXG4gICAgICAgIHZhciBpbnN0cnVjdGlvbiA9IGV4aXN0aW5nSW5zdHJ1Y3Rpb24gfHwgQmVoYXZpb3JJbnN0cnVjdGlvbi5hdHRyaWJ1dGUoaW5mby5hdHRyTmFtZSk7XHJcbiAgICAgICAgdmFyIGF0dHJWYWx1ZSA9IGluZm8uYXR0clZhbHVlO1xyXG4gICAgICAgIHZhciBsYW5ndWFnZSA9IHRoaXMubGFuZ3VhZ2U7XHJcbiAgICAgICAgdmFyIG5hbWUgPSBudWxsO1xyXG4gICAgICAgIHZhciB0YXJnZXQgPSAnJztcclxuICAgICAgICB2YXIgY3VycmVudDtcclxuICAgICAgICB2YXIgaTtcclxuICAgICAgICB2YXIgaWk7XHJcbiAgICAgICAgdmFyIGluU3RyaW5nID0gZmFsc2U7XHJcbiAgICAgICAgdmFyIGluRXNjYXBlID0gZmFsc2U7XHJcbiAgICAgICAgdmFyIGZvdW5kTmFtZSA9IGZhbHNlO1xyXG4gICAgICAgIGZvciAoaSA9IDAsIGlpID0gYXR0clZhbHVlLmxlbmd0aDsgaSA8IGlpOyArK2kpIHtcclxuICAgICAgICAgICAgY3VycmVudCA9IGF0dHJWYWx1ZVtpXTtcclxuICAgICAgICAgICAgaWYgKGN1cnJlbnQgPT09ICc7JyAmJiAhaW5TdHJpbmcpIHtcclxuICAgICAgICAgICAgICAgIGlmICghZm91bmROYW1lKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbmFtZSA9IHRoaXMuX2dldFByaW1hcnlQcm9wZXJ0eU5hbWUocmVzb3VyY2VzLCBjb250ZXh0KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGluZm8gPSBsYW5ndWFnZS5pbnNwZWN0QXR0cmlidXRlKHJlc291cmNlcywgJz8nLCBuYW1lLCB0YXJnZXQudHJpbSgpKTtcclxuICAgICAgICAgICAgICAgIGxhbmd1YWdlLmNyZWF0ZUF0dHJpYnV0ZUluc3RydWN0aW9uKHJlc291cmNlcywgZWxlbWVudCwgaW5mbywgaW5zdHJ1Y3Rpb24sIGNvbnRleHQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFpbnN0cnVjdGlvbi5hdHRyaWJ1dGVzW2luZm8uYXR0ck5hbWVdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaW5zdHJ1Y3Rpb24uYXR0cmlidXRlc1tpbmZvLmF0dHJOYW1lXSA9IGluZm8uYXR0clZhbHVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGFyZ2V0ID0gJyc7XHJcbiAgICAgICAgICAgICAgICBuYW1lID0gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChjdXJyZW50ID09PSAnOicgJiYgbmFtZSA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgZm91bmROYW1lID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIG5hbWUgPSB0YXJnZXQudHJpbSgpO1xyXG4gICAgICAgICAgICAgICAgdGFyZ2V0ID0gJyc7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoY3VycmVudCA9PT0gJ1xcXFwnKSB7XHJcbiAgICAgICAgICAgICAgICB0YXJnZXQgKz0gY3VycmVudDtcclxuICAgICAgICAgICAgICAgIGluRXNjYXBlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGFyZ2V0ICs9IGN1cnJlbnQ7XHJcbiAgICAgICAgICAgICAgICBpZiAobmFtZSAhPT0gbnVsbCAmJiBpbkVzY2FwZSA9PT0gZmFsc2UgJiYgY3VycmVudCA9PT0gJ1xcJycpIHtcclxuICAgICAgICAgICAgICAgICAgICBpblN0cmluZyA9ICFpblN0cmluZztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpbkVzY2FwZSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIWZvdW5kTmFtZSkge1xyXG4gICAgICAgICAgICBuYW1lID0gdGhpcy5fZ2V0UHJpbWFyeVByb3BlcnR5TmFtZShyZXNvdXJjZXMsIGNvbnRleHQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAobmFtZSAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICBpbmZvID0gbGFuZ3VhZ2UuaW5zcGVjdEF0dHJpYnV0ZShyZXNvdXJjZXMsICc/JywgbmFtZSwgdGFyZ2V0LnRyaW0oKSk7XHJcbiAgICAgICAgICAgIGxhbmd1YWdlLmNyZWF0ZUF0dHJpYnV0ZUluc3RydWN0aW9uKHJlc291cmNlcywgZWxlbWVudCwgaW5mbywgaW5zdHJ1Y3Rpb24sIGNvbnRleHQpO1xyXG4gICAgICAgICAgICBpZiAoIWluc3RydWN0aW9uLmF0dHJpYnV0ZXNbaW5mby5hdHRyTmFtZV0pIHtcclxuICAgICAgICAgICAgICAgIGluc3RydWN0aW9uLmF0dHJpYnV0ZXNbaW5mby5hdHRyTmFtZV0gPSBpbmZvLmF0dHJWYWx1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gaW5zdHJ1Y3Rpb247XHJcbiAgICB9O1xyXG4gICAgU3ludGF4SW50ZXJwcmV0ZXIucHJvdG90eXBlLl9nZXRQcmltYXJ5UHJvcGVydHlOYW1lID0gZnVuY3Rpb24gKHJlc291cmNlcywgY29udGV4dCkge1xyXG4gICAgICAgIHZhciB0eXBlID0gcmVzb3VyY2VzLmdldEF0dHJpYnV0ZShjb250ZXh0LmF0dHJpYnV0ZU5hbWUpO1xyXG4gICAgICAgIGlmICh0eXBlICYmIHR5cGUucHJpbWFyeVByb3BlcnR5KSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0eXBlLnByaW1hcnlQcm9wZXJ0eS5hdHRyaWJ1dGU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfTtcclxuICAgIFN5bnRheEludGVycHJldGVyLnByb3RvdHlwZVsnZm9yJ10gPSBmdW5jdGlvbiAocmVzb3VyY2VzLCBlbGVtZW50LCBpbmZvLCBleGlzdGluZ0luc3RydWN0aW9uKSB7XHJcbiAgICAgICAgdmFyIHBhcnRzO1xyXG4gICAgICAgIHZhciBrZXlWYWx1ZTtcclxuICAgICAgICB2YXIgaW5zdHJ1Y3Rpb247XHJcbiAgICAgICAgdmFyIGF0dHJWYWx1ZTtcclxuICAgICAgICB2YXIgaXNEZXN0cnVjdHVyaW5nO1xyXG4gICAgICAgIGF0dHJWYWx1ZSA9IGluZm8uYXR0clZhbHVlO1xyXG4gICAgICAgIGlzRGVzdHJ1Y3R1cmluZyA9IGF0dHJWYWx1ZS5tYXRjaCgvXiAqW1tdLitbXFxdXS8pO1xyXG4gICAgICAgIHBhcnRzID0gaXNEZXN0cnVjdHVyaW5nID8gYXR0clZhbHVlLnNwbGl0KCdvZiAnKSA6IGF0dHJWYWx1ZS5zcGxpdCgnIG9mICcpO1xyXG4gICAgICAgIGlmIChwYXJ0cy5sZW5ndGggIT09IDIpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbmNvcnJlY3Qgc3ludGF4IGZvciBcImZvclwiLiBUaGUgZm9ybSBpczogXCIkbG9jYWwgb2YgJGl0ZW1zXCIgb3IgXCJbJGtleSwgJHZhbHVlXSBvZiAkaXRlbXNcIi4nKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaW5zdHJ1Y3Rpb24gPSBleGlzdGluZ0luc3RydWN0aW9uIHx8IEJlaGF2aW9ySW5zdHJ1Y3Rpb24uYXR0cmlidXRlKGluZm8uYXR0ck5hbWUpO1xyXG4gICAgICAgIGlmIChpc0Rlc3RydWN0dXJpbmcpIHtcclxuICAgICAgICAgICAga2V5VmFsdWUgPSBwYXJ0c1swXS5yZXBsYWNlKC9bW1xcXV0vZywgJycpLnJlcGxhY2UoLywvZywgJyAnKS5yZXBsYWNlKC9cXHMrL2csICcgJykudHJpbSgpLnNwbGl0KCcgJyk7XHJcbiAgICAgICAgICAgIGluc3RydWN0aW9uLmF0dHJpYnV0ZXMua2V5ID0ga2V5VmFsdWVbMF07XHJcbiAgICAgICAgICAgIGluc3RydWN0aW9uLmF0dHJpYnV0ZXMudmFsdWUgPSBrZXlWYWx1ZVsxXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGluc3RydWN0aW9uLmF0dHJpYnV0ZXMubG9jYWwgPSBwYXJ0c1swXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaW5zdHJ1Y3Rpb24uYXR0cmlidXRlcy5pdGVtcyA9IG5ldyBCaW5kaW5nRXhwcmVzc2lvbih0aGlzLm9ic2VydmVyTG9jYXRvciwgJ2l0ZW1zJywgdGhpcy5wYXJzZXIucGFyc2UocGFydHNbMV0pLCBiaW5kaW5nTW9kZS50b1ZpZXcsIHJlc291cmNlcy5sb29rdXBGdW5jdGlvbnMpO1xyXG4gICAgICAgIHJldHVybiBpbnN0cnVjdGlvbjtcclxuICAgIH07XHJcbiAgICBTeW50YXhJbnRlcnByZXRlci5wcm90b3R5cGVbJ3R3by13YXknXSA9IGZ1bmN0aW9uIChyZXNvdXJjZXMsIGVsZW1lbnQsIGluZm8sIGV4aXN0aW5nSW5zdHJ1Y3Rpb24pIHtcclxuICAgICAgICB2YXIgaW5zdHJ1Y3Rpb24gPSBleGlzdGluZ0luc3RydWN0aW9uIHx8IEJlaGF2aW9ySW5zdHJ1Y3Rpb24uYXR0cmlidXRlKGluZm8uYXR0ck5hbWUpO1xyXG4gICAgICAgIGluc3RydWN0aW9uLmF0dHJpYnV0ZXNbaW5mby5hdHRyTmFtZV0gPSBuZXcgQmluZGluZ0V4cHJlc3Npb24odGhpcy5vYnNlcnZlckxvY2F0b3IsIHRoaXMuYXR0cmlidXRlTWFwLm1hcChlbGVtZW50LnRhZ05hbWUsIGluZm8uYXR0ck5hbWUpLCB0aGlzLnBhcnNlci5wYXJzZShpbmZvLmF0dHJWYWx1ZSksIGJpbmRpbmdNb2RlLnR3b1dheSwgcmVzb3VyY2VzLmxvb2t1cEZ1bmN0aW9ucyk7XHJcbiAgICAgICAgcmV0dXJuIGluc3RydWN0aW9uO1xyXG4gICAgfTtcclxuICAgIFN5bnRheEludGVycHJldGVyLnByb3RvdHlwZVsndG8tdmlldyddID0gZnVuY3Rpb24gKHJlc291cmNlcywgZWxlbWVudCwgaW5mbywgZXhpc3RpbmdJbnN0cnVjdGlvbikge1xyXG4gICAgICAgIHZhciBpbnN0cnVjdGlvbiA9IGV4aXN0aW5nSW5zdHJ1Y3Rpb24gfHwgQmVoYXZpb3JJbnN0cnVjdGlvbi5hdHRyaWJ1dGUoaW5mby5hdHRyTmFtZSk7XHJcbiAgICAgICAgaW5zdHJ1Y3Rpb24uYXR0cmlidXRlc1tpbmZvLmF0dHJOYW1lXSA9IG5ldyBCaW5kaW5nRXhwcmVzc2lvbih0aGlzLm9ic2VydmVyTG9jYXRvciwgdGhpcy5hdHRyaWJ1dGVNYXAubWFwKGVsZW1lbnQudGFnTmFtZSwgaW5mby5hdHRyTmFtZSksIHRoaXMucGFyc2VyLnBhcnNlKGluZm8uYXR0clZhbHVlKSwgYmluZGluZ01vZGUudG9WaWV3LCByZXNvdXJjZXMubG9va3VwRnVuY3Rpb25zKTtcclxuICAgICAgICByZXR1cm4gaW5zdHJ1Y3Rpb247XHJcbiAgICB9O1xyXG4gICAgU3ludGF4SW50ZXJwcmV0ZXIucHJvdG90eXBlWydmcm9tLXZpZXcnXSA9IGZ1bmN0aW9uIChyZXNvdXJjZXMsIGVsZW1lbnQsIGluZm8sIGV4aXN0aW5nSW5zdHJ1Y3Rpb24pIHtcclxuICAgICAgICB2YXIgaW5zdHJ1Y3Rpb24gPSBleGlzdGluZ0luc3RydWN0aW9uIHx8IEJlaGF2aW9ySW5zdHJ1Y3Rpb24uYXR0cmlidXRlKGluZm8uYXR0ck5hbWUpO1xyXG4gICAgICAgIGluc3RydWN0aW9uLmF0dHJpYnV0ZXNbaW5mby5hdHRyTmFtZV0gPSBuZXcgQmluZGluZ0V4cHJlc3Npb24odGhpcy5vYnNlcnZlckxvY2F0b3IsIHRoaXMuYXR0cmlidXRlTWFwLm1hcChlbGVtZW50LnRhZ05hbWUsIGluZm8uYXR0ck5hbWUpLCB0aGlzLnBhcnNlci5wYXJzZShpbmZvLmF0dHJWYWx1ZSksIGJpbmRpbmdNb2RlLmZyb21WaWV3LCByZXNvdXJjZXMubG9va3VwRnVuY3Rpb25zKTtcclxuICAgICAgICByZXR1cm4gaW5zdHJ1Y3Rpb247XHJcbiAgICB9O1xyXG4gICAgU3ludGF4SW50ZXJwcmV0ZXIucHJvdG90eXBlWydvbmUtdGltZSddID0gZnVuY3Rpb24gKHJlc291cmNlcywgZWxlbWVudCwgaW5mbywgZXhpc3RpbmdJbnN0cnVjdGlvbikge1xyXG4gICAgICAgIHZhciBpbnN0cnVjdGlvbiA9IGV4aXN0aW5nSW5zdHJ1Y3Rpb24gfHwgQmVoYXZpb3JJbnN0cnVjdGlvbi5hdHRyaWJ1dGUoaW5mby5hdHRyTmFtZSk7XHJcbiAgICAgICAgaW5zdHJ1Y3Rpb24uYXR0cmlidXRlc1tpbmZvLmF0dHJOYW1lXSA9IG5ldyBCaW5kaW5nRXhwcmVzc2lvbih0aGlzLm9ic2VydmVyTG9jYXRvciwgdGhpcy5hdHRyaWJ1dGVNYXAubWFwKGVsZW1lbnQudGFnTmFtZSwgaW5mby5hdHRyTmFtZSksIHRoaXMucGFyc2VyLnBhcnNlKGluZm8uYXR0clZhbHVlKSwgYmluZGluZ01vZGUub25lVGltZSwgcmVzb3VyY2VzLmxvb2t1cEZ1bmN0aW9ucyk7XHJcbiAgICAgICAgcmV0dXJuIGluc3RydWN0aW9uO1xyXG4gICAgfTtcclxuICAgIFN5bnRheEludGVycHJldGVyLmluamVjdCA9IFtQYXJzZXIsIE9ic2VydmVyTG9jYXRvciwgRXZlbnRNYW5hZ2VyLCBBdHRyaWJ1dGVNYXBdO1xyXG4gICAgcmV0dXJuIFN5bnRheEludGVycHJldGVyO1xyXG59KCkpO1xyXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoU3ludGF4SW50ZXJwcmV0ZXIucHJvdG90eXBlLCAnb25lLXdheScsIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoU3ludGF4SW50ZXJwcmV0ZXIucHJvdG90eXBlLCAndG8tdmlldycpKTtcblxudmFyIGluZm8gPSB7fTtcclxudmFyIFRlbXBsYXRpbmdCaW5kaW5nTGFuZ3VhZ2UgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgX19leHRlbmRzKFRlbXBsYXRpbmdCaW5kaW5nTGFuZ3VhZ2UsIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBUZW1wbGF0aW5nQmluZGluZ0xhbmd1YWdlKHBhcnNlciwgb2JzZXJ2ZXJMb2NhdG9yLCBzeW50YXhJbnRlcnByZXRlciwgYXR0cmlidXRlTWFwKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcclxuICAgICAgICBfdGhpcy5wYXJzZXIgPSBwYXJzZXI7XHJcbiAgICAgICAgX3RoaXMub2JzZXJ2ZXJMb2NhdG9yID0gb2JzZXJ2ZXJMb2NhdG9yO1xyXG4gICAgICAgIF90aGlzLnN5bnRheEludGVycHJldGVyID0gc3ludGF4SW50ZXJwcmV0ZXI7XHJcbiAgICAgICAgX3RoaXMuZW1wdHlTdHJpbmdFeHByZXNzaW9uID0gX3RoaXMucGFyc2VyLnBhcnNlKCdcXCdcXCcnKTtcclxuICAgICAgICBzeW50YXhJbnRlcnByZXRlci5sYW5ndWFnZSA9IF90aGlzO1xyXG4gICAgICAgIF90aGlzLmF0dHJpYnV0ZU1hcCA9IGF0dHJpYnV0ZU1hcDtcclxuICAgICAgICBfdGhpcy50b0JpbmRpbmdDb250ZXh0QXR0ciA9ICd0by1iaW5kaW5nLWNvbnRleHQnO1xyXG4gICAgICAgIHJldHVybiBfdGhpcztcclxuICAgIH1cclxuICAgIFRlbXBsYXRpbmdCaW5kaW5nTGFuZ3VhZ2UucHJvdG90eXBlLmluc3BlY3RBdHRyaWJ1dGUgPSBmdW5jdGlvbiAocmVzb3VyY2VzLCBlbGVtZW50TmFtZSwgYXR0ck5hbWUsIGF0dHJWYWx1ZSkge1xyXG4gICAgICAgIHZhciBwYXJ0cyA9IGF0dHJOYW1lLnNwbGl0KCcuJyk7XHJcbiAgICAgICAgaW5mby5kZWZhdWx0QmluZGluZ01vZGUgPSBudWxsO1xyXG4gICAgICAgIGlmIChwYXJ0cy5sZW5ndGggPT09IDIpIHtcclxuICAgICAgICAgICAgaW5mby5hdHRyTmFtZSA9IHBhcnRzWzBdLnRyaW0oKTtcclxuICAgICAgICAgICAgaW5mby5hdHRyVmFsdWUgPSBhdHRyVmFsdWU7XHJcbiAgICAgICAgICAgIGluZm8uY29tbWFuZCA9IHBhcnRzWzFdLnRyaW0oKTtcclxuICAgICAgICAgICAgaWYgKGluZm8uY29tbWFuZCA9PT0gJ3JlZicpIHtcclxuICAgICAgICAgICAgICAgIGluZm8uZXhwcmVzc2lvbiA9IG5ldyBOYW1lRXhwcmVzc2lvbih0aGlzLnBhcnNlci5wYXJzZShhdHRyVmFsdWUpLCBpbmZvLmF0dHJOYW1lLCByZXNvdXJjZXMubG9va3VwRnVuY3Rpb25zKTtcclxuICAgICAgICAgICAgICAgIGluZm8uY29tbWFuZCA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICBpbmZvLmF0dHJOYW1lID0gJ3JlZic7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpbmZvLmV4cHJlc3Npb24gPSBudWxsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGF0dHJOYW1lID09PSAncmVmJykge1xyXG4gICAgICAgICAgICBpbmZvLmF0dHJOYW1lID0gYXR0ck5hbWU7XHJcbiAgICAgICAgICAgIGluZm8uYXR0clZhbHVlID0gYXR0clZhbHVlO1xyXG4gICAgICAgICAgICBpbmZvLmNvbW1hbmQgPSBudWxsO1xyXG4gICAgICAgICAgICBpbmZvLmV4cHJlc3Npb24gPSBuZXcgTmFtZUV4cHJlc3Npb24odGhpcy5wYXJzZXIucGFyc2UoYXR0clZhbHVlKSwgJ2VsZW1lbnQnLCByZXNvdXJjZXMubG9va3VwRnVuY3Rpb25zKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGluZm8uYXR0ck5hbWUgPSBhdHRyTmFtZTtcclxuICAgICAgICAgICAgaW5mby5hdHRyVmFsdWUgPSBhdHRyVmFsdWU7XHJcbiAgICAgICAgICAgIGluZm8uY29tbWFuZCA9IG51bGw7XHJcbiAgICAgICAgICAgIHZhciBpbnRlcnBvbGF0aW9uUGFydHMgPSB0aGlzLnBhcnNlSW50ZXJwb2xhdGlvbihyZXNvdXJjZXMsIGF0dHJWYWx1ZSk7XHJcbiAgICAgICAgICAgIGlmIChpbnRlcnBvbGF0aW9uUGFydHMgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIGluZm8uZXhwcmVzc2lvbiA9IG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpbmZvLmV4cHJlc3Npb24gPSBuZXcgSW50ZXJwb2xhdGlvbkJpbmRpbmdFeHByZXNzaW9uKHRoaXMub2JzZXJ2ZXJMb2NhdG9yLCB0aGlzLmF0dHJpYnV0ZU1hcC5tYXAoZWxlbWVudE5hbWUsIGF0dHJOYW1lKSwgaW50ZXJwb2xhdGlvblBhcnRzLCBiaW5kaW5nTW9kZS50b1ZpZXcsIHJlc291cmNlcy5sb29rdXBGdW5jdGlvbnMsIGF0dHJOYW1lKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gaW5mbztcclxuICAgIH07XHJcbiAgICBUZW1wbGF0aW5nQmluZGluZ0xhbmd1YWdlLnByb3RvdHlwZS5jcmVhdGVBdHRyaWJ1dGVJbnN0cnVjdGlvbiA9IGZ1bmN0aW9uIChyZXNvdXJjZXMsIGVsZW1lbnQsIHRoZUluZm8sIGV4aXN0aW5nSW5zdHJ1Y3Rpb24sIGNvbnRleHQpIHtcclxuICAgICAgICB2YXIgaW5zdHJ1Y3Rpb247XHJcbiAgICAgICAgaWYgKHRoZUluZm8uZXhwcmVzc2lvbikge1xyXG4gICAgICAgICAgICBpZiAodGhlSW5mby5hdHRyTmFtZSA9PT0gJ3JlZicpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGVJbmZvLmV4cHJlc3Npb247XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaW5zdHJ1Y3Rpb24gPSBleGlzdGluZ0luc3RydWN0aW9uIHx8IEJlaGF2aW9ySW5zdHJ1Y3Rpb24uYXR0cmlidXRlKHRoZUluZm8uYXR0ck5hbWUpO1xyXG4gICAgICAgICAgICBpbnN0cnVjdGlvbi5hdHRyaWJ1dGVzW3RoZUluZm8uYXR0ck5hbWVdID0gdGhlSW5mby5leHByZXNzaW9uO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICh0aGVJbmZvLmNvbW1hbmQpIHtcclxuICAgICAgICAgICAgaW5zdHJ1Y3Rpb24gPSB0aGlzLnN5bnRheEludGVycHJldGVyLmludGVycHJldChyZXNvdXJjZXMsIGVsZW1lbnQsIHRoZUluZm8sIGV4aXN0aW5nSW5zdHJ1Y3Rpb24sIGNvbnRleHQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gaW5zdHJ1Y3Rpb247XHJcbiAgICB9O1xyXG4gICAgVGVtcGxhdGluZ0JpbmRpbmdMYW5ndWFnZS5wcm90b3R5cGUuY3JlYXRlTGV0RXhwcmVzc2lvbnMgPSBmdW5jdGlvbiAocmVzb3VyY2VzLCBsZXRFbGVtZW50KSB7XHJcbiAgICAgICAgdmFyIGV4cHJlc3Npb25zID0gW107XHJcbiAgICAgICAgdmFyIGF0dHJpYnV0ZXMgPSBsZXRFbGVtZW50LmF0dHJpYnV0ZXM7XHJcbiAgICAgICAgdmFyIGF0dHI7XHJcbiAgICAgICAgdmFyIHBhcnRzO1xyXG4gICAgICAgIHZhciBhdHRyTmFtZTtcclxuICAgICAgICB2YXIgYXR0clZhbHVlO1xyXG4gICAgICAgIHZhciBjb21tYW5kO1xyXG4gICAgICAgIHZhciB0b0JpbmRpbmdDb250ZXh0QXR0ciA9IHRoaXMudG9CaW5kaW5nQ29udGV4dEF0dHI7XHJcbiAgICAgICAgdmFyIHRvQmluZGluZ0NvbnRleHQgPSBsZXRFbGVtZW50Lmhhc0F0dHJpYnV0ZSh0b0JpbmRpbmdDb250ZXh0QXR0cik7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGlpID0gYXR0cmlidXRlcy5sZW5ndGg7IGlpID4gaTsgKytpKSB7XHJcbiAgICAgICAgICAgIGF0dHIgPSBhdHRyaWJ1dGVzW2ldO1xyXG4gICAgICAgICAgICBhdHRyTmFtZSA9IGF0dHIubmFtZTtcclxuICAgICAgICAgICAgYXR0clZhbHVlID0gYXR0ci5ub2RlVmFsdWU7XHJcbiAgICAgICAgICAgIHBhcnRzID0gYXR0ck5hbWUuc3BsaXQoJy4nKTtcclxuICAgICAgICAgICAgaWYgKGF0dHJOYW1lID09PSB0b0JpbmRpbmdDb250ZXh0QXR0cikge1xyXG4gICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHBhcnRzLmxlbmd0aCA9PT0gMikge1xyXG4gICAgICAgICAgICAgICAgY29tbWFuZCA9IHBhcnRzWzFdO1xyXG4gICAgICAgICAgICAgICAgaWYgKGNvbW1hbmQgIT09ICdiaW5kJykge1xyXG4gICAgICAgICAgICAgICAgICAgIExvZ01hbmFnZXIuZ2V0TG9nZ2VyKCd0ZW1wbGF0aW5nLWJpbmRpbmctbGFuZ3VhZ2UnKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAud2FybihcIkRldGVjdGVkIGludmFsaWQgbGV0IGNvbW1hbmQuIEV4cGVjdGVkIFxcXCJcIi5jb25jYXQocGFydHNbMF0sIFwiLmJpbmRcXFwiLCBnaXZlbiBcXFwiXCIpLmNvbmNhdChhdHRyTmFtZSwgXCJcXFwiXCIpKTtcclxuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGV4cHJlc3Npb25zLnB1c2gobmV3IExldEV4cHJlc3Npb24odGhpcy5vYnNlcnZlckxvY2F0b3IsIGNhbWVsQ2FzZShwYXJ0c1swXSksIHRoaXMucGFyc2VyLnBhcnNlKGF0dHJWYWx1ZSksIHJlc291cmNlcy5sb29rdXBGdW5jdGlvbnMsIHRvQmluZGluZ0NvbnRleHQpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGF0dHJOYW1lID0gY2FtZWxDYXNlKGF0dHJOYW1lKTtcclxuICAgICAgICAgICAgICAgIHBhcnRzID0gdGhpcy5wYXJzZUludGVycG9sYXRpb24ocmVzb3VyY2VzLCBhdHRyVmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHBhcnRzID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgTG9nTWFuYWdlci5nZXRMb2dnZXIoJ3RlbXBsYXRpbmctYmluZGluZy1sYW5ndWFnZScpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC53YXJuKFwiRGV0ZWN0ZWQgc3RyaW5nIGxpdGVyYWwgaW4gbGV0IGJpbmRpbmdzLiBEaWQgeW91IG1lYW4gXFxcIlwiLmNvbmNhdChhdHRyTmFtZSwgXCIuYmluZD1cIikuY29uY2F0KGF0dHJWYWx1ZSwgXCJcXFwiIG9yIFxcXCJcIikuY29uY2F0KGF0dHJOYW1lLCBcIj0ke1wiKS5jb25jYXQoYXR0clZhbHVlLCBcIn1cXFwiID9cIikpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHBhcnRzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZXhwcmVzc2lvbnMucHVzaChuZXcgTGV0SW50ZXJwb2xhdGlvbkJpbmRpbmdFeHByZXNzaW9uKHRoaXMub2JzZXJ2ZXJMb2NhdG9yLCBhdHRyTmFtZSwgcGFydHMsIHJlc291cmNlcy5sb29rdXBGdW5jdGlvbnMsIHRvQmluZGluZ0NvbnRleHQpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGV4cHJlc3Npb25zLnB1c2gobmV3IExldEV4cHJlc3Npb24odGhpcy5vYnNlcnZlckxvY2F0b3IsIGF0dHJOYW1lLCBuZXcgTGl0ZXJhbFN0cmluZyhhdHRyVmFsdWUpLCByZXNvdXJjZXMubG9va3VwRnVuY3Rpb25zLCB0b0JpbmRpbmdDb250ZXh0KSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGV4cHJlc3Npb25zO1xyXG4gICAgfTtcclxuICAgIFRlbXBsYXRpbmdCaW5kaW5nTGFuZ3VhZ2UucHJvdG90eXBlLmluc3BlY3RUZXh0Q29udGVudCA9IGZ1bmN0aW9uIChyZXNvdXJjZXMsIHZhbHVlKSB7XHJcbiAgICAgICAgdmFyIHBhcnRzID0gdGhpcy5wYXJzZUludGVycG9sYXRpb24ocmVzb3VyY2VzLCB2YWx1ZSk7XHJcbiAgICAgICAgaWYgKHBhcnRzID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbmV3IEludGVycG9sYXRpb25CaW5kaW5nRXhwcmVzc2lvbih0aGlzLm9ic2VydmVyTG9jYXRvciwgJ3RleHRDb250ZW50JywgcGFydHMsIGJpbmRpbmdNb2RlLnRvVmlldywgcmVzb3VyY2VzLmxvb2t1cEZ1bmN0aW9ucywgJ3RleHRDb250ZW50Jyk7XHJcbiAgICB9O1xyXG4gICAgVGVtcGxhdGluZ0JpbmRpbmdMYW5ndWFnZS5wcm90b3R5cGUucGFyc2VJbnRlcnBvbGF0aW9uID0gZnVuY3Rpb24gKHJlc291cmNlcywgdmFsdWUpIHtcclxuICAgICAgICB2YXIgaSA9IHZhbHVlLmluZGV4T2YoJyR7JywgMCk7XHJcbiAgICAgICAgdmFyIGlpID0gdmFsdWUubGVuZ3RoO1xyXG4gICAgICAgIHZhciBjaGFyO1xyXG4gICAgICAgIHZhciBwb3MgPSAwO1xyXG4gICAgICAgIHZhciBvcGVuID0gMDtcclxuICAgICAgICB2YXIgcXVvdGUgPSBudWxsO1xyXG4gICAgICAgIHZhciBpbnRlcnBvbGF0aW9uU3RhcnQ7XHJcbiAgICAgICAgdmFyIHBhcnRzO1xyXG4gICAgICAgIHZhciBwYXJ0SW5kZXggPSAwO1xyXG4gICAgICAgIHdoaWxlIChpID49IDAgJiYgaSA8IGlpIC0gMikge1xyXG4gICAgICAgICAgICBvcGVuID0gMTtcclxuICAgICAgICAgICAgaW50ZXJwb2xhdGlvblN0YXJ0ID0gaTtcclxuICAgICAgICAgICAgaSArPSAyO1xyXG4gICAgICAgICAgICBkbyB7XHJcbiAgICAgICAgICAgICAgICBjaGFyID0gdmFsdWVbaV07XHJcbiAgICAgICAgICAgICAgICBpKys7XHJcbiAgICAgICAgICAgICAgICBpZiAoY2hhciA9PT0gXCInXCIgfHwgY2hhciA9PT0gJ1wiJykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChxdW90ZSA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBxdW90ZSA9IGNoYXI7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHF1b3RlID09PSBjaGFyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHF1b3RlID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoY2hhciA9PT0gJ1xcXFwnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaSsrO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHF1b3RlICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoY2hhciA9PT0gJ3snKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgb3BlbisrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoY2hhciA9PT0gJ30nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgb3Blbi0tO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IHdoaWxlIChvcGVuID4gMCAmJiBpIDwgaWkpO1xyXG4gICAgICAgICAgICBpZiAob3BlbiA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgcGFydHMgPSBwYXJ0cyB8fCBbXTtcclxuICAgICAgICAgICAgICAgIGlmICh2YWx1ZVtpbnRlcnBvbGF0aW9uU3RhcnQgLSAxXSA9PT0gJ1xcXFwnICYmIHZhbHVlW2ludGVycG9sYXRpb25TdGFydCAtIDJdICE9PSAnXFxcXCcpIHtcclxuICAgICAgICAgICAgICAgICAgICBwYXJ0c1twYXJ0SW5kZXhdID0gdmFsdWUuc3Vic3RyaW5nKHBvcywgaW50ZXJwb2xhdGlvblN0YXJ0IC0gMSkgKyB2YWx1ZS5zdWJzdHJpbmcoaW50ZXJwb2xhdGlvblN0YXJ0LCBpKTtcclxuICAgICAgICAgICAgICAgICAgICBwYXJ0SW5kZXgrKztcclxuICAgICAgICAgICAgICAgICAgICBwYXJ0c1twYXJ0SW5kZXhdID0gdGhpcy5lbXB0eVN0cmluZ0V4cHJlc3Npb247XHJcbiAgICAgICAgICAgICAgICAgICAgcGFydEluZGV4Kys7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBwYXJ0c1twYXJ0SW5kZXhdID0gdmFsdWUuc3Vic3RyaW5nKHBvcywgaW50ZXJwb2xhdGlvblN0YXJ0KTtcclxuICAgICAgICAgICAgICAgICAgICBwYXJ0SW5kZXgrKztcclxuICAgICAgICAgICAgICAgICAgICBwYXJ0c1twYXJ0SW5kZXhdID0gdGhpcy5wYXJzZXIucGFyc2UodmFsdWUuc3Vic3RyaW5nKGludGVycG9sYXRpb25TdGFydCArIDIsIGkgLSAxKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcGFydEluZGV4Kys7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBwb3MgPSBpO1xyXG4gICAgICAgICAgICAgICAgaSA9IHZhbHVlLmluZGV4T2YoJyR7JywgaSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAocGFydEluZGV4ID09PSAwKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICBwYXJ0c1twYXJ0SW5kZXhdID0gdmFsdWUuc3Vic3RyKHBvcyk7XHJcbiAgICAgICAgcmV0dXJuIHBhcnRzO1xyXG4gICAgfTtcclxuICAgIFRlbXBsYXRpbmdCaW5kaW5nTGFuZ3VhZ2UuaW5qZWN0ID0gW1BhcnNlciwgT2JzZXJ2ZXJMb2NhdG9yLCBTeW50YXhJbnRlcnByZXRlciwgQXR0cmlidXRlTWFwXTtcclxuICAgIHJldHVybiBUZW1wbGF0aW5nQmluZGluZ0xhbmd1YWdlO1xyXG59KEJpbmRpbmdMYW5ndWFnZSkpO1xuXG5mdW5jdGlvbiBjb25maWd1cmUoY29uZmlnKSB7XHJcbiAgICBjb25maWcuY29udGFpbmVyLnJlZ2lzdGVyU2luZ2xldG9uKEJpbmRpbmdMYW5ndWFnZSwgVGVtcGxhdGluZ0JpbmRpbmdMYW5ndWFnZSk7XHJcbiAgICBjb25maWcuY29udGFpbmVyLnJlZ2lzdGVyQWxpYXMoQmluZGluZ0xhbmd1YWdlLCBUZW1wbGF0aW5nQmluZGluZ0xhbmd1YWdlKTtcclxufVxuXG5leHBvcnQgeyBBdHRyaWJ1dGVNYXAsIENoaWxkSW50ZXJwb2xhdGlvbkJpbmRpbmcsIEludGVycG9sYXRpb25CaW5kaW5nLCBJbnRlcnBvbGF0aW9uQmluZGluZ0V4cHJlc3Npb24sIExldEJpbmRpbmcsIExldEV4cHJlc3Npb24sIExldEludGVycG9sYXRpb25CaW5kaW5nLCBMZXRJbnRlcnBvbGF0aW9uQmluZGluZ0V4cHJlc3Npb24sIFN5bnRheEludGVycHJldGVyLCBUZW1wbGF0aW5nQmluZGluZ0xhbmd1YWdlLCBjb25maWd1cmUgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWF1cmVsaWEtdGVtcGxhdGluZy1iaW5kaW5nLmpzLm1hcFxuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///aurelia-templating-binding\n");

/***/ }),

/***/ "aurelia-templating-resources":
/*!*******************************************************************************************************!*\
  !*** ./node_modules/aurelia-templating-resources/dist/native-modules/aurelia-templating-resources.js ***!
  \*******************************************************************************************************/
/*! exports provided: AbstractRepeater, ArrayRepeatStrategy, AttrBindingBehavior, BindingSignaler, Compose, DebounceBindingBehavior, Else, Focus, FromViewBindingBehavior, HTMLSanitizer, Hide, If, MapRepeatStrategy, NullRepeatStrategy, NumberRepeatStrategy, OneTimeBindingBehavior, OneWayBindingBehavior, Repeat, RepeatStrategyLocator, Replaceable, SanitizeHTMLValueConverter, SelfBindingBehavior, SetRepeatStrategy, Show, SignalBindingBehavior, ThrottleBindingBehavior, ToViewBindingBehavior, TwoWayBindingBehavior, UpdateTriggerBindingBehavior, With, configure, createFullOverrideContext, getItemsSourceExpression, isOneTime, unwrapExpression, updateOneTimeBinding, updateOverrideContext, viewsRequireLifecycle */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"AbstractRepeater\", function() { return AbstractRepeater; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ArrayRepeatStrategy\", function() { return ArrayRepeatStrategy; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"AttrBindingBehavior\", function() { return AttrBindingBehavior; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"BindingSignaler\", function() { return BindingSignaler; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Compose\", function() { return Compose; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DebounceBindingBehavior\", function() { return DebounceBindingBehavior; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Else\", function() { return Else; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Focus\", function() { return Focus; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"FromViewBindingBehavior\", function() { return FromViewBindingBehavior; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"HTMLSanitizer\", function() { return HTMLSanitizer; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Hide\", function() { return Hide; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"If\", function() { return If; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"MapRepeatStrategy\", function() { return MapRepeatStrategy; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"NullRepeatStrategy\", function() { return NullRepeatStrategy; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"NumberRepeatStrategy\", function() { return NumberRepeatStrategy; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"OneTimeBindingBehavior\", function() { return OneTimeBindingBehavior; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"OneWayBindingBehavior\", function() { return OneWayBindingBehavior; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Repeat\", function() { return Repeat; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"RepeatStrategyLocator\", function() { return RepeatStrategyLocator; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Replaceable\", function() { return Replaceable; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SanitizeHTMLValueConverter\", function() { return SanitizeHTMLValueConverter; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SelfBindingBehavior\", function() { return SelfBindingBehavior; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SetRepeatStrategy\", function() { return SetRepeatStrategy; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Show\", function() { return Show; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SignalBindingBehavior\", function() { return SignalBindingBehavior; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ThrottleBindingBehavior\", function() { return ThrottleBindingBehavior; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ToViewBindingBehavior\", function() { return ToViewBindingBehavior; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"TwoWayBindingBehavior\", function() { return TwoWayBindingBehavior; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"UpdateTriggerBindingBehavior\", function() { return UpdateTriggerBindingBehavior; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"With\", function() { return With; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"configure\", function() { return configure; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"createFullOverrideContext\", function() { return createFullOverrideContext; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getItemsSourceExpression\", function() { return getItemsSourceExpression; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isOneTime\", function() { return isOneTime; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"unwrapExpression\", function() { return unwrapExpression; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"updateOneTimeBinding\", function() { return updateOneTimeBinding; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"updateOverrideContext\", function() { return updateOverrideContext; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"viewsRequireLifecycle\", function() { return viewsRequireLifecycle; });\n/* harmony import */ var aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! aurelia-dependency-injection */ \"3U8n\");\n/* harmony import */ var aurelia_pal__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! aurelia-pal */ \"70NS\");\n/* harmony import */ var aurelia_task_queue__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! aurelia-task-queue */ \"K/SW\");\n/* harmony import */ var aurelia_templating__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! aurelia-templating */ \"hij8\");\n/* harmony import */ var aurelia_binding__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! aurelia-binding */ \"X5gX\");\n/* harmony import */ var aurelia_loader__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! aurelia-loader */ \"ZdUM\");\n/* harmony import */ var aurelia_path__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! aurelia-path */ \"iD3O\");\n/* harmony import */ var aurelia_metadata__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! aurelia-metadata */ \"qrcG\");\n/* harmony import */ var aurelia_logging__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! aurelia-logging */ \"MP1E\");\n\n\n\n\n\n\n\n\n\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nfunction __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nfunction __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\n\nvar ActivationStrategy;\r\n(function (ActivationStrategy) {\r\n    ActivationStrategy[\"InvokeLifecycle\"] = \"invoke-lifecycle\";\r\n    ActivationStrategy[\"Replace\"] = \"replace\";\r\n})(ActivationStrategy || (ActivationStrategy = {}));\r\nvar Compose = (function () {\r\n    function Compose(element, container, compositionEngine, viewSlot, viewResources, taskQueue) {\r\n        this.activationStrategy = ActivationStrategy.InvokeLifecycle;\r\n        this.element = element;\r\n        this.container = container;\r\n        this.compositionEngine = compositionEngine;\r\n        this.viewSlot = viewSlot;\r\n        this.viewResources = viewResources;\r\n        this.taskQueue = taskQueue;\r\n        this.currentController = null;\r\n        this.currentViewModel = null;\r\n        this.changes = Object.create(null);\r\n    }\r\n    Compose.inject = function () {\r\n        return [aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].Element, aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_0__[\"Container\"], aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"CompositionEngine\"], aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ViewSlot\"], aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ViewResources\"], aurelia_task_queue__WEBPACK_IMPORTED_MODULE_2__[\"TaskQueue\"]];\r\n    };\r\n    Compose.prototype.created = function (owningView) {\r\n        this.owningView = owningView;\r\n    };\r\n    Compose.prototype.bind = function (bindingContext, overrideContext) {\r\n        this.bindingContext = bindingContext;\r\n        this.overrideContext = overrideContext;\r\n        var changes = this.changes;\r\n        changes.view = this.view;\r\n        changes.viewModel = this.viewModel;\r\n        changes.model = this.model;\r\n        if (!this.pendingTask) {\r\n            processChanges(this);\r\n        }\r\n    };\r\n    Compose.prototype.unbind = function () {\r\n        this.changes = Object.create(null);\r\n        this.bindingContext = null;\r\n        this.overrideContext = null;\r\n        var returnToCache = true;\r\n        var skipAnimation = true;\r\n        this.viewSlot.removeAll(returnToCache, skipAnimation);\r\n    };\r\n    Compose.prototype.modelChanged = function (newValue, oldValue) {\r\n        this.changes.model = newValue;\r\n        requestUpdate(this);\r\n    };\r\n    Compose.prototype.viewChanged = function (newValue, oldValue) {\r\n        this.changes.view = newValue;\r\n        requestUpdate(this);\r\n    };\r\n    Compose.prototype.viewModelChanged = function (newValue, oldValue) {\r\n        this.changes.viewModel = newValue;\r\n        requestUpdate(this);\r\n    };\r\n    __decorate([\r\n        aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"bindable\"]\r\n    ], Compose.prototype, \"model\", void 0);\r\n    __decorate([\r\n        aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"bindable\"]\r\n    ], Compose.prototype, \"view\", void 0);\r\n    __decorate([\r\n        aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"bindable\"]\r\n    ], Compose.prototype, \"viewModel\", void 0);\r\n    __decorate([\r\n        aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"bindable\"]\r\n    ], Compose.prototype, \"activationStrategy\", void 0);\r\n    __decorate([\r\n        aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"bindable\"]\r\n    ], Compose.prototype, \"swapOrder\", void 0);\r\n    Compose = __decorate([\r\n        aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"noView\"],\r\n        Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"customElement\"])('compose')\r\n    ], Compose);\r\n    return Compose;\r\n}());\r\nfunction isEmpty(obj) {\r\n    for (var _ in obj) {\r\n        return false;\r\n    }\r\n    return true;\r\n}\r\nfunction tryActivateViewModel(vm, model) {\r\n    if (vm && typeof vm.activate === 'function') {\r\n        return Promise.resolve(vm.activate(model));\r\n    }\r\n}\r\nfunction createInstruction(composer, instruction) {\r\n    return Object.assign(instruction, {\r\n        bindingContext: composer.bindingContext,\r\n        overrideContext: composer.overrideContext,\r\n        owningView: composer.owningView,\r\n        container: composer.container,\r\n        viewSlot: composer.viewSlot,\r\n        viewResources: composer.viewResources,\r\n        currentController: composer.currentController,\r\n        host: composer.element,\r\n        swapOrder: composer.swapOrder\r\n    });\r\n}\r\nfunction processChanges(composer) {\r\n    var changes = composer.changes;\r\n    composer.changes = Object.create(null);\r\n    if (needsReInitialization(composer, changes)) {\r\n        var instruction = {\r\n            view: composer.view,\r\n            viewModel: composer.currentViewModel || composer.viewModel,\r\n            model: composer.model\r\n        };\r\n        instruction = Object.assign(instruction, changes);\r\n        instruction = createInstruction(composer, instruction);\r\n        composer.pendingTask = composer.compositionEngine.compose(instruction).then(function (controller) {\r\n            composer.currentController = controller;\r\n            composer.currentViewModel = controller ? controller.viewModel : null;\r\n        });\r\n    }\r\n    else {\r\n        composer.pendingTask = tryActivateViewModel(composer.currentViewModel, changes.model);\r\n        if (!composer.pendingTask) {\r\n            return;\r\n        }\r\n    }\r\n    composer.pendingTask = composer.pendingTask\r\n        .then(function () {\r\n        completeCompositionTask(composer);\r\n    }, function (reason) {\r\n        completeCompositionTask(composer);\r\n        throw reason;\r\n    });\r\n}\r\nfunction completeCompositionTask(composer) {\r\n    composer.pendingTask = null;\r\n    if (!isEmpty(composer.changes)) {\r\n        processChanges(composer);\r\n    }\r\n}\r\nfunction requestUpdate(composer) {\r\n    if (composer.pendingTask || composer.updateRequested) {\r\n        return;\r\n    }\r\n    composer.updateRequested = true;\r\n    composer.taskQueue.queueMicroTask(function () {\r\n        composer.updateRequested = false;\r\n        processChanges(composer);\r\n    });\r\n}\r\nfunction needsReInitialization(composer, changes) {\r\n    var activationStrategy = composer.activationStrategy;\r\n    var vm = composer.currentViewModel;\r\n    if (vm && typeof vm.determineActivationStrategy === 'function') {\r\n        activationStrategy = vm.determineActivationStrategy();\r\n    }\r\n    return 'view' in changes\r\n        || 'viewModel' in changes\r\n        || activationStrategy === ActivationStrategy.Replace;\r\n}\n\nvar IfCore = (function () {\r\n    function IfCore(viewFactory, viewSlot) {\r\n        this.viewFactory = viewFactory;\r\n        this.viewSlot = viewSlot;\r\n        this.view = null;\r\n        this.bindingContext = null;\r\n        this.overrideContext = null;\r\n        this.showing = false;\r\n        this.cache = true;\r\n    }\r\n    IfCore.prototype.bind = function (bindingContext, overrideContext) {\r\n        this.bindingContext = bindingContext;\r\n        this.overrideContext = overrideContext;\r\n    };\r\n    IfCore.prototype.unbind = function () {\r\n        if (this.view === null) {\r\n            return;\r\n        }\r\n        this.view.unbind();\r\n        if (!this.viewFactory.isCaching) {\r\n            return;\r\n        }\r\n        if (this.showing) {\r\n            this.showing = false;\r\n            this.viewSlot.remove(this.view, true, true);\r\n        }\r\n        else {\r\n            this.view.returnToCache();\r\n        }\r\n        this.view = null;\r\n    };\r\n    IfCore.prototype._show = function () {\r\n        if (this.showing) {\r\n            if (!this.view.isBound) {\r\n                this.view.bind(this.bindingContext, this.overrideContext);\r\n            }\r\n            return;\r\n        }\r\n        if (this.view === null) {\r\n            this.view = this.viewFactory.create();\r\n        }\r\n        if (!this.view.isBound) {\r\n            this.view.bind(this.bindingContext, this.overrideContext);\r\n        }\r\n        this.showing = true;\r\n        return this.viewSlot.add(this.view);\r\n    };\r\n    IfCore.prototype._hide = function () {\r\n        var _this = this;\r\n        if (!this.showing) {\r\n            return;\r\n        }\r\n        this.showing = false;\r\n        var removed = this.viewSlot.remove(this.view);\r\n        if (removed instanceof Promise) {\r\n            return removed.then(function () {\r\n                _this._unbindView();\r\n            });\r\n        }\r\n        this._unbindView();\r\n    };\r\n    IfCore.prototype._unbindView = function () {\r\n        var cache = this.cache === 'false' ? false : !!this.cache;\r\n        this.view.unbind();\r\n        if (!cache) {\r\n            this.view = null;\r\n        }\r\n    };\r\n    return IfCore;\r\n}());\n\nvar If = (function (_super) {\r\n    __extends(If, _super);\r\n    function If() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.cache = true;\r\n        return _this;\r\n    }\r\n    If.prototype.bind = function (bindingContext, overrideContext) {\r\n        _super.prototype.bind.call(this, bindingContext, overrideContext);\r\n        if (this.condition) {\r\n            this._show();\r\n        }\r\n        else {\r\n            this._hide();\r\n        }\r\n    };\r\n    If.prototype.conditionChanged = function (newValue) {\r\n        this._update(newValue);\r\n    };\r\n    If.prototype._update = function (show) {\r\n        var _this = this;\r\n        if (this.animating) {\r\n            return;\r\n        }\r\n        var promise;\r\n        if (this.elseVm) {\r\n            promise = show ? this._swap(this.elseVm, this) : this._swap(this, this.elseVm);\r\n        }\r\n        else {\r\n            promise = show ? this._show() : this._hide();\r\n        }\r\n        if (promise) {\r\n            this.animating = true;\r\n            promise.then(function () {\r\n                _this.animating = false;\r\n                if (_this.condition !== _this.showing) {\r\n                    _this._update(_this.condition);\r\n                }\r\n            });\r\n        }\r\n    };\r\n    If.prototype._swap = function (remove, add) {\r\n        switch (this.swapOrder) {\r\n            case 'before':\r\n                return Promise.resolve(add._show()).then(function () { return remove._hide(); });\r\n            case 'with':\r\n                return Promise.all([remove._hide(), add._show()]);\r\n            default:\r\n                var promise = remove._hide();\r\n                return promise ? promise.then(function () { return add._show(); }) : add._show();\r\n        }\r\n    };\r\n    __decorate([\r\n        Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"bindable\"])({ primaryProperty: true })\r\n    ], If.prototype, \"condition\", void 0);\r\n    __decorate([\r\n        aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"bindable\"]\r\n    ], If.prototype, \"swapOrder\", void 0);\r\n    __decorate([\r\n        aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"bindable\"]\r\n    ], If.prototype, \"cache\", void 0);\r\n    If = __decorate([\r\n        Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"customAttribute\"])('if'),\r\n        aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"templateController\"],\r\n        Object(aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_0__[\"inject\"])(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"BoundViewFactory\"], aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ViewSlot\"])\r\n    ], If);\r\n    return If;\r\n}(IfCore));\n\nvar Else = (function (_super) {\r\n    __extends(Else, _super);\r\n    function Else(viewFactory, viewSlot) {\r\n        var _this = _super.call(this, viewFactory, viewSlot) || this;\r\n        _this._registerInIf();\r\n        return _this;\r\n    }\r\n    Else.prototype.bind = function (bindingContext, overrideContext) {\r\n        _super.prototype.bind.call(this, bindingContext, overrideContext);\r\n        if (this.ifVm.condition) {\r\n            this._hide();\r\n        }\r\n        else {\r\n            this._show();\r\n        }\r\n    };\r\n    Else.prototype._registerInIf = function () {\r\n        var previous = this.viewSlot.anchor.previousSibling;\r\n        while (previous && !previous.au) {\r\n            previous = previous.previousSibling;\r\n        }\r\n        if (!previous || !previous.au.if) {\r\n            throw new Error(\"Can't find matching If for Else custom attribute.\");\r\n        }\r\n        this.ifVm = previous.au.if.viewModel;\r\n        this.ifVm.elseVm = this;\r\n    };\r\n    Else = __decorate([\r\n        Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"customAttribute\"])('else'),\r\n        aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"templateController\"],\r\n        Object(aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_0__[\"inject\"])(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"BoundViewFactory\"], aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ViewSlot\"])\r\n    ], Else);\r\n    return Else;\r\n}(IfCore));\n\nvar With = (function () {\r\n    function With(viewFactory, viewSlot) {\r\n        this.viewFactory = viewFactory;\r\n        this.viewSlot = viewSlot;\r\n        this.parentOverrideContext = null;\r\n        this.view = null;\r\n    }\r\n    With.prototype.bind = function (bindingContext, overrideContext) {\r\n        this.parentOverrideContext = overrideContext;\r\n        this.valueChanged(this.value);\r\n    };\r\n    With.prototype.valueChanged = function (newValue) {\r\n        var overrideContext = Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"createOverrideContext\"])(newValue, this.parentOverrideContext);\r\n        var view = this.view;\r\n        if (!view) {\r\n            view = this.view = this.viewFactory.create();\r\n            view.bind(newValue, overrideContext);\r\n            this.viewSlot.add(view);\r\n        }\r\n        else {\r\n            view.bind(newValue, overrideContext);\r\n        }\r\n    };\r\n    With.prototype.unbind = function () {\r\n        var view = this.view;\r\n        this.parentOverrideContext = null;\r\n        if (view) {\r\n            view.unbind();\r\n        }\r\n    };\r\n    With = __decorate([\r\n        Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"customAttribute\"])('with'),\r\n        aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"templateController\"],\r\n        Object(aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_0__[\"inject\"])(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"BoundViewFactory\"], aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ViewSlot\"])\r\n    ], With);\r\n    return With;\r\n}());\n\nvar oneTime = aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingMode\"].oneTime;\r\nfunction updateOverrideContexts(views, startIndex) {\r\n    var length = views.length;\r\n    if (startIndex > 0) {\r\n        startIndex = startIndex - 1;\r\n    }\r\n    for (; startIndex < length; ++startIndex) {\r\n        updateOverrideContext(views[startIndex].overrideContext, startIndex, length);\r\n    }\r\n}\r\nfunction createFullOverrideContext(repeat, data, index, length, key) {\r\n    var bindingContext = {};\r\n    var overrideContext = Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"createOverrideContext\"])(bindingContext, repeat.scope.overrideContext);\r\n    if (typeof key !== 'undefined') {\r\n        bindingContext[repeat.key] = key;\r\n        bindingContext[repeat.value] = data;\r\n    }\r\n    else {\r\n        bindingContext[repeat.local] = data;\r\n    }\r\n    updateOverrideContext(overrideContext, index, length);\r\n    return overrideContext;\r\n}\r\nfunction updateOverrideContext(overrideContext, index, length) {\r\n    var first = (index === 0);\r\n    var last = (index === length - 1);\r\n    var even = index % 2 === 0;\r\n    overrideContext.$index = index;\r\n    overrideContext.$first = first;\r\n    overrideContext.$last = last;\r\n    overrideContext.$middle = !(first || last);\r\n    overrideContext.$odd = !even;\r\n    overrideContext.$even = even;\r\n}\r\nfunction getItemsSourceExpression(instruction, attrName) {\r\n    return instruction.behaviorInstructions\r\n        .filter(function (bi) { return bi.originalAttrName === attrName; })[0]\r\n        .attributes\r\n        .items\r\n        .sourceExpression;\r\n}\r\nfunction unwrapExpression(expression) {\r\n    var unwrapped = false;\r\n    while (expression instanceof aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"BindingBehavior\"]) {\r\n        expression = expression.expression;\r\n    }\r\n    while (expression instanceof aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"ValueConverter\"]) {\r\n        expression = expression.expression;\r\n        unwrapped = true;\r\n    }\r\n    return unwrapped ? expression : null;\r\n}\r\nfunction isOneTime(expression) {\r\n    while (expression instanceof aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"BindingBehavior\"]) {\r\n        if (expression.name === 'oneTime') {\r\n            return true;\r\n        }\r\n        expression = expression.expression;\r\n    }\r\n    return false;\r\n}\r\nfunction updateOneTimeBinding(binding) {\r\n    if (binding.call && binding.mode === oneTime) {\r\n        binding.call(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"sourceContext\"]);\r\n    }\r\n    else if (binding.updateOneTimeBindings) {\r\n        binding.updateOneTimeBindings();\r\n    }\r\n}\r\nfunction indexOf(array, item, matcher, startIndex) {\r\n    if (!matcher) {\r\n        return array.indexOf(item);\r\n    }\r\n    var length = array.length;\r\n    for (var index = startIndex || 0; index < length; index++) {\r\n        if (matcher(array[index], item)) {\r\n            return index;\r\n        }\r\n    }\r\n    return -1;\r\n}\n\nvar ArrayRepeatStrategy = (function () {\r\n    function ArrayRepeatStrategy() {\r\n    }\r\n    ArrayRepeatStrategy.prototype.getCollectionObserver = function (observerLocator, items) {\r\n        return observerLocator.getArrayObserver(items);\r\n    };\r\n    ArrayRepeatStrategy.prototype.instanceChanged = function (repeat, items) {\r\n        var _this = this;\r\n        var $repeat = repeat;\r\n        var itemsLength = items.length;\r\n        if (!items || itemsLength === 0) {\r\n            $repeat.removeAllViews(true, !$repeat.viewsRequireLifecycle);\r\n            return;\r\n        }\r\n        var children = $repeat.views();\r\n        var viewsLength = children.length;\r\n        if (viewsLength === 0) {\r\n            this._standardProcessInstanceChanged($repeat, items);\r\n            return;\r\n        }\r\n        if ($repeat.viewsRequireLifecycle) {\r\n            var childrenSnapshot = children.slice(0);\r\n            var itemNameInBindingContext = $repeat.local;\r\n            var matcher_1 = $repeat.matcher();\r\n            var itemsPreviouslyInViews_1 = [];\r\n            var viewsToRemove = [];\r\n            for (var index = 0; index < viewsLength; index++) {\r\n                var view = childrenSnapshot[index];\r\n                var oldItem = view.bindingContext[itemNameInBindingContext];\r\n                if (indexOf(items, oldItem, matcher_1) === -1) {\r\n                    viewsToRemove.push(view);\r\n                }\r\n                else {\r\n                    itemsPreviouslyInViews_1.push(oldItem);\r\n                }\r\n            }\r\n            var updateViews = void 0;\r\n            var removePromise = void 0;\r\n            if (itemsPreviouslyInViews_1.length > 0) {\r\n                removePromise = $repeat.removeViews(viewsToRemove, true, !$repeat.viewsRequireLifecycle);\r\n                updateViews = function () {\r\n                    for (var index = 0; index < itemsLength; index++) {\r\n                        var item = items[index];\r\n                        var indexOfView = indexOf(itemsPreviouslyInViews_1, item, matcher_1, index);\r\n                        var view = void 0;\r\n                        if (indexOfView === -1) {\r\n                            var overrideContext = createFullOverrideContext($repeat, items[index], index, itemsLength);\r\n                            $repeat.insertView(index, overrideContext.bindingContext, overrideContext);\r\n                            itemsPreviouslyInViews_1.splice(index, 0, undefined);\r\n                        }\r\n                        else if (indexOfView === index) {\r\n                            view = children[indexOfView];\r\n                            itemsPreviouslyInViews_1[indexOfView] = undefined;\r\n                        }\r\n                        else {\r\n                            view = children[indexOfView];\r\n                            $repeat.moveView(indexOfView, index);\r\n                            itemsPreviouslyInViews_1.splice(indexOfView, 1);\r\n                            itemsPreviouslyInViews_1.splice(index, 0, undefined);\r\n                        }\r\n                        if (view) {\r\n                            updateOverrideContext(view.overrideContext, index, itemsLength);\r\n                        }\r\n                    }\r\n                    _this._inPlaceProcessItems($repeat, items);\r\n                };\r\n            }\r\n            else {\r\n                removePromise = $repeat.removeAllViews(true, !$repeat.viewsRequireLifecycle);\r\n                updateViews = function () { return _this._standardProcessInstanceChanged($repeat, items); };\r\n            }\r\n            if (removePromise instanceof Promise) {\r\n                removePromise.then(updateViews);\r\n            }\r\n            else {\r\n                updateViews();\r\n            }\r\n        }\r\n        else {\r\n            this._inPlaceProcessItems($repeat, items);\r\n        }\r\n    };\r\n    ArrayRepeatStrategy.prototype._standardProcessInstanceChanged = function (repeat, items) {\r\n        for (var i = 0, ii = items.length; i < ii; i++) {\r\n            var overrideContext = createFullOverrideContext(repeat, items[i], i, ii);\r\n            repeat.addView(overrideContext.bindingContext, overrideContext);\r\n        }\r\n    };\r\n    ArrayRepeatStrategy.prototype._inPlaceProcessItems = function (repeat, items) {\r\n        var itemsLength = items.length;\r\n        var viewsLength = repeat.viewCount();\r\n        while (viewsLength > itemsLength) {\r\n            viewsLength--;\r\n            repeat.removeView(viewsLength, true, !repeat.viewsRequireLifecycle);\r\n        }\r\n        var local = repeat.local;\r\n        for (var i = 0; i < viewsLength; i++) {\r\n            var view = repeat.view(i);\r\n            var last = i === itemsLength - 1;\r\n            var middle = i !== 0 && !last;\r\n            var bindingContext = view.bindingContext;\r\n            var overrideContext = view.overrideContext;\r\n            if (bindingContext[local] === items[i]\r\n                && overrideContext.$middle === middle\r\n                && overrideContext.$last === last) {\r\n                continue;\r\n            }\r\n            bindingContext[local] = items[i];\r\n            overrideContext.$middle = middle;\r\n            overrideContext.$last = last;\r\n            repeat.updateBindings(view);\r\n        }\r\n        for (var i = viewsLength; i < itemsLength; i++) {\r\n            var overrideContext = createFullOverrideContext(repeat, items[i], i, itemsLength);\r\n            repeat.addView(overrideContext.bindingContext, overrideContext);\r\n        }\r\n    };\r\n    ArrayRepeatStrategy.prototype.instanceMutated = function (repeat, array, splices) {\r\n        var _this = this;\r\n        if (repeat.__queuedSplices) {\r\n            for (var i = 0, ii = splices.length; i < ii; ++i) {\r\n                var _a = splices[i], index = _a.index, removed = _a.removed, addedCount = _a.addedCount;\r\n                Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"mergeSplice\"])(repeat.__queuedSplices, index, removed, addedCount);\r\n            }\r\n            repeat.__array = array.slice(0);\r\n            return;\r\n        }\r\n        var maybePromise = this._runSplices(repeat, array.slice(0), splices);\r\n        if (maybePromise instanceof Promise) {\r\n            var queuedSplices_1 = repeat.__queuedSplices = [];\r\n            var runQueuedSplices_1 = function () {\r\n                if (!queuedSplices_1.length) {\r\n                    repeat.__queuedSplices = undefined;\r\n                    repeat.__array = undefined;\r\n                    return;\r\n                }\r\n                var nextPromise = _this._runSplices(repeat, repeat.__array, queuedSplices_1) || Promise.resolve();\r\n                queuedSplices_1 = repeat.__queuedSplices = [];\r\n                nextPromise.then(runQueuedSplices_1);\r\n            };\r\n            maybePromise.then(runQueuedSplices_1);\r\n        }\r\n    };\r\n    ArrayRepeatStrategy.prototype._runSplices = function (repeat, array, splices) {\r\n        var _this = this;\r\n        var removeDelta = 0;\r\n        var rmPromises = [];\r\n        for (var i = 0, ii = splices.length; i < ii; ++i) {\r\n            var splice = splices[i];\r\n            var removed = splice.removed;\r\n            for (var j = 0, jj = removed.length; j < jj; ++j) {\r\n                var viewOrPromise = repeat.removeView(splice.index + removeDelta + rmPromises.length, true);\r\n                if (viewOrPromise instanceof Promise) {\r\n                    rmPromises.push(viewOrPromise);\r\n                }\r\n            }\r\n            removeDelta -= splice.addedCount;\r\n        }\r\n        if (rmPromises.length > 0) {\r\n            return Promise.all(rmPromises).then(function () {\r\n                var spliceIndexLow = _this._handleAddedSplices(repeat, array, splices);\r\n                updateOverrideContexts(repeat.views(), spliceIndexLow);\r\n            });\r\n        }\r\n        var spliceIndexLow = this._handleAddedSplices(repeat, array, splices);\r\n        updateOverrideContexts(repeat.views(), spliceIndexLow);\r\n        return undefined;\r\n    };\r\n    ArrayRepeatStrategy.prototype._handleAddedSplices = function (repeat, array, splices) {\r\n        var spliceIndex;\r\n        var spliceIndexLow;\r\n        var arrayLength = array.length;\r\n        for (var i = 0, ii = splices.length; i < ii; ++i) {\r\n            var splice = splices[i];\r\n            var addIndex = spliceIndex = splice.index;\r\n            var end = splice.index + splice.addedCount;\r\n            if (typeof spliceIndexLow === 'undefined' || spliceIndexLow === null || spliceIndexLow > splice.index) {\r\n                spliceIndexLow = spliceIndex;\r\n            }\r\n            for (; addIndex < end; ++addIndex) {\r\n                var overrideContext = createFullOverrideContext(repeat, array[addIndex], addIndex, arrayLength);\r\n                repeat.insertView(addIndex, overrideContext.bindingContext, overrideContext);\r\n            }\r\n        }\r\n        return spliceIndexLow;\r\n    };\r\n    return ArrayRepeatStrategy;\r\n}());\n\nvar MapRepeatStrategy = (function () {\r\n    function MapRepeatStrategy() {\r\n    }\r\n    MapRepeatStrategy.prototype.getCollectionObserver = function (observerLocator, items) {\r\n        return observerLocator.getMapObserver(items);\r\n    };\r\n    MapRepeatStrategy.prototype.instanceChanged = function (repeat, items) {\r\n        var _this = this;\r\n        var removePromise = repeat.removeAllViews(true, !repeat.viewsRequireLifecycle);\r\n        if (removePromise instanceof Promise) {\r\n            removePromise.then(function () { return _this._standardProcessItems(repeat, items); });\r\n            return;\r\n        }\r\n        this._standardProcessItems(repeat, items);\r\n    };\r\n    MapRepeatStrategy.prototype._standardProcessItems = function (repeat, items) {\r\n        var index = 0;\r\n        var overrideContext;\r\n        items.forEach(function (value, key) {\r\n            overrideContext = createFullOverrideContext(repeat, value, index, items.size, key);\r\n            repeat.addView(overrideContext.bindingContext, overrideContext);\r\n            ++index;\r\n        });\r\n    };\r\n    MapRepeatStrategy.prototype.instanceMutated = function (repeat, map, records) {\r\n        var key;\r\n        var i;\r\n        var ii;\r\n        var overrideContext;\r\n        var removeIndex;\r\n        var addIndex;\r\n        var record;\r\n        var rmPromises = [];\r\n        var viewOrPromise;\r\n        for (i = 0, ii = records.length; i < ii; ++i) {\r\n            record = records[i];\r\n            key = record.key;\r\n            switch (record.type) {\r\n                case 'update':\r\n                    removeIndex = this._getViewIndexByKey(repeat, key);\r\n                    viewOrPromise = repeat.removeView(removeIndex, true, !repeat.viewsRequireLifecycle);\r\n                    if (viewOrPromise instanceof Promise) {\r\n                        rmPromises.push(viewOrPromise);\r\n                    }\r\n                    overrideContext = createFullOverrideContext(repeat, map.get(key), removeIndex, map.size, key);\r\n                    repeat.insertView(removeIndex, overrideContext.bindingContext, overrideContext);\r\n                    break;\r\n                case 'add':\r\n                    addIndex = repeat.viewCount() <= map.size - 1 ? repeat.viewCount() : map.size - 1;\r\n                    overrideContext = createFullOverrideContext(repeat, map.get(key), addIndex, map.size, key);\r\n                    repeat.insertView(map.size - 1, overrideContext.bindingContext, overrideContext);\r\n                    break;\r\n                case 'delete':\r\n                    if (record.oldValue === undefined) {\r\n                        return;\r\n                    }\r\n                    removeIndex = this._getViewIndexByKey(repeat, key);\r\n                    viewOrPromise = repeat.removeView(removeIndex, true, !repeat.viewsRequireLifecycle);\r\n                    if (viewOrPromise instanceof Promise) {\r\n                        rmPromises.push(viewOrPromise);\r\n                    }\r\n                    break;\r\n                case 'clear':\r\n                    repeat.removeAllViews(true, !repeat.viewsRequireLifecycle);\r\n                    break;\r\n                default:\r\n                    continue;\r\n            }\r\n        }\r\n        if (rmPromises.length > 0) {\r\n            Promise.all(rmPromises).then(function () {\r\n                updateOverrideContexts(repeat.views(), 0);\r\n            });\r\n        }\r\n        else {\r\n            updateOverrideContexts(repeat.views(), 0);\r\n        }\r\n    };\r\n    MapRepeatStrategy.prototype._getViewIndexByKey = function (repeat, key) {\r\n        var i;\r\n        var ii;\r\n        var child;\r\n        for (i = 0, ii = repeat.viewCount(); i < ii; ++i) {\r\n            child = repeat.view(i);\r\n            if (child.bindingContext[repeat.key] === key) {\r\n                return i;\r\n            }\r\n        }\r\n        return undefined;\r\n    };\r\n    return MapRepeatStrategy;\r\n}());\n\nvar NullRepeatStrategy = (function () {\r\n    function NullRepeatStrategy() {\r\n    }\r\n    NullRepeatStrategy.prototype.instanceChanged = function (repeat, items) {\r\n        repeat.removeAllViews(true);\r\n    };\r\n    NullRepeatStrategy.prototype.getCollectionObserver = function (observerLocator, items) {\r\n    };\r\n    return NullRepeatStrategy;\r\n}());\n\nvar NumberRepeatStrategy = (function () {\r\n    function NumberRepeatStrategy() {\r\n    }\r\n    NumberRepeatStrategy.prototype.getCollectionObserver = function () {\r\n        return null;\r\n    };\r\n    NumberRepeatStrategy.prototype.instanceChanged = function (repeat, value) {\r\n        var _this = this;\r\n        var removePromise = repeat.removeAllViews(true, !repeat.viewsRequireLifecycle);\r\n        if (removePromise instanceof Promise) {\r\n            removePromise.then(function () { return _this._standardProcessItems(repeat, value); });\r\n            return;\r\n        }\r\n        this._standardProcessItems(repeat, value);\r\n    };\r\n    NumberRepeatStrategy.prototype._standardProcessItems = function (repeat, value) {\r\n        var childrenLength = repeat.viewCount();\r\n        var i;\r\n        var ii;\r\n        var overrideContext;\r\n        var viewsToRemove;\r\n        value = Math.floor(value);\r\n        viewsToRemove = childrenLength - value;\r\n        if (viewsToRemove > 0) {\r\n            if (viewsToRemove > childrenLength) {\r\n                viewsToRemove = childrenLength;\r\n            }\r\n            for (i = 0, ii = viewsToRemove; i < ii; ++i) {\r\n                repeat.removeView(childrenLength - (i + 1), true, !repeat.viewsRequireLifecycle);\r\n            }\r\n            return;\r\n        }\r\n        for (i = childrenLength, ii = value; i < ii; ++i) {\r\n            overrideContext = createFullOverrideContext(repeat, i, i, ii);\r\n            repeat.addView(overrideContext.bindingContext, overrideContext);\r\n        }\r\n        updateOverrideContexts(repeat.views(), 0);\r\n    };\r\n    return NumberRepeatStrategy;\r\n}());\n\nvar SetRepeatStrategy = (function () {\r\n    function SetRepeatStrategy() {\r\n    }\r\n    SetRepeatStrategy.prototype.getCollectionObserver = function (observerLocator, items) {\r\n        return observerLocator.getSetObserver(items);\r\n    };\r\n    SetRepeatStrategy.prototype.instanceChanged = function (repeat, items) {\r\n        var _this = this;\r\n        var removePromise = repeat.removeAllViews(true, !repeat.viewsRequireLifecycle);\r\n        if (removePromise instanceof Promise) {\r\n            removePromise.then(function () { return _this._standardProcessItems(repeat, items); });\r\n            return;\r\n        }\r\n        this._standardProcessItems(repeat, items);\r\n    };\r\n    SetRepeatStrategy.prototype._standardProcessItems = function (repeat, items) {\r\n        var index = 0;\r\n        var overrideContext;\r\n        items.forEach(function (value) {\r\n            overrideContext = createFullOverrideContext(repeat, value, index, items.size);\r\n            repeat.addView(overrideContext.bindingContext, overrideContext);\r\n            ++index;\r\n        });\r\n    };\r\n    SetRepeatStrategy.prototype.instanceMutated = function (repeat, set, records) {\r\n        var value;\r\n        var i;\r\n        var ii;\r\n        var overrideContext;\r\n        var removeIndex;\r\n        var record;\r\n        var rmPromises = [];\r\n        var viewOrPromise;\r\n        for (i = 0, ii = records.length; i < ii; ++i) {\r\n            record = records[i];\r\n            value = record.value;\r\n            switch (record.type) {\r\n                case 'add':\r\n                    var size = Math.max(set.size - 1, 0);\r\n                    overrideContext = createFullOverrideContext(repeat, value, size, set.size);\r\n                    repeat.insertView(size, overrideContext.bindingContext, overrideContext);\r\n                    break;\r\n                case 'delete':\r\n                    removeIndex = this._getViewIndexByValue(repeat, value);\r\n                    viewOrPromise = repeat.removeView(removeIndex, true, !repeat.viewsRequireLifecycle);\r\n                    if (viewOrPromise instanceof Promise) {\r\n                        rmPromises.push(viewOrPromise);\r\n                    }\r\n                    break;\r\n                case 'clear':\r\n                    repeat.removeAllViews(true, !repeat.viewsRequireLifecycle);\r\n                    break;\r\n                default:\r\n                    continue;\r\n            }\r\n        }\r\n        if (rmPromises.length > 0) {\r\n            Promise.all(rmPromises).then(function () {\r\n                updateOverrideContexts(repeat.views(), 0);\r\n            });\r\n        }\r\n        else {\r\n            updateOverrideContexts(repeat.views(), 0);\r\n        }\r\n    };\r\n    SetRepeatStrategy.prototype._getViewIndexByValue = function (repeat, value) {\r\n        var i;\r\n        var ii;\r\n        var child;\r\n        for (i = 0, ii = repeat.viewCount(); i < ii; ++i) {\r\n            child = repeat.view(i);\r\n            if (child.bindingContext[repeat.local] === value) {\r\n                return i;\r\n            }\r\n        }\r\n        return undefined;\r\n    };\r\n    return SetRepeatStrategy;\r\n}());\n\nvar RepeatStrategyLocator = (function () {\r\n    function RepeatStrategyLocator() {\r\n        this.matchers = [];\r\n        this.strategies = [];\r\n        this.addStrategy(function (items) { return items === null || items === undefined; }, new NullRepeatStrategy());\r\n        this.addStrategy(function (items) { return items instanceof Array; }, new ArrayRepeatStrategy());\r\n        this.addStrategy(function (items) { return items instanceof Map; }, new MapRepeatStrategy());\r\n        this.addStrategy(function (items) { return items instanceof Set; }, new SetRepeatStrategy());\r\n        this.addStrategy(function (items) { return typeof items === 'number'; }, new NumberRepeatStrategy());\r\n    }\r\n    RepeatStrategyLocator.prototype.addStrategy = function (matcher, strategy) {\r\n        this.matchers.push(matcher);\r\n        this.strategies.push(strategy);\r\n    };\r\n    RepeatStrategyLocator.prototype.getStrategy = function (items) {\r\n        var matchers = this.matchers;\r\n        for (var i = 0, ii = matchers.length; i < ii; ++i) {\r\n            if (matchers[i](items)) {\r\n                return this.strategies[i];\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    return RepeatStrategyLocator;\r\n}());\n\nvar lifecycleOptionalBehaviors = ['focus', 'if', 'else', 'repeat', 'show', 'hide', 'with'];\r\nfunction behaviorRequiresLifecycle(instruction) {\r\n    var t = instruction.type;\r\n    var name = t.elementName !== null ? t.elementName : t.attributeName;\r\n    return lifecycleOptionalBehaviors.indexOf(name) === -1 && (t.handlesAttached || t.handlesBind || t.handlesCreated || t.handlesDetached || t.handlesUnbind)\r\n        || t.viewFactory && viewsRequireLifecycle(t.viewFactory)\r\n        || instruction.viewFactory && viewsRequireLifecycle(instruction.viewFactory);\r\n}\r\nfunction targetRequiresLifecycle(instruction) {\r\n    var behaviors = instruction.behaviorInstructions;\r\n    if (behaviors) {\r\n        var i = behaviors.length;\r\n        while (i--) {\r\n            if (behaviorRequiresLifecycle(behaviors[i])) {\r\n                return true;\r\n            }\r\n        }\r\n    }\r\n    return instruction.viewFactory && viewsRequireLifecycle(instruction.viewFactory);\r\n}\r\nfunction viewsRequireLifecycle(viewFactory) {\r\n    if ('_viewsRequireLifecycle' in viewFactory) {\r\n        return viewFactory._viewsRequireLifecycle;\r\n    }\r\n    viewFactory._viewsRequireLifecycle = false;\r\n    if (viewFactory.viewFactory) {\r\n        viewFactory._viewsRequireLifecycle = viewsRequireLifecycle(viewFactory.viewFactory);\r\n        return viewFactory._viewsRequireLifecycle;\r\n    }\r\n    if (viewFactory.template.querySelector('.au-animate')) {\r\n        viewFactory._viewsRequireLifecycle = true;\r\n        return true;\r\n    }\r\n    for (var id in viewFactory.instructions) {\r\n        if (targetRequiresLifecycle(viewFactory.instructions[id])) {\r\n            viewFactory._viewsRequireLifecycle = true;\r\n            return true;\r\n        }\r\n    }\r\n    viewFactory._viewsRequireLifecycle = false;\r\n    return false;\r\n}\n\nvar AbstractRepeater = (function () {\r\n    function AbstractRepeater(options) {\r\n        Object.assign(this, {\r\n            local: 'items',\r\n            viewsRequireLifecycle: true\r\n        }, options);\r\n    }\r\n    AbstractRepeater.prototype.viewCount = function () {\r\n        throw new Error('subclass must implement `viewCount`');\r\n    };\r\n    AbstractRepeater.prototype.views = function () {\r\n        throw new Error('subclass must implement `views`');\r\n    };\r\n    AbstractRepeater.prototype.view = function (index) {\r\n        throw new Error('subclass must implement `view`');\r\n    };\r\n    AbstractRepeater.prototype.matcher = function () {\r\n        throw new Error('subclass must implement `matcher`');\r\n    };\r\n    AbstractRepeater.prototype.addView = function (bindingContext, overrideContext) {\r\n        throw new Error('subclass must implement `addView`');\r\n    };\r\n    AbstractRepeater.prototype.insertView = function (index, bindingContext, overrideContext) {\r\n        throw new Error('subclass must implement `insertView`');\r\n    };\r\n    AbstractRepeater.prototype.moveView = function (sourceIndex, targetIndex) {\r\n        throw new Error('subclass must implement `moveView`');\r\n    };\r\n    AbstractRepeater.prototype.removeAllViews = function (returnToCache, skipAnimation) {\r\n        throw new Error('subclass must implement `removeAllViews`');\r\n    };\r\n    AbstractRepeater.prototype.removeViews = function (viewsToRemove, returnToCache, skipAnimation) {\r\n        throw new Error('subclass must implement `removeView`');\r\n    };\r\n    AbstractRepeater.prototype.removeView = function (index, returnToCache, skipAnimation) {\r\n        throw new Error('subclass must implement `removeView`');\r\n    };\r\n    AbstractRepeater.prototype.updateBindings = function (view) {\r\n        throw new Error('subclass must implement `updateBindings`');\r\n    };\r\n    return AbstractRepeater;\r\n}());\n\nvar matcherExtractionMarker = '__marker_extracted__';\r\nvar Repeat = (function (_super) {\r\n    __extends(Repeat, _super);\r\n    function Repeat(viewFactory, instruction, viewSlot, viewResources, observerLocator, strategyLocator) {\r\n        var _this = _super.call(this, {\r\n            local: 'item',\r\n            viewsRequireLifecycle: viewsRequireLifecycle(viewFactory)\r\n        }) || this;\r\n        _this.viewFactory = viewFactory;\r\n        _this.instruction = instruction;\r\n        _this.viewSlot = viewSlot;\r\n        _this.lookupFunctions = viewResources.lookupFunctions;\r\n        _this.observerLocator = observerLocator;\r\n        _this.key = 'key';\r\n        _this.value = 'value';\r\n        _this.strategyLocator = strategyLocator;\r\n        _this.ignoreMutation = false;\r\n        _this.sourceExpression = getItemsSourceExpression(_this.instruction, 'repeat.for');\r\n        _this.isOneTime = isOneTime(_this.sourceExpression);\r\n        _this.viewsRequireLifecycle = viewsRequireLifecycle(viewFactory);\r\n        return _this;\r\n    }\r\n    Repeat_1 = Repeat;\r\n    Repeat.prototype.call = function (context, changes) {\r\n        this[context](this.items, changes);\r\n    };\r\n    Repeat.prototype.bind = function (bindingContext, overrideContext) {\r\n        this.scope = { bindingContext: bindingContext, overrideContext: overrideContext };\r\n        var instruction = this.instruction;\r\n        if (!(matcherExtractionMarker in instruction)) {\r\n            instruction[matcherExtractionMarker] = this._captureAndRemoveMatcherBinding();\r\n        }\r\n        this.matcherBinding = instruction[matcherExtractionMarker];\r\n        this.itemsChanged();\r\n    };\r\n    Repeat.prototype.unbind = function () {\r\n        this.scope = null;\r\n        this.items = null;\r\n        this.matcherBinding = null;\r\n        this.viewSlot.removeAll(true, true);\r\n        this._unsubscribeCollection();\r\n    };\r\n    Repeat.prototype._unsubscribeCollection = function () {\r\n        if (this.collectionObserver) {\r\n            this.collectionObserver.unsubscribe(this.callContext, this);\r\n            this.collectionObserver = null;\r\n            this.callContext = null;\r\n        }\r\n    };\r\n    Repeat.prototype.itemsChanged = function () {\r\n        var _this = this;\r\n        this._unsubscribeCollection();\r\n        if (!this.scope) {\r\n            return;\r\n        }\r\n        var items = this.items;\r\n        this.strategy = this.strategyLocator.getStrategy(items);\r\n        if (!this.strategy) {\r\n            throw new Error(\"Value for '\".concat(this.sourceExpression, \"' is non-repeatable\"));\r\n        }\r\n        if (!this.isOneTime && !this._observeInnerCollection()) {\r\n            this._observeCollection();\r\n        }\r\n        this.ignoreMutation = true;\r\n        this.strategy.instanceChanged(this, items);\r\n        this.observerLocator.taskQueue.queueMicroTask(function () {\r\n            _this.ignoreMutation = false;\r\n        });\r\n    };\r\n    Repeat.prototype._getInnerCollection = function () {\r\n        var expression = unwrapExpression(this.sourceExpression);\r\n        if (!expression) {\r\n            return null;\r\n        }\r\n        return expression.evaluate(this.scope, null);\r\n    };\r\n    Repeat.prototype.handleCollectionMutated = function (collection, changes) {\r\n        if (!this.collectionObserver) {\r\n            return;\r\n        }\r\n        if (this.ignoreMutation) {\r\n            return;\r\n        }\r\n        this.strategy.instanceMutated(this, collection, changes);\r\n    };\r\n    Repeat.prototype.handleInnerCollectionMutated = function (collection, changes) {\r\n        var _this = this;\r\n        if (!this.collectionObserver) {\r\n            return;\r\n        }\r\n        if (this.ignoreMutation) {\r\n            return;\r\n        }\r\n        this.ignoreMutation = true;\r\n        var newItems = this.sourceExpression.evaluate(this.scope, this.lookupFunctions);\r\n        this.observerLocator.taskQueue.queueMicroTask(function () { return _this.ignoreMutation = false; });\r\n        if (newItems === this.items) {\r\n            this.itemsChanged();\r\n        }\r\n        else {\r\n            this.items = newItems;\r\n        }\r\n    };\r\n    Repeat.prototype._observeInnerCollection = function () {\r\n        var items = this._getInnerCollection();\r\n        var strategy = this.strategyLocator.getStrategy(items);\r\n        if (!strategy) {\r\n            return false;\r\n        }\r\n        this.collectionObserver = strategy.getCollectionObserver(this.observerLocator, items);\r\n        if (!this.collectionObserver) {\r\n            return false;\r\n        }\r\n        this.callContext = 'handleInnerCollectionMutated';\r\n        this.collectionObserver.subscribe(this.callContext, this);\r\n        return true;\r\n    };\r\n    Repeat.prototype._observeCollection = function () {\r\n        var items = this.items;\r\n        this.collectionObserver = this.strategy.getCollectionObserver(this.observerLocator, items);\r\n        if (this.collectionObserver) {\r\n            this.callContext = 'handleCollectionMutated';\r\n            this.collectionObserver.subscribe(this.callContext, this);\r\n        }\r\n    };\r\n    Repeat.prototype._captureAndRemoveMatcherBinding = function () {\r\n        var viewFactory = this.viewFactory.viewFactory;\r\n        if (viewFactory) {\r\n            var template = viewFactory.template;\r\n            var instructions = viewFactory.instructions;\r\n            if (Repeat_1.useInnerMatcher) {\r\n                return extractMatcherBindingExpression(instructions);\r\n            }\r\n            if (getChildrenCount(template) > 1) {\r\n                return undefined;\r\n            }\r\n            var repeatedElement = getFirstElementChild(template);\r\n            if (!repeatedElement.hasAttribute('au-target-id')) {\r\n                return undefined;\r\n            }\r\n            var repeatedElementTargetId = repeatedElement.getAttribute('au-target-id');\r\n            return extractMatcherBindingExpression(instructions, repeatedElementTargetId);\r\n        }\r\n        return undefined;\r\n    };\r\n    Repeat.prototype.viewCount = function () { return this.viewSlot.children.length; };\r\n    Repeat.prototype.views = function () { return this.viewSlot.children; };\r\n    Repeat.prototype.view = function (index) { return this.viewSlot.children[index]; };\r\n    Repeat.prototype.matcher = function () {\r\n        var matcherBinding = this.matcherBinding;\r\n        return matcherBinding\r\n            ? matcherBinding.sourceExpression.evaluate(this.scope, matcherBinding.lookupFunctions)\r\n            : null;\r\n    };\r\n    Repeat.prototype.addView = function (bindingContext, overrideContext) {\r\n        var view = this.viewFactory.create();\r\n        view.bind(bindingContext, overrideContext);\r\n        this.viewSlot.add(view);\r\n    };\r\n    Repeat.prototype.insertView = function (index, bindingContext, overrideContext) {\r\n        var view = this.viewFactory.create();\r\n        view.bind(bindingContext, overrideContext);\r\n        this.viewSlot.insert(index, view);\r\n    };\r\n    Repeat.prototype.moveView = function (sourceIndex, targetIndex) {\r\n        this.viewSlot.move(sourceIndex, targetIndex);\r\n    };\r\n    Repeat.prototype.removeAllViews = function (returnToCache, skipAnimation) {\r\n        return this.viewSlot.removeAll(returnToCache, skipAnimation);\r\n    };\r\n    Repeat.prototype.removeViews = function (viewsToRemove, returnToCache, skipAnimation) {\r\n        return this.viewSlot.removeMany(viewsToRemove, returnToCache, skipAnimation);\r\n    };\r\n    Repeat.prototype.removeView = function (index, returnToCache, skipAnimation) {\r\n        return this.viewSlot.removeAt(index, returnToCache, skipAnimation);\r\n    };\r\n    Repeat.prototype.updateBindings = function (view) {\r\n        var $view = view;\r\n        var j = $view.bindings.length;\r\n        while (j--) {\r\n            updateOneTimeBinding($view.bindings[j]);\r\n        }\r\n        j = $view.controllers.length;\r\n        while (j--) {\r\n            var k = $view.controllers[j].boundProperties.length;\r\n            while (k--) {\r\n                var binding = $view.controllers[j].boundProperties[k].binding;\r\n                updateOneTimeBinding(binding);\r\n            }\r\n        }\r\n    };\r\n    var Repeat_1;\r\n    Repeat.useInnerMatcher = true;\r\n    __decorate([\r\n        aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"bindable\"]\r\n    ], Repeat.prototype, \"items\", void 0);\r\n    __decorate([\r\n        aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"bindable\"]\r\n    ], Repeat.prototype, \"local\", void 0);\r\n    __decorate([\r\n        aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"bindable\"]\r\n    ], Repeat.prototype, \"key\", void 0);\r\n    __decorate([\r\n        aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"bindable\"]\r\n    ], Repeat.prototype, \"value\", void 0);\r\n    Repeat = Repeat_1 = __decorate([\r\n        Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"customAttribute\"])('repeat'),\r\n        aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"templateController\"],\r\n        Object(aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_0__[\"inject\"])(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"BoundViewFactory\"], aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"TargetInstruction\"], aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ViewSlot\"], aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ViewResources\"], aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"ObserverLocator\"], RepeatStrategyLocator)\r\n    ], Repeat);\r\n    return Repeat;\r\n}(AbstractRepeater));\r\nvar extractMatcherBindingExpression = function (instructions, targetedElementId) {\r\n    var instructionIds = Object.keys(instructions);\r\n    for (var i = 0; i < instructionIds.length; i++) {\r\n        var instructionId = instructionIds[i];\r\n        if (targetedElementId !== undefined && instructionId !== targetedElementId) {\r\n            continue;\r\n        }\r\n        var expressions = instructions[instructionId].expressions;\r\n        if (expressions) {\r\n            for (var ii = 0; ii < expressions.length; ii++) {\r\n                if (expressions[ii].targetProperty === 'matcher') {\r\n                    var matcherBindingExpression = expressions[ii];\r\n                    expressions.splice(ii, 1);\r\n                    return matcherBindingExpression;\r\n                }\r\n            }\r\n        }\r\n    }\r\n};\r\nvar getChildrenCount = function (el) {\r\n    var childNodes = el.childNodes;\r\n    var count = 0;\r\n    for (var i = 0, ii = childNodes.length; ii > i; ++i) {\r\n        if (childNodes[i].nodeType === 1) {\r\n            ++count;\r\n        }\r\n    }\r\n    return count;\r\n};\r\nvar getFirstElementChild = function (el) {\r\n    var firstChild = el.firstChild;\r\n    while (firstChild !== null) {\r\n        if (firstChild.nodeType === 1) {\r\n            return firstChild;\r\n        }\r\n        firstChild = firstChild.nextSibling;\r\n    }\r\n    return null;\r\n};\n\nvar aureliaHideClassName = 'aurelia-hide';\r\nvar aureliaHideClass = \".\".concat(aureliaHideClassName, \" { display:none !important; }\");\r\nfunction injectAureliaHideStyleAtHead() {\r\n    aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].injectStyles(aureliaHideClass);\r\n}\r\nfunction injectAureliaHideStyleAtBoundary(domBoundary) {\r\n    if (aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"FEATURE\"].shadowDOM && domBoundary && !domBoundary.hasAureliaHideStyle) {\r\n        domBoundary.hasAureliaHideStyle = true;\r\n        aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].injectStyles(aureliaHideClass, domBoundary);\r\n    }\r\n}\n\nvar Show = (function () {\r\n    function Show(element, animator, domBoundary) {\r\n        this.element = element;\r\n        this.animator = animator;\r\n        this.domBoundary = domBoundary;\r\n    }\r\n    Show.inject = function () {\r\n        return [aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].Element, aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"Animator\"], aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_0__[\"Optional\"].of(aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].boundary, true)];\r\n    };\r\n    Show.prototype.created = function () {\r\n        injectAureliaHideStyleAtBoundary(this.domBoundary);\r\n    };\r\n    Show.prototype.valueChanged = function (newValue) {\r\n        var element = this.element;\r\n        var animator = this.animator;\r\n        if (newValue) {\r\n            animator.removeClass(element, aureliaHideClassName);\r\n        }\r\n        else {\r\n            animator.addClass(element, aureliaHideClassName);\r\n        }\r\n    };\r\n    Show.prototype.bind = function (bindingContext) {\r\n        this.valueChanged(this.value);\r\n    };\r\n    Show = __decorate([\r\n        Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"customAttribute\"])('show')\r\n    ], Show);\r\n    return Show;\r\n}());\n\nvar Hide = (function () {\r\n    function Hide(element, animator, domBoundary) {\r\n        this.element = element;\r\n        this.animator = animator;\r\n        this.domBoundary = domBoundary;\r\n    }\r\n    Hide.inject = function () {\r\n        return [aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].Element, aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"Animator\"], aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_0__[\"Optional\"].of(aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].boundary, true)];\r\n    };\r\n    Hide.prototype.created = function () {\r\n        injectAureliaHideStyleAtBoundary(this.domBoundary);\r\n    };\r\n    Hide.prototype.valueChanged = function (newValue) {\r\n        if (newValue) {\r\n            this.animator.addClass(this.element, aureliaHideClassName);\r\n        }\r\n        else {\r\n            this.animator.removeClass(this.element, aureliaHideClassName);\r\n        }\r\n    };\r\n    Hide.prototype.bind = function (bindingContext) {\r\n        this.valueChanged(this.value);\r\n    };\r\n    Hide.prototype.value = function (value) {\r\n        throw new Error('Method not implemented.');\r\n    };\r\n    Hide = __decorate([\r\n        Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"customAttribute\"])('hide')\r\n    ], Hide);\r\n    return Hide;\r\n}());\n\nvar HTMLSanitizer = (function () {\r\n    function HTMLSanitizer() {\r\n    }\r\n    HTMLSanitizer.prototype.sanitize = function (input) {\r\n        throw new Error(\"To protect the application against a wide variety of sophisticated XSS attacks.\\nPlease see https://aurelia.io/docs/binding/basics#element-content for instructions on how to use a secure solution like DOMPurify or sanitize-html.\");\r\n    };\r\n    return HTMLSanitizer;\r\n}());\n\nvar SanitizeHTMLValueConverter = (function () {\r\n    function SanitizeHTMLValueConverter(sanitizer) {\r\n        this.sanitizer = sanitizer;\r\n    }\r\n    SanitizeHTMLValueConverter.prototype.toView = function (untrustedMarkup) {\r\n        if (untrustedMarkup === null || untrustedMarkup === undefined) {\r\n            return null;\r\n        }\r\n        return this.sanitizer.sanitize(untrustedMarkup);\r\n    };\r\n    SanitizeHTMLValueConverter = __decorate([\r\n        Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"valueConverter\"])('sanitizeHTML'),\r\n        Object(aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_0__[\"inject\"])(HTMLSanitizer)\r\n    ], SanitizeHTMLValueConverter);\r\n    return SanitizeHTMLValueConverter;\r\n}());\n\nvar Replaceable = (function () {\r\n    function Replaceable(viewFactory, viewSlot) {\r\n        this.viewFactory = viewFactory;\r\n        this.viewSlot = viewSlot;\r\n        this.view = null;\r\n    }\r\n    Replaceable.prototype.bind = function (bindingContext, overrideContext) {\r\n        if (this.view === null) {\r\n            this.view = this.viewFactory.create();\r\n            this.viewSlot.add(this.view);\r\n        }\r\n        this.view.bind(bindingContext, overrideContext);\r\n    };\r\n    Replaceable.prototype.unbind = function () {\r\n        this.view.unbind();\r\n    };\r\n    Replaceable = __decorate([\r\n        Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"customAttribute\"])('replaceable'),\r\n        aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"templateController\"],\r\n        Object(aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_0__[\"inject\"])(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"BoundViewFactory\"], aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ViewSlot\"])\r\n    ], Replaceable);\r\n    return Replaceable;\r\n}());\n\nvar Focus = (function () {\r\n    function Focus(element, taskQueue) {\r\n        this.element = element;\r\n        this.taskQueue = taskQueue;\r\n        this.isAttached = false;\r\n        this.needsApply = false;\r\n    }\r\n    Focus.inject = function () {\r\n        return [aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].Element, aurelia_task_queue__WEBPACK_IMPORTED_MODULE_2__[\"TaskQueue\"]];\r\n    };\r\n    Focus.prototype.valueChanged = function () {\r\n        if (this.isAttached) {\r\n            this._apply();\r\n        }\r\n        else {\r\n            this.needsApply = true;\r\n        }\r\n    };\r\n    Focus.prototype._apply = function () {\r\n        var _this = this;\r\n        if (this.value) {\r\n            this.taskQueue.queueMicroTask(function () {\r\n                if (_this.value) {\r\n                    _this.element.focus();\r\n                }\r\n            });\r\n        }\r\n        else {\r\n            this.element.blur();\r\n        }\r\n    };\r\n    Focus.prototype.attached = function () {\r\n        this.isAttached = true;\r\n        if (this.needsApply) {\r\n            this.needsApply = false;\r\n            this._apply();\r\n        }\r\n        this.element.addEventListener('focus', this);\r\n        this.element.addEventListener('blur', this);\r\n    };\r\n    Focus.prototype.detached = function () {\r\n        this.isAttached = false;\r\n        this.element.removeEventListener('focus', this);\r\n        this.element.removeEventListener('blur', this);\r\n    };\r\n    Focus.prototype.handleEvent = function (e) {\r\n        if (e.type === 'focus') {\r\n            this.value = true;\r\n        }\r\n        else if (aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].activeElement !== this.element) {\r\n            this.value = false;\r\n        }\r\n    };\r\n    Focus = __decorate([\r\n        Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"customAttribute\"])('focus', aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingMode\"].twoWay)\r\n    ], Focus);\r\n    return Focus;\r\n}());\n\nvar cssUrlMatcher = /url\\((?!['\"]data)([^)]+)\\)/gi;\r\nfunction fixupCSSUrls(address, css) {\r\n    if (typeof css !== 'string') {\r\n        throw new Error(\"Failed loading required CSS file: \".concat(address));\r\n    }\r\n    return css.replace(cssUrlMatcher, function (match, p1) {\r\n        var quote = p1.charAt(0);\r\n        if (quote === '\\'' || quote === '\"') {\r\n            p1 = p1.substr(1, p1.length - 2);\r\n        }\r\n        return 'url(\\'' + Object(aurelia_path__WEBPACK_IMPORTED_MODULE_6__[\"relativeToFile\"])(p1, address) + '\\')';\r\n    });\r\n}\r\nvar CSSResource = (function () {\r\n    function CSSResource(address) {\r\n        this.address = address;\r\n        this._scoped = null;\r\n        this._global = false;\r\n        this._alreadyGloballyInjected = false;\r\n    }\r\n    CSSResource.prototype.initialize = function (container, Target) {\r\n        this._scoped = new Target(this);\r\n    };\r\n    CSSResource.prototype.register = function (registry, name) {\r\n        if (name === 'scoped') {\r\n            registry.registerViewEngineHooks(this._scoped);\r\n        }\r\n        else {\r\n            this._global = true;\r\n        }\r\n    };\r\n    CSSResource.prototype.load = function (container) {\r\n        var _this = this;\r\n        return container.get(aurelia_loader__WEBPACK_IMPORTED_MODULE_5__[\"Loader\"])\r\n            .loadText(this.address)\r\n            .catch(function () { return null; })\r\n            .then(function (text) {\r\n            text = fixupCSSUrls(_this.address, text);\r\n            _this._scoped.css = text;\r\n            if (_this._global) {\r\n                _this._alreadyGloballyInjected = true;\r\n                aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].injectStyles(text);\r\n            }\r\n            return _this;\r\n        });\r\n    };\r\n    return CSSResource;\r\n}());\r\nvar CSSViewEngineHooks = (function () {\r\n    function CSSViewEngineHooks(owner) {\r\n        this.owner = owner;\r\n        this.css = null;\r\n    }\r\n    CSSViewEngineHooks.prototype.beforeCompile = function (content, resources, instruction) {\r\n        if (instruction.targetShadowDOM) {\r\n            aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].injectStyles(this.css, content, true);\r\n        }\r\n        else if (aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"FEATURE\"].scopedCSS) {\r\n            var styleNode = aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].injectStyles(this.css, content, true);\r\n            styleNode.setAttribute('scoped', 'scoped');\r\n        }\r\n        else if (this._global && !this.owner._alreadyGloballyInjected) {\r\n            aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].injectStyles(this.css);\r\n            this.owner._alreadyGloballyInjected = true;\r\n        }\r\n    };\r\n    return CSSViewEngineHooks;\r\n}());\r\nfunction _createCSSResource(address) {\r\n    var ViewCSS = (function (_super) {\r\n        __extends(ViewCSS, _super);\r\n        function ViewCSS() {\r\n            return _super !== null && _super.apply(this, arguments) || this;\r\n        }\r\n        ViewCSS = __decorate([\r\n            Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"resource\"])(new CSSResource(address))\r\n        ], ViewCSS);\r\n        return ViewCSS;\r\n    }(CSSViewEngineHooks));\r\n    return ViewCSS;\r\n}\n\nvar AttrBindingBehavior = (function () {\r\n    function AttrBindingBehavior() {\r\n    }\r\n    AttrBindingBehavior.prototype.bind = function (binding, source) {\r\n        binding.targetObserver = new aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"DataAttributeObserver\"](binding.target, binding.targetProperty);\r\n    };\r\n    AttrBindingBehavior.prototype.unbind = function (binding, source) {\r\n    };\r\n    AttrBindingBehavior = __decorate([\r\n        Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingBehavior\"])('attr')\r\n    ], AttrBindingBehavior);\r\n    return AttrBindingBehavior;\r\n}());\n\nvar modeBindingBehavior = {\r\n    bind: function (binding, source, lookupFunctions) {\r\n        binding.originalMode = binding.mode;\r\n        binding.mode = this.mode;\r\n    },\r\n    unbind: function (binding, source) {\r\n        binding.mode = binding.originalMode;\r\n        binding.originalMode = null;\r\n    }\r\n};\r\nvar OneTimeBindingBehavior = (function () {\r\n    function OneTimeBindingBehavior() {\r\n        this.mode = aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingMode\"].oneTime;\r\n    }\r\n    OneTimeBindingBehavior = __decorate([\r\n        Object(aurelia_metadata__WEBPACK_IMPORTED_MODULE_7__[\"mixin\"])(modeBindingBehavior),\r\n        Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingBehavior\"])('oneTime')\r\n    ], OneTimeBindingBehavior);\r\n    return OneTimeBindingBehavior;\r\n}());\r\nvar OneWayBindingBehavior = (function () {\r\n    function OneWayBindingBehavior() {\r\n        this.mode = aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingMode\"].toView;\r\n    }\r\n    OneWayBindingBehavior = __decorate([\r\n        Object(aurelia_metadata__WEBPACK_IMPORTED_MODULE_7__[\"mixin\"])(modeBindingBehavior),\r\n        Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingBehavior\"])('oneWay')\r\n    ], OneWayBindingBehavior);\r\n    return OneWayBindingBehavior;\r\n}());\r\nvar ToViewBindingBehavior = (function () {\r\n    function ToViewBindingBehavior() {\r\n        this.mode = aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingMode\"].toView;\r\n    }\r\n    ToViewBindingBehavior = __decorate([\r\n        Object(aurelia_metadata__WEBPACK_IMPORTED_MODULE_7__[\"mixin\"])(modeBindingBehavior),\r\n        Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingBehavior\"])('toView')\r\n    ], ToViewBindingBehavior);\r\n    return ToViewBindingBehavior;\r\n}());\r\nvar FromViewBindingBehavior = (function () {\r\n    function FromViewBindingBehavior() {\r\n        this.mode = aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingMode\"].fromView;\r\n    }\r\n    FromViewBindingBehavior = __decorate([\r\n        Object(aurelia_metadata__WEBPACK_IMPORTED_MODULE_7__[\"mixin\"])(modeBindingBehavior),\r\n        Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingBehavior\"])('fromView')\r\n    ], FromViewBindingBehavior);\r\n    return FromViewBindingBehavior;\r\n}());\r\nvar TwoWayBindingBehavior = (function () {\r\n    function TwoWayBindingBehavior() {\r\n        this.mode = aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingMode\"].twoWay;\r\n    }\r\n    TwoWayBindingBehavior = __decorate([\r\n        Object(aurelia_metadata__WEBPACK_IMPORTED_MODULE_7__[\"mixin\"])(modeBindingBehavior),\r\n        Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingBehavior\"])('twoWay')\r\n    ], TwoWayBindingBehavior);\r\n    return TwoWayBindingBehavior;\r\n}());\n\nfunction throttle(newValue) {\r\n    var _this = this;\r\n    var state = this.throttleState;\r\n    var elapsed = +new Date() - state.last;\r\n    if (elapsed >= state.delay) {\r\n        clearTimeout(state.timeoutId);\r\n        state.timeoutId = null;\r\n        state.last = +new Date();\r\n        this.throttledMethod(newValue);\r\n        return;\r\n    }\r\n    state.newValue = newValue;\r\n    if (state.timeoutId === null) {\r\n        state.timeoutId = setTimeout(function () {\r\n            state.timeoutId = null;\r\n            state.last = +new Date();\r\n            _this.throttledMethod(state.newValue);\r\n        }, state.delay - elapsed);\r\n    }\r\n}\r\nvar ThrottleBindingBehavior = (function () {\r\n    function ThrottleBindingBehavior() {\r\n    }\r\n    ThrottleBindingBehavior.prototype.bind = function (binding, source, delay) {\r\n        if (delay === void 0) { delay = 200; }\r\n        var methodToThrottle = 'updateTarget';\r\n        if (binding.callSource) {\r\n            methodToThrottle = 'callSource';\r\n        }\r\n        else if (binding.updateSource && binding.mode === aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingMode\"].twoWay) {\r\n            methodToThrottle = 'updateSource';\r\n        }\r\n        binding.throttledMethod = binding[methodToThrottle];\r\n        binding.throttledMethod.originalName = methodToThrottle;\r\n        binding[methodToThrottle] = throttle;\r\n        binding.throttleState = {\r\n            delay: delay,\r\n            last: 0,\r\n            timeoutId: null\r\n        };\r\n    };\r\n    ThrottleBindingBehavior.prototype.unbind = function (binding, source) {\r\n        var methodToRestore = binding.throttledMethod.originalName;\r\n        binding[methodToRestore] = binding.throttledMethod;\r\n        binding.throttledMethod = null;\r\n        clearTimeout(binding.throttleState.timeoutId);\r\n        binding.throttleState = null;\r\n    };\r\n    ThrottleBindingBehavior = __decorate([\r\n        Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingBehavior\"])('throttle')\r\n    ], ThrottleBindingBehavior);\r\n    return ThrottleBindingBehavior;\r\n}());\n\nvar unset = {};\r\nfunction debounceCallSource(event) {\r\n    var _this = this;\r\n    var state = this.debounceState;\r\n    clearTimeout(state.timeoutId);\r\n    state.timeoutId = setTimeout(function () { return _this.debouncedMethod(event); }, state.delay);\r\n}\r\nfunction debounceCall(context, newValue, oldValue) {\r\n    var _this = this;\r\n    var state = this.debounceState;\r\n    clearTimeout(state.timeoutId);\r\n    if (context !== state.callContextToDebounce) {\r\n        state.oldValue = unset;\r\n        this.debouncedMethod(context, newValue, oldValue);\r\n        return;\r\n    }\r\n    if (state.oldValue === unset) {\r\n        state.oldValue = oldValue;\r\n    }\r\n    state.timeoutId = setTimeout(function () {\r\n        var _oldValue = state.oldValue;\r\n        state.oldValue = unset;\r\n        _this.debouncedMethod(context, newValue, _oldValue);\r\n    }, state.delay);\r\n}\r\nvar DebounceBindingBehavior = (function () {\r\n    function DebounceBindingBehavior() {\r\n    }\r\n    DebounceBindingBehavior.prototype.bind = function (binding, source, delay) {\r\n        if (delay === void 0) { delay = 200; }\r\n        var isCallSource = binding.callSource !== undefined;\r\n        var methodToDebounce = isCallSource ? 'callSource' : 'call';\r\n        var debouncer = isCallSource ? debounceCallSource : debounceCall;\r\n        var mode = binding.mode;\r\n        var callContextToDebounce = mode === aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingMode\"].twoWay || mode === aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingMode\"].fromView ? aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"targetContext\"] : aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"sourceContext\"];\r\n        binding.debouncedMethod = binding[methodToDebounce];\r\n        binding.debouncedMethod.originalName = methodToDebounce;\r\n        binding[methodToDebounce] = debouncer;\r\n        binding.debounceState = {\r\n            callContextToDebounce: callContextToDebounce,\r\n            delay: delay,\r\n            timeoutId: 0,\r\n            oldValue: unset\r\n        };\r\n    };\r\n    DebounceBindingBehavior.prototype.unbind = function (binding, source) {\r\n        var methodToRestore = binding.debouncedMethod.originalName;\r\n        binding[methodToRestore] = binding.debouncedMethod;\r\n        binding.debouncedMethod = null;\r\n        clearTimeout(binding.debounceState.timeoutId);\r\n        binding.debounceState = null;\r\n    };\r\n    DebounceBindingBehavior = __decorate([\r\n        Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingBehavior\"])('debounce')\r\n    ], DebounceBindingBehavior);\r\n    return DebounceBindingBehavior;\r\n}());\n\nfunction findOriginalEventTarget(event) {\r\n    return (event.path && event.path[0]) || (event.deepPath && event.deepPath[0]) || event.target;\r\n}\r\nfunction handleSelfEvent(event) {\r\n    var target = findOriginalEventTarget(event);\r\n    if (this.target !== target) {\r\n        return;\r\n    }\r\n    this.selfEventCallSource(event);\r\n}\r\nvar SelfBindingBehavior = (function () {\r\n    function SelfBindingBehavior() {\r\n    }\r\n    SelfBindingBehavior.prototype.bind = function (binding, source) {\r\n        if (!binding.callSource || !binding.targetEvent) {\r\n            throw new Error('Self binding behavior only supports event.');\r\n        }\r\n        binding.selfEventCallSource = binding.callSource;\r\n        binding.callSource = handleSelfEvent;\r\n    };\r\n    SelfBindingBehavior.prototype.unbind = function (binding, source) {\r\n        binding.callSource = binding.selfEventCallSource;\r\n        binding.selfEventCallSource = null;\r\n    };\r\n    SelfBindingBehavior = __decorate([\r\n        Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingBehavior\"])('self')\r\n    ], SelfBindingBehavior);\r\n    return SelfBindingBehavior;\r\n}());\n\nvar BindingSignaler = (function () {\r\n    function BindingSignaler() {\r\n        this.signals = {};\r\n    }\r\n    BindingSignaler.prototype.signal = function (name) {\r\n        var bindings = this.signals[name];\r\n        if (!bindings) {\r\n            return;\r\n        }\r\n        var i = bindings.length;\r\n        while (i--) {\r\n            bindings[i].call(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"sourceContext\"]);\r\n        }\r\n    };\r\n    return BindingSignaler;\r\n}());\n\nvar SignalBindingBehavior = (function () {\r\n    function SignalBindingBehavior(bindingSignaler) {\r\n        this.signals = bindingSignaler.signals;\r\n    }\r\n    SignalBindingBehavior.inject = function () { return [BindingSignaler]; };\r\n    SignalBindingBehavior.prototype.bind = function (binding, source) {\r\n        var names = [];\r\n        for (var _i = 2; _i < arguments.length; _i++) {\r\n            names[_i - 2] = arguments[_i];\r\n        }\r\n        if (!binding.updateTarget) {\r\n            throw new Error('Only property bindings and string interpolation bindings can be signaled.  Trigger, delegate and call bindings cannot be signaled.');\r\n        }\r\n        var signals = this.signals;\r\n        if (names.length === 1) {\r\n            var name_1 = names[0];\r\n            var bindings = signals[name_1] || (signals[name_1] = []);\r\n            bindings.push(binding);\r\n            binding.signalName = name_1;\r\n        }\r\n        else if (names.length > 1) {\r\n            var i = names.length;\r\n            while (i--) {\r\n                var name_2 = names[i];\r\n                var bindings = signals[name_2] || (signals[name_2] = []);\r\n                bindings.push(binding);\r\n            }\r\n            binding.signalName = names;\r\n        }\r\n        else {\r\n            throw new Error('Signal name is required.');\r\n        }\r\n    };\r\n    SignalBindingBehavior.prototype.unbind = function (binding, source) {\r\n        var signals = this.signals;\r\n        var name = binding.signalName;\r\n        binding.signalName = null;\r\n        if (Array.isArray(name)) {\r\n            var names = name;\r\n            var i = names.length;\r\n            while (i--) {\r\n                var n = names[i];\r\n                var bindings = signals[n];\r\n                bindings.splice(bindings.indexOf(binding), 1);\r\n            }\r\n        }\r\n        else {\r\n            var bindings = signals[name];\r\n            bindings.splice(bindings.indexOf(binding), 1);\r\n        }\r\n    };\r\n    SignalBindingBehavior = __decorate([\r\n        Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingBehavior\"])('signal')\r\n    ], SignalBindingBehavior);\r\n    return SignalBindingBehavior;\r\n}());\n\nvar eventNamesRequired = 'The updateTrigger binding behavior requires at least one event name argument: eg <input value.bind=\"firstName & updateTrigger:\\'blur\\'\">';\r\nvar notApplicableMessage = 'The updateTrigger binding behavior can only be applied to two-way/ from-view bindings on input/select elements.';\r\nvar UpdateTriggerBindingBehavior = (function () {\r\n    function UpdateTriggerBindingBehavior() {\r\n    }\r\n    UpdateTriggerBindingBehavior.prototype.bind = function (binding, source) {\r\n        var events = [];\r\n        for (var _i = 2; _i < arguments.length; _i++) {\r\n            events[_i - 2] = arguments[_i];\r\n        }\r\n        if (events.length === 0) {\r\n            throw new Error(eventNamesRequired);\r\n        }\r\n        if (binding.mode !== aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingMode\"].twoWay && binding.mode !== aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingMode\"].fromView) {\r\n            throw new Error(notApplicableMessage);\r\n        }\r\n        var targetObserver = binding.observerLocator.getObserver(binding.target, binding.targetProperty);\r\n        if (!targetObserver.handler) {\r\n            throw new Error(notApplicableMessage);\r\n        }\r\n        binding.targetObserver = targetObserver;\r\n        targetObserver.originalHandler = binding.targetObserver.handler;\r\n        var handler = new aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"EventSubscriber\"](events);\r\n        targetObserver.handler = handler;\r\n    };\r\n    UpdateTriggerBindingBehavior.prototype.unbind = function (binding, source) {\r\n        var targetObserver = binding.targetObserver;\r\n        targetObserver.handler.dispose();\r\n        targetObserver.handler = targetObserver.originalHandler;\r\n        targetObserver.originalHandler = null;\r\n    };\r\n    UpdateTriggerBindingBehavior = __decorate([\r\n        Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingBehavior\"])('updateTrigger')\r\n    ], UpdateTriggerBindingBehavior);\r\n    return UpdateTriggerBindingBehavior;\r\n}());\n\nfunction _createDynamicElement(_a) {\r\n    var name = _a.name, viewUrl = _a.viewUrl, bindableNames = _a.bindableNames, useShadowDOMmode = _a.useShadowDOMmode;\r\n    var DynamicElement = (function () {\r\n        function DynamicElement() {\r\n        }\r\n        DynamicElement.prototype.bind = function (bindingContext) {\r\n            this.$parent = bindingContext;\r\n        };\r\n        DynamicElement = __decorate([\r\n            Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"customElement\"])(name),\r\n            Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"useView\"])(viewUrl)\r\n        ], DynamicElement);\r\n        return DynamicElement;\r\n    }());\r\n    for (var i = 0, ii = bindableNames.length; i < ii; ++i) {\r\n        Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"bindable\"])(bindableNames[i])(DynamicElement);\r\n    }\r\n    switch (useShadowDOMmode) {\r\n        case 'open':\r\n            Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"useShadowDOM\"])({ mode: 'open' })(DynamicElement);\r\n            break;\r\n        case 'closed':\r\n            Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"useShadowDOM\"])({ mode: 'closed' })(DynamicElement);\r\n            break;\r\n        case '':\r\n            Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"useShadowDOM\"])(DynamicElement);\r\n            break;\r\n        case null:\r\n            break;\r\n        default:\r\n            Object(aurelia_logging__WEBPACK_IMPORTED_MODULE_8__[\"getLogger\"])('aurelia-html-only-element')\r\n                .warn(\"Expected 'use-shadow-dom' value to be \\\"close\\\", \\\"open\\\" or \\\"\\\", received \".concat(useShadowDOMmode));\r\n            break;\r\n    }\r\n    return DynamicElement;\r\n}\n\nfunction getElementName(address) {\r\n    return /([^\\/^\\?]+)\\.html/i.exec(address)[1].toLowerCase();\r\n}\r\nfunction configure$1(config) {\r\n    var viewEngine = config.container.get(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ViewEngine\"]);\r\n    var loader = config.aurelia.loader;\r\n    viewEngine.addResourcePlugin('.html', {\r\n        'fetch': function (viewUrl) {\r\n            return loader.loadTemplate(viewUrl).then(function (registryEntry) {\r\n                var _a;\r\n                var bindableNames = registryEntry.template.getAttribute('bindable');\r\n                var useShadowDOMmode = registryEntry.template.getAttribute('use-shadow-dom');\r\n                var name = getElementName(viewUrl);\r\n                if (bindableNames) {\r\n                    bindableNames = bindableNames.split(',').map(function (x) { return x.trim(); });\r\n                    registryEntry.template.removeAttribute('bindable');\r\n                }\r\n                else {\r\n                    bindableNames = [];\r\n                }\r\n                return _a = {}, _a[name] = _createDynamicElement({ name: name, viewUrl: viewUrl, bindableNames: bindableNames, useShadowDOMmode: useShadowDOMmode }), _a;\r\n            });\r\n        }\r\n    });\r\n}\n\nfunction configure(config) {\r\n    injectAureliaHideStyleAtHead();\r\n    config.globalResources(Compose, If, Else, With, Repeat, Show, Hide, Replaceable, Focus, SanitizeHTMLValueConverter, OneTimeBindingBehavior, OneWayBindingBehavior, ToViewBindingBehavior, FromViewBindingBehavior, TwoWayBindingBehavior, ThrottleBindingBehavior, DebounceBindingBehavior, SelfBindingBehavior, SignalBindingBehavior, UpdateTriggerBindingBehavior, AttrBindingBehavior);\r\n    configure$1(config);\r\n    var viewEngine = config.container.get(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ViewEngine\"]);\r\n    var styleResourcePlugin = {\r\n        fetch: function (address) {\r\n            var _a;\r\n            return _a = {}, _a[address] = _createCSSResource(address), _a;\r\n        }\r\n    };\r\n    ['.css', '.less', '.sass', '.scss', '.styl'].forEach(function (ext) { return viewEngine.addResourcePlugin(ext, styleResourcePlugin); });\r\n}\n\n\n//# sourceMappingURL=aurelia-templating-resources.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXVyZWxpYS10ZW1wbGF0aW5nLXJlc291cmNlcy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9hdXJlbGlhLXRlbXBsYXRpbmctcmVzb3VyY2VzL2Rpc3QvbmF0aXZlLW1vZHVsZXMvYXVyZWxpYS10ZW1wbGF0aW5nLXJlc291cmNlcy5qcz9mY2YyIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbnRhaW5lciwgaW5qZWN0LCBPcHRpb25hbCB9IGZyb20gJ2F1cmVsaWEtZGVwZW5kZW5jeS1pbmplY3Rpb24nO1xuaW1wb3J0IHsgRE9NLCBGRUFUVVJFIH0gZnJvbSAnYXVyZWxpYS1wYWwnO1xuaW1wb3J0IHsgVGFza1F1ZXVlIH0gZnJvbSAnYXVyZWxpYS10YXNrLXF1ZXVlJztcbmltcG9ydCB7IGJpbmRhYmxlLCBub1ZpZXcsIGN1c3RvbUVsZW1lbnQsIENvbXBvc2l0aW9uRW5naW5lLCBWaWV3U2xvdCwgVmlld1Jlc291cmNlcywgY3VzdG9tQXR0cmlidXRlLCB0ZW1wbGF0ZUNvbnRyb2xsZXIsIEJvdW5kVmlld0ZhY3RvcnksIFRhcmdldEluc3RydWN0aW9uLCBBbmltYXRvciwgcmVzb3VyY2UsIHVzZVZpZXcsIHVzZVNoYWRvd0RPTSwgVmlld0VuZ2luZSB9IGZyb20gJ2F1cmVsaWEtdGVtcGxhdGluZyc7XG5pbXBvcnQgeyBjcmVhdGVPdmVycmlkZUNvbnRleHQsIGJpbmRpbmdNb2RlLCBCaW5kaW5nQmVoYXZpb3IsIFZhbHVlQ29udmVydGVyLCBzb3VyY2VDb250ZXh0LCBtZXJnZVNwbGljZSwgT2JzZXJ2ZXJMb2NhdG9yLCB2YWx1ZUNvbnZlcnRlciwgRGF0YUF0dHJpYnV0ZU9ic2VydmVyLCBiaW5kaW5nQmVoYXZpb3IsIHRhcmdldENvbnRleHQsIEV2ZW50U3Vic2NyaWJlciB9IGZyb20gJ2F1cmVsaWEtYmluZGluZyc7XG5pbXBvcnQgeyBMb2FkZXIgfSBmcm9tICdhdXJlbGlhLWxvYWRlcic7XG5pbXBvcnQgeyByZWxhdGl2ZVRvRmlsZSB9IGZyb20gJ2F1cmVsaWEtcGF0aCc7XG5pbXBvcnQgeyBtaXhpbiB9IGZyb20gJ2F1cmVsaWEtbWV0YWRhdGEnO1xuaW1wb3J0IHsgZ2V0TG9nZ2VyIH0gZnJvbSAnYXVyZWxpYS1sb2dnaW5nJztcblxuLyohICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXHJcbkNvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLlxyXG5cclxuUGVybWlzc2lvbiB0byB1c2UsIGNvcHksIG1vZGlmeSwgYW5kL29yIGRpc3RyaWJ1dGUgdGhpcyBzb2Z0d2FyZSBmb3IgYW55XHJcbnB1cnBvc2Ugd2l0aCBvciB3aXRob3V0IGZlZSBpcyBoZXJlYnkgZ3JhbnRlZC5cclxuXHJcblRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIgQU5EIFRIRSBBVVRIT1IgRElTQ0xBSU1TIEFMTCBXQVJSQU5USUVTIFdJVEhcclxuUkVHQVJEIFRPIFRISVMgU09GVFdBUkUgSU5DTFVESU5HIEFMTCBJTVBMSUVEIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZXHJcbkFORCBGSVRORVNTLiBJTiBOTyBFVkVOVCBTSEFMTCBUSEUgQVVUSE9SIEJFIExJQUJMRSBGT1IgQU5ZIFNQRUNJQUwsIERJUkVDVCxcclxuSU5ESVJFQ1QsIE9SIENPTlNFUVVFTlRJQUwgREFNQUdFUyBPUiBBTlkgREFNQUdFUyBXSEFUU09FVkVSIFJFU1VMVElORyBGUk9NXHJcbkxPU1MgT0YgVVNFLCBEQVRBIE9SIFBST0ZJVFMsIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBORUdMSUdFTkNFIE9SXHJcbk9USEVSIFRPUlRJT1VTIEFDVElPTiwgQVJJU0lORyBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBVU0UgT1JcclxuUEVSRk9STUFOQ0UgT0YgVEhJUyBTT0ZUV0FSRS5cclxuKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiogKi9cclxuLyogZ2xvYmFsIFJlZmxlY3QsIFByb21pc2UgKi9cclxuXHJcbnZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24oZCwgYikge1xyXG4gICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxyXG4gICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcclxuICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYiwgcCkpIGRbcF0gPSBiW3BdOyB9O1xyXG4gICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbn07XHJcblxyXG5mdW5jdGlvbiBfX2V4dGVuZHMoZCwgYikge1xyXG4gICAgaWYgKHR5cGVvZiBiICE9PSBcImZ1bmN0aW9uXCIgJiYgYiAhPT0gbnVsbClcclxuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2xhc3MgZXh0ZW5kcyB2YWx1ZSBcIiArIFN0cmluZyhiKSArIFwiIGlzIG5vdCBhIGNvbnN0cnVjdG9yIG9yIG51bGxcIik7XHJcbiAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG4gICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XHJcbiAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIF9fZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpIHtcclxuICAgIHZhciBjID0gYXJndW1lbnRzLmxlbmd0aCwgciA9IGMgPCAzID8gdGFyZ2V0IDogZGVzYyA9PT0gbnVsbCA/IGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHRhcmdldCwga2V5KSA6IGRlc2MsIGQ7XHJcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QuZGVjb3JhdGUgPT09IFwiZnVuY3Rpb25cIikgciA9IFJlZmxlY3QuZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpO1xyXG4gICAgZWxzZSBmb3IgKHZhciBpID0gZGVjb3JhdG9ycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgaWYgKGQgPSBkZWNvcmF0b3JzW2ldKSByID0gKGMgPCAzID8gZChyKSA6IGMgPiAzID8gZCh0YXJnZXQsIGtleSwgcikgOiBkKHRhcmdldCwga2V5KSkgfHwgcjtcclxuICAgIHJldHVybiBjID4gMyAmJiByICYmIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgciksIHI7XHJcbn1cblxudmFyIEFjdGl2YXRpb25TdHJhdGVneTtcclxuKGZ1bmN0aW9uIChBY3RpdmF0aW9uU3RyYXRlZ3kpIHtcclxuICAgIEFjdGl2YXRpb25TdHJhdGVneVtcIkludm9rZUxpZmVjeWNsZVwiXSA9IFwiaW52b2tlLWxpZmVjeWNsZVwiO1xyXG4gICAgQWN0aXZhdGlvblN0cmF0ZWd5W1wiUmVwbGFjZVwiXSA9IFwicmVwbGFjZVwiO1xyXG59KShBY3RpdmF0aW9uU3RyYXRlZ3kgfHwgKEFjdGl2YXRpb25TdHJhdGVneSA9IHt9KSk7XHJcbnZhciBDb21wb3NlID0gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIENvbXBvc2UoZWxlbWVudCwgY29udGFpbmVyLCBjb21wb3NpdGlvbkVuZ2luZSwgdmlld1Nsb3QsIHZpZXdSZXNvdXJjZXMsIHRhc2tRdWV1ZSkge1xyXG4gICAgICAgIHRoaXMuYWN0aXZhdGlvblN0cmF0ZWd5ID0gQWN0aXZhdGlvblN0cmF0ZWd5Lkludm9rZUxpZmVjeWNsZTtcclxuICAgICAgICB0aGlzLmVsZW1lbnQgPSBlbGVtZW50O1xyXG4gICAgICAgIHRoaXMuY29udGFpbmVyID0gY29udGFpbmVyO1xyXG4gICAgICAgIHRoaXMuY29tcG9zaXRpb25FbmdpbmUgPSBjb21wb3NpdGlvbkVuZ2luZTtcclxuICAgICAgICB0aGlzLnZpZXdTbG90ID0gdmlld1Nsb3Q7XHJcbiAgICAgICAgdGhpcy52aWV3UmVzb3VyY2VzID0gdmlld1Jlc291cmNlcztcclxuICAgICAgICB0aGlzLnRhc2tRdWV1ZSA9IHRhc2tRdWV1ZTtcclxuICAgICAgICB0aGlzLmN1cnJlbnRDb250cm9sbGVyID0gbnVsbDtcclxuICAgICAgICB0aGlzLmN1cnJlbnRWaWV3TW9kZWwgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuY2hhbmdlcyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XHJcbiAgICB9XHJcbiAgICBDb21wb3NlLmluamVjdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gW0RPTS5FbGVtZW50LCBDb250YWluZXIsIENvbXBvc2l0aW9uRW5naW5lLCBWaWV3U2xvdCwgVmlld1Jlc291cmNlcywgVGFza1F1ZXVlXTtcclxuICAgIH07XHJcbiAgICBDb21wb3NlLnByb3RvdHlwZS5jcmVhdGVkID0gZnVuY3Rpb24gKG93bmluZ1ZpZXcpIHtcclxuICAgICAgICB0aGlzLm93bmluZ1ZpZXcgPSBvd25pbmdWaWV3O1xyXG4gICAgfTtcclxuICAgIENvbXBvc2UucHJvdG90eXBlLmJpbmQgPSBmdW5jdGlvbiAoYmluZGluZ0NvbnRleHQsIG92ZXJyaWRlQ29udGV4dCkge1xyXG4gICAgICAgIHRoaXMuYmluZGluZ0NvbnRleHQgPSBiaW5kaW5nQ29udGV4dDtcclxuICAgICAgICB0aGlzLm92ZXJyaWRlQ29udGV4dCA9IG92ZXJyaWRlQ29udGV4dDtcclxuICAgICAgICB2YXIgY2hhbmdlcyA9IHRoaXMuY2hhbmdlcztcclxuICAgICAgICBjaGFuZ2VzLnZpZXcgPSB0aGlzLnZpZXc7XHJcbiAgICAgICAgY2hhbmdlcy52aWV3TW9kZWwgPSB0aGlzLnZpZXdNb2RlbDtcclxuICAgICAgICBjaGFuZ2VzLm1vZGVsID0gdGhpcy5tb2RlbDtcclxuICAgICAgICBpZiAoIXRoaXMucGVuZGluZ1Rhc2spIHtcclxuICAgICAgICAgICAgcHJvY2Vzc0NoYW5nZXModGhpcyk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIENvbXBvc2UucHJvdG90eXBlLnVuYmluZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLmNoYW5nZXMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xyXG4gICAgICAgIHRoaXMuYmluZGluZ0NvbnRleHQgPSBudWxsO1xyXG4gICAgICAgIHRoaXMub3ZlcnJpZGVDb250ZXh0ID0gbnVsbDtcclxuICAgICAgICB2YXIgcmV0dXJuVG9DYWNoZSA9IHRydWU7XHJcbiAgICAgICAgdmFyIHNraXBBbmltYXRpb24gPSB0cnVlO1xyXG4gICAgICAgIHRoaXMudmlld1Nsb3QucmVtb3ZlQWxsKHJldHVyblRvQ2FjaGUsIHNraXBBbmltYXRpb24pO1xyXG4gICAgfTtcclxuICAgIENvbXBvc2UucHJvdG90eXBlLm1vZGVsQ2hhbmdlZCA9IGZ1bmN0aW9uIChuZXdWYWx1ZSwgb2xkVmFsdWUpIHtcclxuICAgICAgICB0aGlzLmNoYW5nZXMubW9kZWwgPSBuZXdWYWx1ZTtcclxuICAgICAgICByZXF1ZXN0VXBkYXRlKHRoaXMpO1xyXG4gICAgfTtcclxuICAgIENvbXBvc2UucHJvdG90eXBlLnZpZXdDaGFuZ2VkID0gZnVuY3Rpb24gKG5ld1ZhbHVlLCBvbGRWYWx1ZSkge1xyXG4gICAgICAgIHRoaXMuY2hhbmdlcy52aWV3ID0gbmV3VmFsdWU7XHJcbiAgICAgICAgcmVxdWVzdFVwZGF0ZSh0aGlzKTtcclxuICAgIH07XHJcbiAgICBDb21wb3NlLnByb3RvdHlwZS52aWV3TW9kZWxDaGFuZ2VkID0gZnVuY3Rpb24gKG5ld1ZhbHVlLCBvbGRWYWx1ZSkge1xyXG4gICAgICAgIHRoaXMuY2hhbmdlcy52aWV3TW9kZWwgPSBuZXdWYWx1ZTtcclxuICAgICAgICByZXF1ZXN0VXBkYXRlKHRoaXMpO1xyXG4gICAgfTtcclxuICAgIF9fZGVjb3JhdGUoW1xyXG4gICAgICAgIGJpbmRhYmxlXHJcbiAgICBdLCBDb21wb3NlLnByb3RvdHlwZSwgXCJtb2RlbFwiLCB2b2lkIDApO1xyXG4gICAgX19kZWNvcmF0ZShbXHJcbiAgICAgICAgYmluZGFibGVcclxuICAgIF0sIENvbXBvc2UucHJvdG90eXBlLCBcInZpZXdcIiwgdm9pZCAwKTtcclxuICAgIF9fZGVjb3JhdGUoW1xyXG4gICAgICAgIGJpbmRhYmxlXHJcbiAgICBdLCBDb21wb3NlLnByb3RvdHlwZSwgXCJ2aWV3TW9kZWxcIiwgdm9pZCAwKTtcclxuICAgIF9fZGVjb3JhdGUoW1xyXG4gICAgICAgIGJpbmRhYmxlXHJcbiAgICBdLCBDb21wb3NlLnByb3RvdHlwZSwgXCJhY3RpdmF0aW9uU3RyYXRlZ3lcIiwgdm9pZCAwKTtcclxuICAgIF9fZGVjb3JhdGUoW1xyXG4gICAgICAgIGJpbmRhYmxlXHJcbiAgICBdLCBDb21wb3NlLnByb3RvdHlwZSwgXCJzd2FwT3JkZXJcIiwgdm9pZCAwKTtcclxuICAgIENvbXBvc2UgPSBfX2RlY29yYXRlKFtcclxuICAgICAgICBub1ZpZXcsXHJcbiAgICAgICAgY3VzdG9tRWxlbWVudCgnY29tcG9zZScpXHJcbiAgICBdLCBDb21wb3NlKTtcclxuICAgIHJldHVybiBDb21wb3NlO1xyXG59KCkpO1xyXG5mdW5jdGlvbiBpc0VtcHR5KG9iaikge1xyXG4gICAgZm9yICh2YXIgXyBpbiBvYmopIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdHJ1ZTtcclxufVxyXG5mdW5jdGlvbiB0cnlBY3RpdmF0ZVZpZXdNb2RlbCh2bSwgbW9kZWwpIHtcclxuICAgIGlmICh2bSAmJiB0eXBlb2Ygdm0uYWN0aXZhdGUgPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHZtLmFjdGl2YXRlKG1vZGVsKSk7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gY3JlYXRlSW5zdHJ1Y3Rpb24oY29tcG9zZXIsIGluc3RydWN0aW9uKSB7XHJcbiAgICByZXR1cm4gT2JqZWN0LmFzc2lnbihpbnN0cnVjdGlvbiwge1xyXG4gICAgICAgIGJpbmRpbmdDb250ZXh0OiBjb21wb3Nlci5iaW5kaW5nQ29udGV4dCxcclxuICAgICAgICBvdmVycmlkZUNvbnRleHQ6IGNvbXBvc2VyLm92ZXJyaWRlQ29udGV4dCxcclxuICAgICAgICBvd25pbmdWaWV3OiBjb21wb3Nlci5vd25pbmdWaWV3LFxyXG4gICAgICAgIGNvbnRhaW5lcjogY29tcG9zZXIuY29udGFpbmVyLFxyXG4gICAgICAgIHZpZXdTbG90OiBjb21wb3Nlci52aWV3U2xvdCxcclxuICAgICAgICB2aWV3UmVzb3VyY2VzOiBjb21wb3Nlci52aWV3UmVzb3VyY2VzLFxyXG4gICAgICAgIGN1cnJlbnRDb250cm9sbGVyOiBjb21wb3Nlci5jdXJyZW50Q29udHJvbGxlcixcclxuICAgICAgICBob3N0OiBjb21wb3Nlci5lbGVtZW50LFxyXG4gICAgICAgIHN3YXBPcmRlcjogY29tcG9zZXIuc3dhcE9yZGVyXHJcbiAgICB9KTtcclxufVxyXG5mdW5jdGlvbiBwcm9jZXNzQ2hhbmdlcyhjb21wb3Nlcikge1xyXG4gICAgdmFyIGNoYW5nZXMgPSBjb21wb3Nlci5jaGFuZ2VzO1xyXG4gICAgY29tcG9zZXIuY2hhbmdlcyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XHJcbiAgICBpZiAobmVlZHNSZUluaXRpYWxpemF0aW9uKGNvbXBvc2VyLCBjaGFuZ2VzKSkge1xyXG4gICAgICAgIHZhciBpbnN0cnVjdGlvbiA9IHtcclxuICAgICAgICAgICAgdmlldzogY29tcG9zZXIudmlldyxcclxuICAgICAgICAgICAgdmlld01vZGVsOiBjb21wb3Nlci5jdXJyZW50Vmlld01vZGVsIHx8IGNvbXBvc2VyLnZpZXdNb2RlbCxcclxuICAgICAgICAgICAgbW9kZWw6IGNvbXBvc2VyLm1vZGVsXHJcbiAgICAgICAgfTtcclxuICAgICAgICBpbnN0cnVjdGlvbiA9IE9iamVjdC5hc3NpZ24oaW5zdHJ1Y3Rpb24sIGNoYW5nZXMpO1xyXG4gICAgICAgIGluc3RydWN0aW9uID0gY3JlYXRlSW5zdHJ1Y3Rpb24oY29tcG9zZXIsIGluc3RydWN0aW9uKTtcclxuICAgICAgICBjb21wb3Nlci5wZW5kaW5nVGFzayA9IGNvbXBvc2VyLmNvbXBvc2l0aW9uRW5naW5lLmNvbXBvc2UoaW5zdHJ1Y3Rpb24pLnRoZW4oZnVuY3Rpb24gKGNvbnRyb2xsZXIpIHtcclxuICAgICAgICAgICAgY29tcG9zZXIuY3VycmVudENvbnRyb2xsZXIgPSBjb250cm9sbGVyO1xyXG4gICAgICAgICAgICBjb21wb3Nlci5jdXJyZW50Vmlld01vZGVsID0gY29udHJvbGxlciA/IGNvbnRyb2xsZXIudmlld01vZGVsIDogbnVsbDtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIGNvbXBvc2VyLnBlbmRpbmdUYXNrID0gdHJ5QWN0aXZhdGVWaWV3TW9kZWwoY29tcG9zZXIuY3VycmVudFZpZXdNb2RlbCwgY2hhbmdlcy5tb2RlbCk7XHJcbiAgICAgICAgaWYgKCFjb21wb3Nlci5wZW5kaW5nVGFzaykge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgY29tcG9zZXIucGVuZGluZ1Rhc2sgPSBjb21wb3Nlci5wZW5kaW5nVGFza1xyXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBjb21wbGV0ZUNvbXBvc2l0aW9uVGFzayhjb21wb3Nlcik7XHJcbiAgICB9LCBmdW5jdGlvbiAocmVhc29uKSB7XHJcbiAgICAgICAgY29tcGxldGVDb21wb3NpdGlvblRhc2soY29tcG9zZXIpO1xyXG4gICAgICAgIHRocm93IHJlYXNvbjtcclxuICAgIH0pO1xyXG59XHJcbmZ1bmN0aW9uIGNvbXBsZXRlQ29tcG9zaXRpb25UYXNrKGNvbXBvc2VyKSB7XHJcbiAgICBjb21wb3Nlci5wZW5kaW5nVGFzayA9IG51bGw7XHJcbiAgICBpZiAoIWlzRW1wdHkoY29tcG9zZXIuY2hhbmdlcykpIHtcclxuICAgICAgICBwcm9jZXNzQ2hhbmdlcyhjb21wb3Nlcik7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gcmVxdWVzdFVwZGF0ZShjb21wb3Nlcikge1xyXG4gICAgaWYgKGNvbXBvc2VyLnBlbmRpbmdUYXNrIHx8IGNvbXBvc2VyLnVwZGF0ZVJlcXVlc3RlZCkge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGNvbXBvc2VyLnVwZGF0ZVJlcXVlc3RlZCA9IHRydWU7XHJcbiAgICBjb21wb3Nlci50YXNrUXVldWUucXVldWVNaWNyb1Rhc2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGNvbXBvc2VyLnVwZGF0ZVJlcXVlc3RlZCA9IGZhbHNlO1xyXG4gICAgICAgIHByb2Nlc3NDaGFuZ2VzKGNvbXBvc2VyKTtcclxuICAgIH0pO1xyXG59XHJcbmZ1bmN0aW9uIG5lZWRzUmVJbml0aWFsaXphdGlvbihjb21wb3NlciwgY2hhbmdlcykge1xyXG4gICAgdmFyIGFjdGl2YXRpb25TdHJhdGVneSA9IGNvbXBvc2VyLmFjdGl2YXRpb25TdHJhdGVneTtcclxuICAgIHZhciB2bSA9IGNvbXBvc2VyLmN1cnJlbnRWaWV3TW9kZWw7XHJcbiAgICBpZiAodm0gJiYgdHlwZW9mIHZtLmRldGVybWluZUFjdGl2YXRpb25TdHJhdGVneSA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgIGFjdGl2YXRpb25TdHJhdGVneSA9IHZtLmRldGVybWluZUFjdGl2YXRpb25TdHJhdGVneSgpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuICd2aWV3JyBpbiBjaGFuZ2VzXHJcbiAgICAgICAgfHwgJ3ZpZXdNb2RlbCcgaW4gY2hhbmdlc1xyXG4gICAgICAgIHx8IGFjdGl2YXRpb25TdHJhdGVneSA9PT0gQWN0aXZhdGlvblN0cmF0ZWd5LlJlcGxhY2U7XHJcbn1cblxudmFyIElmQ29yZSA9IChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBJZkNvcmUodmlld0ZhY3RvcnksIHZpZXdTbG90KSB7XHJcbiAgICAgICAgdGhpcy52aWV3RmFjdG9yeSA9IHZpZXdGYWN0b3J5O1xyXG4gICAgICAgIHRoaXMudmlld1Nsb3QgPSB2aWV3U2xvdDtcclxuICAgICAgICB0aGlzLnZpZXcgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuYmluZGluZ0NvbnRleHQgPSBudWxsO1xyXG4gICAgICAgIHRoaXMub3ZlcnJpZGVDb250ZXh0ID0gbnVsbDtcclxuICAgICAgICB0aGlzLnNob3dpbmcgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmNhY2hlID0gdHJ1ZTtcclxuICAgIH1cclxuICAgIElmQ29yZS5wcm90b3R5cGUuYmluZCA9IGZ1bmN0aW9uIChiaW5kaW5nQ29udGV4dCwgb3ZlcnJpZGVDb250ZXh0KSB7XHJcbiAgICAgICAgdGhpcy5iaW5kaW5nQ29udGV4dCA9IGJpbmRpbmdDb250ZXh0O1xyXG4gICAgICAgIHRoaXMub3ZlcnJpZGVDb250ZXh0ID0gb3ZlcnJpZGVDb250ZXh0O1xyXG4gICAgfTtcclxuICAgIElmQ29yZS5wcm90b3R5cGUudW5iaW5kID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICh0aGlzLnZpZXcgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnZpZXcudW5iaW5kKCk7XHJcbiAgICAgICAgaWYgKCF0aGlzLnZpZXdGYWN0b3J5LmlzQ2FjaGluZykge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLnNob3dpbmcpIHtcclxuICAgICAgICAgICAgdGhpcy5zaG93aW5nID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHRoaXMudmlld1Nsb3QucmVtb3ZlKHRoaXMudmlldywgdHJ1ZSwgdHJ1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLnZpZXcucmV0dXJuVG9DYWNoZSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnZpZXcgPSBudWxsO1xyXG4gICAgfTtcclxuICAgIElmQ29yZS5wcm90b3R5cGUuX3Nob3cgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuc2hvd2luZykge1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMudmlldy5pc0JvdW5kKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnZpZXcuYmluZCh0aGlzLmJpbmRpbmdDb250ZXh0LCB0aGlzLm92ZXJyaWRlQ29udGV4dCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy52aWV3ID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMudmlldyA9IHRoaXMudmlld0ZhY3RvcnkuY3JlYXRlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghdGhpcy52aWV3LmlzQm91bmQpIHtcclxuICAgICAgICAgICAgdGhpcy52aWV3LmJpbmQodGhpcy5iaW5kaW5nQ29udGV4dCwgdGhpcy5vdmVycmlkZUNvbnRleHQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnNob3dpbmcgPSB0cnVlO1xyXG4gICAgICAgIHJldHVybiB0aGlzLnZpZXdTbG90LmFkZCh0aGlzLnZpZXcpO1xyXG4gICAgfTtcclxuICAgIElmQ29yZS5wcm90b3R5cGUuX2hpZGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICBpZiAoIXRoaXMuc2hvd2luZykge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuc2hvd2luZyA9IGZhbHNlO1xyXG4gICAgICAgIHZhciByZW1vdmVkID0gdGhpcy52aWV3U2xvdC5yZW1vdmUodGhpcy52aWV3KTtcclxuICAgICAgICBpZiAocmVtb3ZlZCBpbnN0YW5jZW9mIFByb21pc2UpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlbW92ZWQudGhlbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5fdW5iaW5kVmlldygpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fdW5iaW5kVmlldygpO1xyXG4gICAgfTtcclxuICAgIElmQ29yZS5wcm90b3R5cGUuX3VuYmluZFZpZXcgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGNhY2hlID0gdGhpcy5jYWNoZSA9PT0gJ2ZhbHNlJyA/IGZhbHNlIDogISF0aGlzLmNhY2hlO1xyXG4gICAgICAgIHRoaXMudmlldy51bmJpbmQoKTtcclxuICAgICAgICBpZiAoIWNhY2hlKSB7XHJcbiAgICAgICAgICAgIHRoaXMudmlldyA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIHJldHVybiBJZkNvcmU7XHJcbn0oKSk7XG5cbnZhciBJZiA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICBfX2V4dGVuZHMoSWYsIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBJZigpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcclxuICAgICAgICBfdGhpcy5jYWNoZSA9IHRydWU7XHJcbiAgICAgICAgcmV0dXJuIF90aGlzO1xyXG4gICAgfVxyXG4gICAgSWYucHJvdG90eXBlLmJpbmQgPSBmdW5jdGlvbiAoYmluZGluZ0NvbnRleHQsIG92ZXJyaWRlQ29udGV4dCkge1xyXG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuYmluZC5jYWxsKHRoaXMsIGJpbmRpbmdDb250ZXh0LCBvdmVycmlkZUNvbnRleHQpO1xyXG4gICAgICAgIGlmICh0aGlzLmNvbmRpdGlvbikge1xyXG4gICAgICAgICAgICB0aGlzLl9zaG93KCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl9oaWRlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIElmLnByb3RvdHlwZS5jb25kaXRpb25DaGFuZ2VkID0gZnVuY3Rpb24gKG5ld1ZhbHVlKSB7XHJcbiAgICAgICAgdGhpcy5fdXBkYXRlKG5ld1ZhbHVlKTtcclxuICAgIH07XHJcbiAgICBJZi5wcm90b3R5cGUuX3VwZGF0ZSA9IGZ1bmN0aW9uIChzaG93KSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICBpZiAodGhpcy5hbmltYXRpbmcpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgcHJvbWlzZTtcclxuICAgICAgICBpZiAodGhpcy5lbHNlVm0pIHtcclxuICAgICAgICAgICAgcHJvbWlzZSA9IHNob3cgPyB0aGlzLl9zd2FwKHRoaXMuZWxzZVZtLCB0aGlzKSA6IHRoaXMuX3N3YXAodGhpcywgdGhpcy5lbHNlVm0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcHJvbWlzZSA9IHNob3cgPyB0aGlzLl9zaG93KCkgOiB0aGlzLl9oaWRlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChwcm9taXNlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYW5pbWF0aW5nID0gdHJ1ZTtcclxuICAgICAgICAgICAgcHJvbWlzZS50aGVuKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIF90aGlzLmFuaW1hdGluZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgaWYgKF90aGlzLmNvbmRpdGlvbiAhPT0gX3RoaXMuc2hvd2luZykge1xyXG4gICAgICAgICAgICAgICAgICAgIF90aGlzLl91cGRhdGUoX3RoaXMuY29uZGl0aW9uKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIElmLnByb3RvdHlwZS5fc3dhcCA9IGZ1bmN0aW9uIChyZW1vdmUsIGFkZCkge1xyXG4gICAgICAgIHN3aXRjaCAodGhpcy5zd2FwT3JkZXIpIHtcclxuICAgICAgICAgICAgY2FzZSAnYmVmb3JlJzpcclxuICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoYWRkLl9zaG93KCkpLnRoZW4oZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVtb3ZlLl9oaWRlKCk7IH0pO1xyXG4gICAgICAgICAgICBjYXNlICd3aXRoJzpcclxuICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLmFsbChbcmVtb3ZlLl9oaWRlKCksIGFkZC5fc2hvdygpXSk7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICB2YXIgcHJvbWlzZSA9IHJlbW92ZS5faGlkZSgpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHByb21pc2UgPyBwcm9taXNlLnRoZW4oZnVuY3Rpb24gKCkgeyByZXR1cm4gYWRkLl9zaG93KCk7IH0pIDogYWRkLl9zaG93KCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIF9fZGVjb3JhdGUoW1xyXG4gICAgICAgIGJpbmRhYmxlKHsgcHJpbWFyeVByb3BlcnR5OiB0cnVlIH0pXHJcbiAgICBdLCBJZi5wcm90b3R5cGUsIFwiY29uZGl0aW9uXCIsIHZvaWQgMCk7XHJcbiAgICBfX2RlY29yYXRlKFtcclxuICAgICAgICBiaW5kYWJsZVxyXG4gICAgXSwgSWYucHJvdG90eXBlLCBcInN3YXBPcmRlclwiLCB2b2lkIDApO1xyXG4gICAgX19kZWNvcmF0ZShbXHJcbiAgICAgICAgYmluZGFibGVcclxuICAgIF0sIElmLnByb3RvdHlwZSwgXCJjYWNoZVwiLCB2b2lkIDApO1xyXG4gICAgSWYgPSBfX2RlY29yYXRlKFtcclxuICAgICAgICBjdXN0b21BdHRyaWJ1dGUoJ2lmJyksXHJcbiAgICAgICAgdGVtcGxhdGVDb250cm9sbGVyLFxyXG4gICAgICAgIGluamVjdChCb3VuZFZpZXdGYWN0b3J5LCBWaWV3U2xvdClcclxuICAgIF0sIElmKTtcclxuICAgIHJldHVybiBJZjtcclxufShJZkNvcmUpKTtcblxudmFyIEVsc2UgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgX19leHRlbmRzKEVsc2UsIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBFbHNlKHZpZXdGYWN0b3J5LCB2aWV3U2xvdCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIHZpZXdGYWN0b3J5LCB2aWV3U2xvdCkgfHwgdGhpcztcclxuICAgICAgICBfdGhpcy5fcmVnaXN0ZXJJbklmKCk7XHJcbiAgICAgICAgcmV0dXJuIF90aGlzO1xyXG4gICAgfVxyXG4gICAgRWxzZS5wcm90b3R5cGUuYmluZCA9IGZ1bmN0aW9uIChiaW5kaW5nQ29udGV4dCwgb3ZlcnJpZGVDb250ZXh0KSB7XHJcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5iaW5kLmNhbGwodGhpcywgYmluZGluZ0NvbnRleHQsIG92ZXJyaWRlQ29udGV4dCk7XHJcbiAgICAgICAgaWYgKHRoaXMuaWZWbS5jb25kaXRpb24pIHtcclxuICAgICAgICAgICAgdGhpcy5faGlkZSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5fc2hvdygpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBFbHNlLnByb3RvdHlwZS5fcmVnaXN0ZXJJbklmID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBwcmV2aW91cyA9IHRoaXMudmlld1Nsb3QuYW5jaG9yLnByZXZpb3VzU2libGluZztcclxuICAgICAgICB3aGlsZSAocHJldmlvdXMgJiYgIXByZXZpb3VzLmF1KSB7XHJcbiAgICAgICAgICAgIHByZXZpb3VzID0gcHJldmlvdXMucHJldmlvdXNTaWJsaW5nO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIXByZXZpb3VzIHx8ICFwcmV2aW91cy5hdS5pZikge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJDYW4ndCBmaW5kIG1hdGNoaW5nIElmIGZvciBFbHNlIGN1c3RvbSBhdHRyaWJ1dGUuXCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmlmVm0gPSBwcmV2aW91cy5hdS5pZi52aWV3TW9kZWw7XHJcbiAgICAgICAgdGhpcy5pZlZtLmVsc2VWbSA9IHRoaXM7XHJcbiAgICB9O1xyXG4gICAgRWxzZSA9IF9fZGVjb3JhdGUoW1xyXG4gICAgICAgIGN1c3RvbUF0dHJpYnV0ZSgnZWxzZScpLFxyXG4gICAgICAgIHRlbXBsYXRlQ29udHJvbGxlcixcclxuICAgICAgICBpbmplY3QoQm91bmRWaWV3RmFjdG9yeSwgVmlld1Nsb3QpXHJcbiAgICBdLCBFbHNlKTtcclxuICAgIHJldHVybiBFbHNlO1xyXG59KElmQ29yZSkpO1xuXG52YXIgV2l0aCA9IChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBXaXRoKHZpZXdGYWN0b3J5LCB2aWV3U2xvdCkge1xyXG4gICAgICAgIHRoaXMudmlld0ZhY3RvcnkgPSB2aWV3RmFjdG9yeTtcclxuICAgICAgICB0aGlzLnZpZXdTbG90ID0gdmlld1Nsb3Q7XHJcbiAgICAgICAgdGhpcy5wYXJlbnRPdmVycmlkZUNvbnRleHQgPSBudWxsO1xyXG4gICAgICAgIHRoaXMudmlldyA9IG51bGw7XHJcbiAgICB9XHJcbiAgICBXaXRoLnByb3RvdHlwZS5iaW5kID0gZnVuY3Rpb24gKGJpbmRpbmdDb250ZXh0LCBvdmVycmlkZUNvbnRleHQpIHtcclxuICAgICAgICB0aGlzLnBhcmVudE92ZXJyaWRlQ29udGV4dCA9IG92ZXJyaWRlQ29udGV4dDtcclxuICAgICAgICB0aGlzLnZhbHVlQ2hhbmdlZCh0aGlzLnZhbHVlKTtcclxuICAgIH07XHJcbiAgICBXaXRoLnByb3RvdHlwZS52YWx1ZUNoYW5nZWQgPSBmdW5jdGlvbiAobmV3VmFsdWUpIHtcclxuICAgICAgICB2YXIgb3ZlcnJpZGVDb250ZXh0ID0gY3JlYXRlT3ZlcnJpZGVDb250ZXh0KG5ld1ZhbHVlLCB0aGlzLnBhcmVudE92ZXJyaWRlQ29udGV4dCk7XHJcbiAgICAgICAgdmFyIHZpZXcgPSB0aGlzLnZpZXc7XHJcbiAgICAgICAgaWYgKCF2aWV3KSB7XHJcbiAgICAgICAgICAgIHZpZXcgPSB0aGlzLnZpZXcgPSB0aGlzLnZpZXdGYWN0b3J5LmNyZWF0ZSgpO1xyXG4gICAgICAgICAgICB2aWV3LmJpbmQobmV3VmFsdWUsIG92ZXJyaWRlQ29udGV4dCk7XHJcbiAgICAgICAgICAgIHRoaXMudmlld1Nsb3QuYWRkKHZpZXcpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdmlldy5iaW5kKG5ld1ZhbHVlLCBvdmVycmlkZUNvbnRleHQpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBXaXRoLnByb3RvdHlwZS51bmJpbmQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHZpZXcgPSB0aGlzLnZpZXc7XHJcbiAgICAgICAgdGhpcy5wYXJlbnRPdmVycmlkZUNvbnRleHQgPSBudWxsO1xyXG4gICAgICAgIGlmICh2aWV3KSB7XHJcbiAgICAgICAgICAgIHZpZXcudW5iaW5kKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIFdpdGggPSBfX2RlY29yYXRlKFtcclxuICAgICAgICBjdXN0b21BdHRyaWJ1dGUoJ3dpdGgnKSxcclxuICAgICAgICB0ZW1wbGF0ZUNvbnRyb2xsZXIsXHJcbiAgICAgICAgaW5qZWN0KEJvdW5kVmlld0ZhY3RvcnksIFZpZXdTbG90KVxyXG4gICAgXSwgV2l0aCk7XHJcbiAgICByZXR1cm4gV2l0aDtcclxufSgpKTtcblxudmFyIG9uZVRpbWUgPSBiaW5kaW5nTW9kZS5vbmVUaW1lO1xyXG5mdW5jdGlvbiB1cGRhdGVPdmVycmlkZUNvbnRleHRzKHZpZXdzLCBzdGFydEluZGV4KSB7XHJcbiAgICB2YXIgbGVuZ3RoID0gdmlld3MubGVuZ3RoO1xyXG4gICAgaWYgKHN0YXJ0SW5kZXggPiAwKSB7XHJcbiAgICAgICAgc3RhcnRJbmRleCA9IHN0YXJ0SW5kZXggLSAxO1xyXG4gICAgfVxyXG4gICAgZm9yICg7IHN0YXJ0SW5kZXggPCBsZW5ndGg7ICsrc3RhcnRJbmRleCkge1xyXG4gICAgICAgIHVwZGF0ZU92ZXJyaWRlQ29udGV4dCh2aWV3c1tzdGFydEluZGV4XS5vdmVycmlkZUNvbnRleHQsIHN0YXJ0SW5kZXgsIGxlbmd0aCk7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gY3JlYXRlRnVsbE92ZXJyaWRlQ29udGV4dChyZXBlYXQsIGRhdGEsIGluZGV4LCBsZW5ndGgsIGtleSkge1xyXG4gICAgdmFyIGJpbmRpbmdDb250ZXh0ID0ge307XHJcbiAgICB2YXIgb3ZlcnJpZGVDb250ZXh0ID0gY3JlYXRlT3ZlcnJpZGVDb250ZXh0KGJpbmRpbmdDb250ZXh0LCByZXBlYXQuc2NvcGUub3ZlcnJpZGVDb250ZXh0KTtcclxuICAgIGlmICh0eXBlb2Yga2V5ICE9PSAndW5kZWZpbmVkJykge1xyXG4gICAgICAgIGJpbmRpbmdDb250ZXh0W3JlcGVhdC5rZXldID0ga2V5O1xyXG4gICAgICAgIGJpbmRpbmdDb250ZXh0W3JlcGVhdC52YWx1ZV0gPSBkYXRhO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgYmluZGluZ0NvbnRleHRbcmVwZWF0LmxvY2FsXSA9IGRhdGE7XHJcbiAgICB9XHJcbiAgICB1cGRhdGVPdmVycmlkZUNvbnRleHQob3ZlcnJpZGVDb250ZXh0LCBpbmRleCwgbGVuZ3RoKTtcclxuICAgIHJldHVybiBvdmVycmlkZUNvbnRleHQ7XHJcbn1cclxuZnVuY3Rpb24gdXBkYXRlT3ZlcnJpZGVDb250ZXh0KG92ZXJyaWRlQ29udGV4dCwgaW5kZXgsIGxlbmd0aCkge1xyXG4gICAgdmFyIGZpcnN0ID0gKGluZGV4ID09PSAwKTtcclxuICAgIHZhciBsYXN0ID0gKGluZGV4ID09PSBsZW5ndGggLSAxKTtcclxuICAgIHZhciBldmVuID0gaW5kZXggJSAyID09PSAwO1xyXG4gICAgb3ZlcnJpZGVDb250ZXh0LiRpbmRleCA9IGluZGV4O1xyXG4gICAgb3ZlcnJpZGVDb250ZXh0LiRmaXJzdCA9IGZpcnN0O1xyXG4gICAgb3ZlcnJpZGVDb250ZXh0LiRsYXN0ID0gbGFzdDtcclxuICAgIG92ZXJyaWRlQ29udGV4dC4kbWlkZGxlID0gIShmaXJzdCB8fCBsYXN0KTtcclxuICAgIG92ZXJyaWRlQ29udGV4dC4kb2RkID0gIWV2ZW47XHJcbiAgICBvdmVycmlkZUNvbnRleHQuJGV2ZW4gPSBldmVuO1xyXG59XHJcbmZ1bmN0aW9uIGdldEl0ZW1zU291cmNlRXhwcmVzc2lvbihpbnN0cnVjdGlvbiwgYXR0ck5hbWUpIHtcclxuICAgIHJldHVybiBpbnN0cnVjdGlvbi5iZWhhdmlvckluc3RydWN0aW9uc1xyXG4gICAgICAgIC5maWx0ZXIoZnVuY3Rpb24gKGJpKSB7IHJldHVybiBiaS5vcmlnaW5hbEF0dHJOYW1lID09PSBhdHRyTmFtZTsgfSlbMF1cclxuICAgICAgICAuYXR0cmlidXRlc1xyXG4gICAgICAgIC5pdGVtc1xyXG4gICAgICAgIC5zb3VyY2VFeHByZXNzaW9uO1xyXG59XHJcbmZ1bmN0aW9uIHVud3JhcEV4cHJlc3Npb24oZXhwcmVzc2lvbikge1xyXG4gICAgdmFyIHVud3JhcHBlZCA9IGZhbHNlO1xyXG4gICAgd2hpbGUgKGV4cHJlc3Npb24gaW5zdGFuY2VvZiBCaW5kaW5nQmVoYXZpb3IpIHtcclxuICAgICAgICBleHByZXNzaW9uID0gZXhwcmVzc2lvbi5leHByZXNzaW9uO1xyXG4gICAgfVxyXG4gICAgd2hpbGUgKGV4cHJlc3Npb24gaW5zdGFuY2VvZiBWYWx1ZUNvbnZlcnRlcikge1xyXG4gICAgICAgIGV4cHJlc3Npb24gPSBleHByZXNzaW9uLmV4cHJlc3Npb247XHJcbiAgICAgICAgdW53cmFwcGVkID0gdHJ1ZTtcclxuICAgIH1cclxuICAgIHJldHVybiB1bndyYXBwZWQgPyBleHByZXNzaW9uIDogbnVsbDtcclxufVxyXG5mdW5jdGlvbiBpc09uZVRpbWUoZXhwcmVzc2lvbikge1xyXG4gICAgd2hpbGUgKGV4cHJlc3Npb24gaW5zdGFuY2VvZiBCaW5kaW5nQmVoYXZpb3IpIHtcclxuICAgICAgICBpZiAoZXhwcmVzc2lvbi5uYW1lID09PSAnb25lVGltZScpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGV4cHJlc3Npb24gPSBleHByZXNzaW9uLmV4cHJlc3Npb247XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbn1cclxuZnVuY3Rpb24gdXBkYXRlT25lVGltZUJpbmRpbmcoYmluZGluZykge1xyXG4gICAgaWYgKGJpbmRpbmcuY2FsbCAmJiBiaW5kaW5nLm1vZGUgPT09IG9uZVRpbWUpIHtcclxuICAgICAgICBiaW5kaW5nLmNhbGwoc291cmNlQ29udGV4dCk7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmIChiaW5kaW5nLnVwZGF0ZU9uZVRpbWVCaW5kaW5ncykge1xyXG4gICAgICAgIGJpbmRpbmcudXBkYXRlT25lVGltZUJpbmRpbmdzKCk7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gaW5kZXhPZihhcnJheSwgaXRlbSwgbWF0Y2hlciwgc3RhcnRJbmRleCkge1xyXG4gICAgaWYgKCFtYXRjaGVyKSB7XHJcbiAgICAgICAgcmV0dXJuIGFycmF5LmluZGV4T2YoaXRlbSk7XHJcbiAgICB9XHJcbiAgICB2YXIgbGVuZ3RoID0gYXJyYXkubGVuZ3RoO1xyXG4gICAgZm9yICh2YXIgaW5kZXggPSBzdGFydEluZGV4IHx8IDA7IGluZGV4IDwgbGVuZ3RoOyBpbmRleCsrKSB7XHJcbiAgICAgICAgaWYgKG1hdGNoZXIoYXJyYXlbaW5kZXhdLCBpdGVtKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gaW5kZXg7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIC0xO1xyXG59XG5cbnZhciBBcnJheVJlcGVhdFN0cmF0ZWd5ID0gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEFycmF5UmVwZWF0U3RyYXRlZ3koKSB7XHJcbiAgICB9XHJcbiAgICBBcnJheVJlcGVhdFN0cmF0ZWd5LnByb3RvdHlwZS5nZXRDb2xsZWN0aW9uT2JzZXJ2ZXIgPSBmdW5jdGlvbiAob2JzZXJ2ZXJMb2NhdG9yLCBpdGVtcykge1xyXG4gICAgICAgIHJldHVybiBvYnNlcnZlckxvY2F0b3IuZ2V0QXJyYXlPYnNlcnZlcihpdGVtcyk7XHJcbiAgICB9O1xyXG4gICAgQXJyYXlSZXBlYXRTdHJhdGVneS5wcm90b3R5cGUuaW5zdGFuY2VDaGFuZ2VkID0gZnVuY3Rpb24gKHJlcGVhdCwgaXRlbXMpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciAkcmVwZWF0ID0gcmVwZWF0O1xyXG4gICAgICAgIHZhciBpdGVtc0xlbmd0aCA9IGl0ZW1zLmxlbmd0aDtcclxuICAgICAgICBpZiAoIWl0ZW1zIHx8IGl0ZW1zTGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgICRyZXBlYXQucmVtb3ZlQWxsVmlld3ModHJ1ZSwgISRyZXBlYXQudmlld3NSZXF1aXJlTGlmZWN5Y2xlKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgY2hpbGRyZW4gPSAkcmVwZWF0LnZpZXdzKCk7XHJcbiAgICAgICAgdmFyIHZpZXdzTGVuZ3RoID0gY2hpbGRyZW4ubGVuZ3RoO1xyXG4gICAgICAgIGlmICh2aWV3c0xlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICB0aGlzLl9zdGFuZGFyZFByb2Nlc3NJbnN0YW5jZUNoYW5nZWQoJHJlcGVhdCwgaXRlbXMpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICgkcmVwZWF0LnZpZXdzUmVxdWlyZUxpZmVjeWNsZSkge1xyXG4gICAgICAgICAgICB2YXIgY2hpbGRyZW5TbmFwc2hvdCA9IGNoaWxkcmVuLnNsaWNlKDApO1xyXG4gICAgICAgICAgICB2YXIgaXRlbU5hbWVJbkJpbmRpbmdDb250ZXh0ID0gJHJlcGVhdC5sb2NhbDtcclxuICAgICAgICAgICAgdmFyIG1hdGNoZXJfMSA9ICRyZXBlYXQubWF0Y2hlcigpO1xyXG4gICAgICAgICAgICB2YXIgaXRlbXNQcmV2aW91c2x5SW5WaWV3c18xID0gW107XHJcbiAgICAgICAgICAgIHZhciB2aWV3c1RvUmVtb3ZlID0gW107XHJcbiAgICAgICAgICAgIGZvciAodmFyIGluZGV4ID0gMDsgaW5kZXggPCB2aWV3c0xlbmd0aDsgaW5kZXgrKykge1xyXG4gICAgICAgICAgICAgICAgdmFyIHZpZXcgPSBjaGlsZHJlblNuYXBzaG90W2luZGV4XTtcclxuICAgICAgICAgICAgICAgIHZhciBvbGRJdGVtID0gdmlldy5iaW5kaW5nQ29udGV4dFtpdGVtTmFtZUluQmluZGluZ0NvbnRleHRdO1xyXG4gICAgICAgICAgICAgICAgaWYgKGluZGV4T2YoaXRlbXMsIG9sZEl0ZW0sIG1hdGNoZXJfMSkgPT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmlld3NUb1JlbW92ZS5wdXNoKHZpZXcpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaXRlbXNQcmV2aW91c2x5SW5WaWV3c18xLnB1c2gob2xkSXRlbSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIHVwZGF0ZVZpZXdzID0gdm9pZCAwO1xyXG4gICAgICAgICAgICB2YXIgcmVtb3ZlUHJvbWlzZSA9IHZvaWQgMDtcclxuICAgICAgICAgICAgaWYgKGl0ZW1zUHJldmlvdXNseUluVmlld3NfMS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICByZW1vdmVQcm9taXNlID0gJHJlcGVhdC5yZW1vdmVWaWV3cyh2aWV3c1RvUmVtb3ZlLCB0cnVlLCAhJHJlcGVhdC52aWV3c1JlcXVpcmVMaWZlY3ljbGUpO1xyXG4gICAgICAgICAgICAgICAgdXBkYXRlVmlld3MgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaW5kZXggPSAwOyBpbmRleCA8IGl0ZW1zTGVuZ3RoOyBpbmRleCsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpdGVtID0gaXRlbXNbaW5kZXhdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5kZXhPZlZpZXcgPSBpbmRleE9mKGl0ZW1zUHJldmlvdXNseUluVmlld3NfMSwgaXRlbSwgbWF0Y2hlcl8xLCBpbmRleCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2aWV3ID0gdm9pZCAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5kZXhPZlZpZXcgPT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgb3ZlcnJpZGVDb250ZXh0ID0gY3JlYXRlRnVsbE92ZXJyaWRlQ29udGV4dCgkcmVwZWF0LCBpdGVtc1tpbmRleF0sIGluZGV4LCBpdGVtc0xlbmd0aCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcmVwZWF0Lmluc2VydFZpZXcoaW5kZXgsIG92ZXJyaWRlQ29udGV4dC5iaW5kaW5nQ29udGV4dCwgb3ZlcnJpZGVDb250ZXh0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1zUHJldmlvdXNseUluVmlld3NfMS5zcGxpY2UoaW5kZXgsIDAsIHVuZGVmaW5lZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoaW5kZXhPZlZpZXcgPT09IGluZGV4KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aWV3ID0gY2hpbGRyZW5baW5kZXhPZlZpZXddO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbXNQcmV2aW91c2x5SW5WaWV3c18xW2luZGV4T2ZWaWV3XSA9IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpZXcgPSBjaGlsZHJlbltpbmRleE9mVmlld107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcmVwZWF0Lm1vdmVWaWV3KGluZGV4T2ZWaWV3LCBpbmRleCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtc1ByZXZpb3VzbHlJblZpZXdzXzEuc3BsaWNlKGluZGV4T2ZWaWV3LCAxKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1zUHJldmlvdXNseUluVmlld3NfMS5zcGxpY2UoaW5kZXgsIDAsIHVuZGVmaW5lZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZpZXcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZU92ZXJyaWRlQ29udGV4dCh2aWV3Lm92ZXJyaWRlQ29udGV4dCwgaW5kZXgsIGl0ZW1zTGVuZ3RoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBfdGhpcy5faW5QbGFjZVByb2Nlc3NJdGVtcygkcmVwZWF0LCBpdGVtcyk7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmVtb3ZlUHJvbWlzZSA9ICRyZXBlYXQucmVtb3ZlQWxsVmlld3ModHJ1ZSwgISRyZXBlYXQudmlld3NSZXF1aXJlTGlmZWN5Y2xlKTtcclxuICAgICAgICAgICAgICAgIHVwZGF0ZVZpZXdzID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMuX3N0YW5kYXJkUHJvY2Vzc0luc3RhbmNlQ2hhbmdlZCgkcmVwZWF0LCBpdGVtcyk7IH07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHJlbW92ZVByb21pc2UgaW5zdGFuY2VvZiBQcm9taXNlKSB7XHJcbiAgICAgICAgICAgICAgICByZW1vdmVQcm9taXNlLnRoZW4odXBkYXRlVmlld3MpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdXBkYXRlVmlld3MoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5faW5QbGFjZVByb2Nlc3NJdGVtcygkcmVwZWF0LCBpdGVtcyk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIEFycmF5UmVwZWF0U3RyYXRlZ3kucHJvdG90eXBlLl9zdGFuZGFyZFByb2Nlc3NJbnN0YW5jZUNoYW5nZWQgPSBmdW5jdGlvbiAocmVwZWF0LCBpdGVtcykge1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBpaSA9IGl0ZW1zLmxlbmd0aDsgaSA8IGlpOyBpKyspIHtcclxuICAgICAgICAgICAgdmFyIG92ZXJyaWRlQ29udGV4dCA9IGNyZWF0ZUZ1bGxPdmVycmlkZUNvbnRleHQocmVwZWF0LCBpdGVtc1tpXSwgaSwgaWkpO1xyXG4gICAgICAgICAgICByZXBlYXQuYWRkVmlldyhvdmVycmlkZUNvbnRleHQuYmluZGluZ0NvbnRleHQsIG92ZXJyaWRlQ29udGV4dCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIEFycmF5UmVwZWF0U3RyYXRlZ3kucHJvdG90eXBlLl9pblBsYWNlUHJvY2Vzc0l0ZW1zID0gZnVuY3Rpb24gKHJlcGVhdCwgaXRlbXMpIHtcclxuICAgICAgICB2YXIgaXRlbXNMZW5ndGggPSBpdGVtcy5sZW5ndGg7XHJcbiAgICAgICAgdmFyIHZpZXdzTGVuZ3RoID0gcmVwZWF0LnZpZXdDb3VudCgpO1xyXG4gICAgICAgIHdoaWxlICh2aWV3c0xlbmd0aCA+IGl0ZW1zTGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHZpZXdzTGVuZ3RoLS07XHJcbiAgICAgICAgICAgIHJlcGVhdC5yZW1vdmVWaWV3KHZpZXdzTGVuZ3RoLCB0cnVlLCAhcmVwZWF0LnZpZXdzUmVxdWlyZUxpZmVjeWNsZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBsb2NhbCA9IHJlcGVhdC5sb2NhbDtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHZpZXdzTGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgdmFyIHZpZXcgPSByZXBlYXQudmlldyhpKTtcclxuICAgICAgICAgICAgdmFyIGxhc3QgPSBpID09PSBpdGVtc0xlbmd0aCAtIDE7XHJcbiAgICAgICAgICAgIHZhciBtaWRkbGUgPSBpICE9PSAwICYmICFsYXN0O1xyXG4gICAgICAgICAgICB2YXIgYmluZGluZ0NvbnRleHQgPSB2aWV3LmJpbmRpbmdDb250ZXh0O1xyXG4gICAgICAgICAgICB2YXIgb3ZlcnJpZGVDb250ZXh0ID0gdmlldy5vdmVycmlkZUNvbnRleHQ7XHJcbiAgICAgICAgICAgIGlmIChiaW5kaW5nQ29udGV4dFtsb2NhbF0gPT09IGl0ZW1zW2ldXHJcbiAgICAgICAgICAgICAgICAmJiBvdmVycmlkZUNvbnRleHQuJG1pZGRsZSA9PT0gbWlkZGxlXHJcbiAgICAgICAgICAgICAgICAmJiBvdmVycmlkZUNvbnRleHQuJGxhc3QgPT09IGxhc3QpIHtcclxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGJpbmRpbmdDb250ZXh0W2xvY2FsXSA9IGl0ZW1zW2ldO1xyXG4gICAgICAgICAgICBvdmVycmlkZUNvbnRleHQuJG1pZGRsZSA9IG1pZGRsZTtcclxuICAgICAgICAgICAgb3ZlcnJpZGVDb250ZXh0LiRsYXN0ID0gbGFzdDtcclxuICAgICAgICAgICAgcmVwZWF0LnVwZGF0ZUJpbmRpbmdzKHZpZXcpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmb3IgKHZhciBpID0gdmlld3NMZW5ndGg7IGkgPCBpdGVtc0xlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBvdmVycmlkZUNvbnRleHQgPSBjcmVhdGVGdWxsT3ZlcnJpZGVDb250ZXh0KHJlcGVhdCwgaXRlbXNbaV0sIGksIGl0ZW1zTGVuZ3RoKTtcclxuICAgICAgICAgICAgcmVwZWF0LmFkZFZpZXcob3ZlcnJpZGVDb250ZXh0LmJpbmRpbmdDb250ZXh0LCBvdmVycmlkZUNvbnRleHQpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBBcnJheVJlcGVhdFN0cmF0ZWd5LnByb3RvdHlwZS5pbnN0YW5jZU11dGF0ZWQgPSBmdW5jdGlvbiAocmVwZWF0LCBhcnJheSwgc3BsaWNlcykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgaWYgKHJlcGVhdC5fX3F1ZXVlZFNwbGljZXMpIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGlpID0gc3BsaWNlcy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgX2EgPSBzcGxpY2VzW2ldLCBpbmRleCA9IF9hLmluZGV4LCByZW1vdmVkID0gX2EucmVtb3ZlZCwgYWRkZWRDb3VudCA9IF9hLmFkZGVkQ291bnQ7XHJcbiAgICAgICAgICAgICAgICBtZXJnZVNwbGljZShyZXBlYXQuX19xdWV1ZWRTcGxpY2VzLCBpbmRleCwgcmVtb3ZlZCwgYWRkZWRDb3VudCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmVwZWF0Ll9fYXJyYXkgPSBhcnJheS5zbGljZSgwKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgbWF5YmVQcm9taXNlID0gdGhpcy5fcnVuU3BsaWNlcyhyZXBlYXQsIGFycmF5LnNsaWNlKDApLCBzcGxpY2VzKTtcclxuICAgICAgICBpZiAobWF5YmVQcm9taXNlIGluc3RhbmNlb2YgUHJvbWlzZSkge1xyXG4gICAgICAgICAgICB2YXIgcXVldWVkU3BsaWNlc18xID0gcmVwZWF0Ll9fcXVldWVkU3BsaWNlcyA9IFtdO1xyXG4gICAgICAgICAgICB2YXIgcnVuUXVldWVkU3BsaWNlc18xID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFxdWV1ZWRTcGxpY2VzXzEubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVwZWF0Ll9fcXVldWVkU3BsaWNlcyA9IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgICAgICAgICByZXBlYXQuX19hcnJheSA9IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB2YXIgbmV4dFByb21pc2UgPSBfdGhpcy5fcnVuU3BsaWNlcyhyZXBlYXQsIHJlcGVhdC5fX2FycmF5LCBxdWV1ZWRTcGxpY2VzXzEpIHx8IFByb21pc2UucmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICAgICAgcXVldWVkU3BsaWNlc18xID0gcmVwZWF0Ll9fcXVldWVkU3BsaWNlcyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgbmV4dFByb21pc2UudGhlbihydW5RdWV1ZWRTcGxpY2VzXzEpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBtYXliZVByb21pc2UudGhlbihydW5RdWV1ZWRTcGxpY2VzXzEpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBBcnJheVJlcGVhdFN0cmF0ZWd5LnByb3RvdHlwZS5fcnVuU3BsaWNlcyA9IGZ1bmN0aW9uIChyZXBlYXQsIGFycmF5LCBzcGxpY2VzKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgcmVtb3ZlRGVsdGEgPSAwO1xyXG4gICAgICAgIHZhciBybVByb21pc2VzID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGlpID0gc3BsaWNlcy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7XHJcbiAgICAgICAgICAgIHZhciBzcGxpY2UgPSBzcGxpY2VzW2ldO1xyXG4gICAgICAgICAgICB2YXIgcmVtb3ZlZCA9IHNwbGljZS5yZW1vdmVkO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMCwgamogPSByZW1vdmVkLmxlbmd0aDsgaiA8IGpqOyArK2opIHtcclxuICAgICAgICAgICAgICAgIHZhciB2aWV3T3JQcm9taXNlID0gcmVwZWF0LnJlbW92ZVZpZXcoc3BsaWNlLmluZGV4ICsgcmVtb3ZlRGVsdGEgKyBybVByb21pc2VzLmxlbmd0aCwgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICBpZiAodmlld09yUHJvbWlzZSBpbnN0YW5jZW9mIFByb21pc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICBybVByb21pc2VzLnB1c2godmlld09yUHJvbWlzZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmVtb3ZlRGVsdGEgLT0gc3BsaWNlLmFkZGVkQ291bnQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChybVByb21pc2VzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UuYWxsKHJtUHJvbWlzZXMpLnRoZW4oZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHNwbGljZUluZGV4TG93ID0gX3RoaXMuX2hhbmRsZUFkZGVkU3BsaWNlcyhyZXBlYXQsIGFycmF5LCBzcGxpY2VzKTtcclxuICAgICAgICAgICAgICAgIHVwZGF0ZU92ZXJyaWRlQ29udGV4dHMocmVwZWF0LnZpZXdzKCksIHNwbGljZUluZGV4TG93KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBzcGxpY2VJbmRleExvdyA9IHRoaXMuX2hhbmRsZUFkZGVkU3BsaWNlcyhyZXBlYXQsIGFycmF5LCBzcGxpY2VzKTtcclxuICAgICAgICB1cGRhdGVPdmVycmlkZUNvbnRleHRzKHJlcGVhdC52aWV3cygpLCBzcGxpY2VJbmRleExvdyk7XHJcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcclxuICAgIH07XHJcbiAgICBBcnJheVJlcGVhdFN0cmF0ZWd5LnByb3RvdHlwZS5faGFuZGxlQWRkZWRTcGxpY2VzID0gZnVuY3Rpb24gKHJlcGVhdCwgYXJyYXksIHNwbGljZXMpIHtcclxuICAgICAgICB2YXIgc3BsaWNlSW5kZXg7XHJcbiAgICAgICAgdmFyIHNwbGljZUluZGV4TG93O1xyXG4gICAgICAgIHZhciBhcnJheUxlbmd0aCA9IGFycmF5Lmxlbmd0aDtcclxuICAgICAgICBmb3IgKHZhciBpID0gMCwgaWkgPSBzcGxpY2VzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHtcclxuICAgICAgICAgICAgdmFyIHNwbGljZSA9IHNwbGljZXNbaV07XHJcbiAgICAgICAgICAgIHZhciBhZGRJbmRleCA9IHNwbGljZUluZGV4ID0gc3BsaWNlLmluZGV4O1xyXG4gICAgICAgICAgICB2YXIgZW5kID0gc3BsaWNlLmluZGV4ICsgc3BsaWNlLmFkZGVkQ291bnQ7XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2Ygc3BsaWNlSW5kZXhMb3cgPT09ICd1bmRlZmluZWQnIHx8IHNwbGljZUluZGV4TG93ID09PSBudWxsIHx8IHNwbGljZUluZGV4TG93ID4gc3BsaWNlLmluZGV4KSB7XHJcbiAgICAgICAgICAgICAgICBzcGxpY2VJbmRleExvdyA9IHNwbGljZUluZGV4O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGZvciAoOyBhZGRJbmRleCA8IGVuZDsgKythZGRJbmRleCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIG92ZXJyaWRlQ29udGV4dCA9IGNyZWF0ZUZ1bGxPdmVycmlkZUNvbnRleHQocmVwZWF0LCBhcnJheVthZGRJbmRleF0sIGFkZEluZGV4LCBhcnJheUxlbmd0aCk7XHJcbiAgICAgICAgICAgICAgICByZXBlYXQuaW5zZXJ0VmlldyhhZGRJbmRleCwgb3ZlcnJpZGVDb250ZXh0LmJpbmRpbmdDb250ZXh0LCBvdmVycmlkZUNvbnRleHQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBzcGxpY2VJbmRleExvdztcclxuICAgIH07XHJcbiAgICByZXR1cm4gQXJyYXlSZXBlYXRTdHJhdGVneTtcclxufSgpKTtcblxudmFyIE1hcFJlcGVhdFN0cmF0ZWd5ID0gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIE1hcFJlcGVhdFN0cmF0ZWd5KCkge1xyXG4gICAgfVxyXG4gICAgTWFwUmVwZWF0U3RyYXRlZ3kucHJvdG90eXBlLmdldENvbGxlY3Rpb25PYnNlcnZlciA9IGZ1bmN0aW9uIChvYnNlcnZlckxvY2F0b3IsIGl0ZW1zKSB7XHJcbiAgICAgICAgcmV0dXJuIG9ic2VydmVyTG9jYXRvci5nZXRNYXBPYnNlcnZlcihpdGVtcyk7XHJcbiAgICB9O1xyXG4gICAgTWFwUmVwZWF0U3RyYXRlZ3kucHJvdG90eXBlLmluc3RhbmNlQ2hhbmdlZCA9IGZ1bmN0aW9uIChyZXBlYXQsIGl0ZW1zKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgcmVtb3ZlUHJvbWlzZSA9IHJlcGVhdC5yZW1vdmVBbGxWaWV3cyh0cnVlLCAhcmVwZWF0LnZpZXdzUmVxdWlyZUxpZmVjeWNsZSk7XHJcbiAgICAgICAgaWYgKHJlbW92ZVByb21pc2UgaW5zdGFuY2VvZiBQcm9taXNlKSB7XHJcbiAgICAgICAgICAgIHJlbW92ZVByb21pc2UudGhlbihmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5fc3RhbmRhcmRQcm9jZXNzSXRlbXMocmVwZWF0LCBpdGVtcyk7IH0pO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX3N0YW5kYXJkUHJvY2Vzc0l0ZW1zKHJlcGVhdCwgaXRlbXMpO1xyXG4gICAgfTtcclxuICAgIE1hcFJlcGVhdFN0cmF0ZWd5LnByb3RvdHlwZS5fc3RhbmRhcmRQcm9jZXNzSXRlbXMgPSBmdW5jdGlvbiAocmVwZWF0LCBpdGVtcykge1xyXG4gICAgICAgIHZhciBpbmRleCA9IDA7XHJcbiAgICAgICAgdmFyIG92ZXJyaWRlQ29udGV4dDtcclxuICAgICAgICBpdGVtcy5mb3JFYWNoKGZ1bmN0aW9uICh2YWx1ZSwga2V5KSB7XHJcbiAgICAgICAgICAgIG92ZXJyaWRlQ29udGV4dCA9IGNyZWF0ZUZ1bGxPdmVycmlkZUNvbnRleHQocmVwZWF0LCB2YWx1ZSwgaW5kZXgsIGl0ZW1zLnNpemUsIGtleSk7XHJcbiAgICAgICAgICAgIHJlcGVhdC5hZGRWaWV3KG92ZXJyaWRlQ29udGV4dC5iaW5kaW5nQ29udGV4dCwgb3ZlcnJpZGVDb250ZXh0KTtcclxuICAgICAgICAgICAgKytpbmRleDtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBNYXBSZXBlYXRTdHJhdGVneS5wcm90b3R5cGUuaW5zdGFuY2VNdXRhdGVkID0gZnVuY3Rpb24gKHJlcGVhdCwgbWFwLCByZWNvcmRzKSB7XHJcbiAgICAgICAgdmFyIGtleTtcclxuICAgICAgICB2YXIgaTtcclxuICAgICAgICB2YXIgaWk7XHJcbiAgICAgICAgdmFyIG92ZXJyaWRlQ29udGV4dDtcclxuICAgICAgICB2YXIgcmVtb3ZlSW5kZXg7XHJcbiAgICAgICAgdmFyIGFkZEluZGV4O1xyXG4gICAgICAgIHZhciByZWNvcmQ7XHJcbiAgICAgICAgdmFyIHJtUHJvbWlzZXMgPSBbXTtcclxuICAgICAgICB2YXIgdmlld09yUHJvbWlzZTtcclxuICAgICAgICBmb3IgKGkgPSAwLCBpaSA9IHJlY29yZHMubGVuZ3RoOyBpIDwgaWk7ICsraSkge1xyXG4gICAgICAgICAgICByZWNvcmQgPSByZWNvcmRzW2ldO1xyXG4gICAgICAgICAgICBrZXkgPSByZWNvcmQua2V5O1xyXG4gICAgICAgICAgICBzd2l0Y2ggKHJlY29yZC50eXBlKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlICd1cGRhdGUnOlxyXG4gICAgICAgICAgICAgICAgICAgIHJlbW92ZUluZGV4ID0gdGhpcy5fZ2V0Vmlld0luZGV4QnlLZXkocmVwZWF0LCBrZXkpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZpZXdPclByb21pc2UgPSByZXBlYXQucmVtb3ZlVmlldyhyZW1vdmVJbmRleCwgdHJ1ZSwgIXJlcGVhdC52aWV3c1JlcXVpcmVMaWZlY3ljbGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh2aWV3T3JQcm9taXNlIGluc3RhbmNlb2YgUHJvbWlzZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBybVByb21pc2VzLnB1c2godmlld09yUHJvbWlzZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIG92ZXJyaWRlQ29udGV4dCA9IGNyZWF0ZUZ1bGxPdmVycmlkZUNvbnRleHQocmVwZWF0LCBtYXAuZ2V0KGtleSksIHJlbW92ZUluZGV4LCBtYXAuc2l6ZSwga2V5KTtcclxuICAgICAgICAgICAgICAgICAgICByZXBlYXQuaW5zZXJ0VmlldyhyZW1vdmVJbmRleCwgb3ZlcnJpZGVDb250ZXh0LmJpbmRpbmdDb250ZXh0LCBvdmVycmlkZUNvbnRleHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnYWRkJzpcclxuICAgICAgICAgICAgICAgICAgICBhZGRJbmRleCA9IHJlcGVhdC52aWV3Q291bnQoKSA8PSBtYXAuc2l6ZSAtIDEgPyByZXBlYXQudmlld0NvdW50KCkgOiBtYXAuc2l6ZSAtIDE7XHJcbiAgICAgICAgICAgICAgICAgICAgb3ZlcnJpZGVDb250ZXh0ID0gY3JlYXRlRnVsbE92ZXJyaWRlQ29udGV4dChyZXBlYXQsIG1hcC5nZXQoa2V5KSwgYWRkSW5kZXgsIG1hcC5zaXplLCBrZXkpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJlcGVhdC5pbnNlcnRWaWV3KG1hcC5zaXplIC0gMSwgb3ZlcnJpZGVDb250ZXh0LmJpbmRpbmdDb250ZXh0LCBvdmVycmlkZUNvbnRleHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnZGVsZXRlJzpcclxuICAgICAgICAgICAgICAgICAgICBpZiAocmVjb3JkLm9sZFZhbHVlID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByZW1vdmVJbmRleCA9IHRoaXMuX2dldFZpZXdJbmRleEJ5S2V5KHJlcGVhdCwga2V5KTtcclxuICAgICAgICAgICAgICAgICAgICB2aWV3T3JQcm9taXNlID0gcmVwZWF0LnJlbW92ZVZpZXcocmVtb3ZlSW5kZXgsIHRydWUsICFyZXBlYXQudmlld3NSZXF1aXJlTGlmZWN5Y2xlKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodmlld09yUHJvbWlzZSBpbnN0YW5jZW9mIFByb21pc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcm1Qcm9taXNlcy5wdXNoKHZpZXdPclByb21pc2UpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgJ2NsZWFyJzpcclxuICAgICAgICAgICAgICAgICAgICByZXBlYXQucmVtb3ZlQWxsVmlld3ModHJ1ZSwgIXJlcGVhdC52aWV3c1JlcXVpcmVMaWZlY3ljbGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAocm1Qcm9taXNlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIFByb21pc2UuYWxsKHJtUHJvbWlzZXMpLnRoZW4oZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdXBkYXRlT3ZlcnJpZGVDb250ZXh0cyhyZXBlYXQudmlld3MoKSwgMCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdXBkYXRlT3ZlcnJpZGVDb250ZXh0cyhyZXBlYXQudmlld3MoKSwgMCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIE1hcFJlcGVhdFN0cmF0ZWd5LnByb3RvdHlwZS5fZ2V0Vmlld0luZGV4QnlLZXkgPSBmdW5jdGlvbiAocmVwZWF0LCBrZXkpIHtcclxuICAgICAgICB2YXIgaTtcclxuICAgICAgICB2YXIgaWk7XHJcbiAgICAgICAgdmFyIGNoaWxkO1xyXG4gICAgICAgIGZvciAoaSA9IDAsIGlpID0gcmVwZWF0LnZpZXdDb3VudCgpOyBpIDwgaWk7ICsraSkge1xyXG4gICAgICAgICAgICBjaGlsZCA9IHJlcGVhdC52aWV3KGkpO1xyXG4gICAgICAgICAgICBpZiAoY2hpbGQuYmluZGluZ0NvbnRleHRbcmVwZWF0LmtleV0gPT09IGtleSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcclxuICAgIH07XHJcbiAgICByZXR1cm4gTWFwUmVwZWF0U3RyYXRlZ3k7XHJcbn0oKSk7XG5cbnZhciBOdWxsUmVwZWF0U3RyYXRlZ3kgPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gTnVsbFJlcGVhdFN0cmF0ZWd5KCkge1xyXG4gICAgfVxyXG4gICAgTnVsbFJlcGVhdFN0cmF0ZWd5LnByb3RvdHlwZS5pbnN0YW5jZUNoYW5nZWQgPSBmdW5jdGlvbiAocmVwZWF0LCBpdGVtcykge1xyXG4gICAgICAgIHJlcGVhdC5yZW1vdmVBbGxWaWV3cyh0cnVlKTtcclxuICAgIH07XHJcbiAgICBOdWxsUmVwZWF0U3RyYXRlZ3kucHJvdG90eXBlLmdldENvbGxlY3Rpb25PYnNlcnZlciA9IGZ1bmN0aW9uIChvYnNlcnZlckxvY2F0b3IsIGl0ZW1zKSB7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIE51bGxSZXBlYXRTdHJhdGVneTtcclxufSgpKTtcblxudmFyIE51bWJlclJlcGVhdFN0cmF0ZWd5ID0gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIE51bWJlclJlcGVhdFN0cmF0ZWd5KCkge1xyXG4gICAgfVxyXG4gICAgTnVtYmVyUmVwZWF0U3RyYXRlZ3kucHJvdG90eXBlLmdldENvbGxlY3Rpb25PYnNlcnZlciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH07XHJcbiAgICBOdW1iZXJSZXBlYXRTdHJhdGVneS5wcm90b3R5cGUuaW5zdGFuY2VDaGFuZ2VkID0gZnVuY3Rpb24gKHJlcGVhdCwgdmFsdWUpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciByZW1vdmVQcm9taXNlID0gcmVwZWF0LnJlbW92ZUFsbFZpZXdzKHRydWUsICFyZXBlYXQudmlld3NSZXF1aXJlTGlmZWN5Y2xlKTtcclxuICAgICAgICBpZiAocmVtb3ZlUHJvbWlzZSBpbnN0YW5jZW9mIFByb21pc2UpIHtcclxuICAgICAgICAgICAgcmVtb3ZlUHJvbWlzZS50aGVuKGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLl9zdGFuZGFyZFByb2Nlc3NJdGVtcyhyZXBlYXQsIHZhbHVlKTsgfSk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fc3RhbmRhcmRQcm9jZXNzSXRlbXMocmVwZWF0LCB2YWx1ZSk7XHJcbiAgICB9O1xyXG4gICAgTnVtYmVyUmVwZWF0U3RyYXRlZ3kucHJvdG90eXBlLl9zdGFuZGFyZFByb2Nlc3NJdGVtcyA9IGZ1bmN0aW9uIChyZXBlYXQsIHZhbHVlKSB7XHJcbiAgICAgICAgdmFyIGNoaWxkcmVuTGVuZ3RoID0gcmVwZWF0LnZpZXdDb3VudCgpO1xyXG4gICAgICAgIHZhciBpO1xyXG4gICAgICAgIHZhciBpaTtcclxuICAgICAgICB2YXIgb3ZlcnJpZGVDb250ZXh0O1xyXG4gICAgICAgIHZhciB2aWV3c1RvUmVtb3ZlO1xyXG4gICAgICAgIHZhbHVlID0gTWF0aC5mbG9vcih2YWx1ZSk7XHJcbiAgICAgICAgdmlld3NUb1JlbW92ZSA9IGNoaWxkcmVuTGVuZ3RoIC0gdmFsdWU7XHJcbiAgICAgICAgaWYgKHZpZXdzVG9SZW1vdmUgPiAwKSB7XHJcbiAgICAgICAgICAgIGlmICh2aWV3c1RvUmVtb3ZlID4gY2hpbGRyZW5MZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIHZpZXdzVG9SZW1vdmUgPSBjaGlsZHJlbkxlbmd0aDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBmb3IgKGkgPSAwLCBpaSA9IHZpZXdzVG9SZW1vdmU7IGkgPCBpaTsgKytpKSB7XHJcbiAgICAgICAgICAgICAgICByZXBlYXQucmVtb3ZlVmlldyhjaGlsZHJlbkxlbmd0aCAtIChpICsgMSksIHRydWUsICFyZXBlYXQudmlld3NSZXF1aXJlTGlmZWN5Y2xlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZvciAoaSA9IGNoaWxkcmVuTGVuZ3RoLCBpaSA9IHZhbHVlOyBpIDwgaWk7ICsraSkge1xyXG4gICAgICAgICAgICBvdmVycmlkZUNvbnRleHQgPSBjcmVhdGVGdWxsT3ZlcnJpZGVDb250ZXh0KHJlcGVhdCwgaSwgaSwgaWkpO1xyXG4gICAgICAgICAgICByZXBlYXQuYWRkVmlldyhvdmVycmlkZUNvbnRleHQuYmluZGluZ0NvbnRleHQsIG92ZXJyaWRlQ29udGV4dCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHVwZGF0ZU92ZXJyaWRlQ29udGV4dHMocmVwZWF0LnZpZXdzKCksIDApO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBOdW1iZXJSZXBlYXRTdHJhdGVneTtcclxufSgpKTtcblxudmFyIFNldFJlcGVhdFN0cmF0ZWd5ID0gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFNldFJlcGVhdFN0cmF0ZWd5KCkge1xyXG4gICAgfVxyXG4gICAgU2V0UmVwZWF0U3RyYXRlZ3kucHJvdG90eXBlLmdldENvbGxlY3Rpb25PYnNlcnZlciA9IGZ1bmN0aW9uIChvYnNlcnZlckxvY2F0b3IsIGl0ZW1zKSB7XHJcbiAgICAgICAgcmV0dXJuIG9ic2VydmVyTG9jYXRvci5nZXRTZXRPYnNlcnZlcihpdGVtcyk7XHJcbiAgICB9O1xyXG4gICAgU2V0UmVwZWF0U3RyYXRlZ3kucHJvdG90eXBlLmluc3RhbmNlQ2hhbmdlZCA9IGZ1bmN0aW9uIChyZXBlYXQsIGl0ZW1zKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgcmVtb3ZlUHJvbWlzZSA9IHJlcGVhdC5yZW1vdmVBbGxWaWV3cyh0cnVlLCAhcmVwZWF0LnZpZXdzUmVxdWlyZUxpZmVjeWNsZSk7XHJcbiAgICAgICAgaWYgKHJlbW92ZVByb21pc2UgaW5zdGFuY2VvZiBQcm9taXNlKSB7XHJcbiAgICAgICAgICAgIHJlbW92ZVByb21pc2UudGhlbihmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5fc3RhbmRhcmRQcm9jZXNzSXRlbXMocmVwZWF0LCBpdGVtcyk7IH0pO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX3N0YW5kYXJkUHJvY2Vzc0l0ZW1zKHJlcGVhdCwgaXRlbXMpO1xyXG4gICAgfTtcclxuICAgIFNldFJlcGVhdFN0cmF0ZWd5LnByb3RvdHlwZS5fc3RhbmRhcmRQcm9jZXNzSXRlbXMgPSBmdW5jdGlvbiAocmVwZWF0LCBpdGVtcykge1xyXG4gICAgICAgIHZhciBpbmRleCA9IDA7XHJcbiAgICAgICAgdmFyIG92ZXJyaWRlQ29udGV4dDtcclxuICAgICAgICBpdGVtcy5mb3JFYWNoKGZ1bmN0aW9uICh2YWx1ZSkge1xyXG4gICAgICAgICAgICBvdmVycmlkZUNvbnRleHQgPSBjcmVhdGVGdWxsT3ZlcnJpZGVDb250ZXh0KHJlcGVhdCwgdmFsdWUsIGluZGV4LCBpdGVtcy5zaXplKTtcclxuICAgICAgICAgICAgcmVwZWF0LmFkZFZpZXcob3ZlcnJpZGVDb250ZXh0LmJpbmRpbmdDb250ZXh0LCBvdmVycmlkZUNvbnRleHQpO1xyXG4gICAgICAgICAgICArK2luZGV4O1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIFNldFJlcGVhdFN0cmF0ZWd5LnByb3RvdHlwZS5pbnN0YW5jZU11dGF0ZWQgPSBmdW5jdGlvbiAocmVwZWF0LCBzZXQsIHJlY29yZHMpIHtcclxuICAgICAgICB2YXIgdmFsdWU7XHJcbiAgICAgICAgdmFyIGk7XHJcbiAgICAgICAgdmFyIGlpO1xyXG4gICAgICAgIHZhciBvdmVycmlkZUNvbnRleHQ7XHJcbiAgICAgICAgdmFyIHJlbW92ZUluZGV4O1xyXG4gICAgICAgIHZhciByZWNvcmQ7XHJcbiAgICAgICAgdmFyIHJtUHJvbWlzZXMgPSBbXTtcclxuICAgICAgICB2YXIgdmlld09yUHJvbWlzZTtcclxuICAgICAgICBmb3IgKGkgPSAwLCBpaSA9IHJlY29yZHMubGVuZ3RoOyBpIDwgaWk7ICsraSkge1xyXG4gICAgICAgICAgICByZWNvcmQgPSByZWNvcmRzW2ldO1xyXG4gICAgICAgICAgICB2YWx1ZSA9IHJlY29yZC52YWx1ZTtcclxuICAgICAgICAgICAgc3dpdGNoIChyZWNvcmQudHlwZSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnYWRkJzpcclxuICAgICAgICAgICAgICAgICAgICB2YXIgc2l6ZSA9IE1hdGgubWF4KHNldC5zaXplIC0gMSwgMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgb3ZlcnJpZGVDb250ZXh0ID0gY3JlYXRlRnVsbE92ZXJyaWRlQ29udGV4dChyZXBlYXQsIHZhbHVlLCBzaXplLCBzZXQuc2l6ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVwZWF0Lmluc2VydFZpZXcoc2l6ZSwgb3ZlcnJpZGVDb250ZXh0LmJpbmRpbmdDb250ZXh0LCBvdmVycmlkZUNvbnRleHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnZGVsZXRlJzpcclxuICAgICAgICAgICAgICAgICAgICByZW1vdmVJbmRleCA9IHRoaXMuX2dldFZpZXdJbmRleEJ5VmFsdWUocmVwZWF0LCB2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmlld09yUHJvbWlzZSA9IHJlcGVhdC5yZW1vdmVWaWV3KHJlbW92ZUluZGV4LCB0cnVlLCAhcmVwZWF0LnZpZXdzUmVxdWlyZUxpZmVjeWNsZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZpZXdPclByb21pc2UgaW5zdGFuY2VvZiBQcm9taXNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJtUHJvbWlzZXMucHVzaCh2aWV3T3JQcm9taXNlKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdjbGVhcic6XHJcbiAgICAgICAgICAgICAgICAgICAgcmVwZWF0LnJlbW92ZUFsbFZpZXdzKHRydWUsICFyZXBlYXQudmlld3NSZXF1aXJlTGlmZWN5Y2xlKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHJtUHJvbWlzZXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBQcm9taXNlLmFsbChybVByb21pc2VzKS50aGVuKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHVwZGF0ZU92ZXJyaWRlQ29udGV4dHMocmVwZWF0LnZpZXdzKCksIDApO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHVwZGF0ZU92ZXJyaWRlQ29udGV4dHMocmVwZWF0LnZpZXdzKCksIDApO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBTZXRSZXBlYXRTdHJhdGVneS5wcm90b3R5cGUuX2dldFZpZXdJbmRleEJ5VmFsdWUgPSBmdW5jdGlvbiAocmVwZWF0LCB2YWx1ZSkge1xyXG4gICAgICAgIHZhciBpO1xyXG4gICAgICAgIHZhciBpaTtcclxuICAgICAgICB2YXIgY2hpbGQ7XHJcbiAgICAgICAgZm9yIChpID0gMCwgaWkgPSByZXBlYXQudmlld0NvdW50KCk7IGkgPCBpaTsgKytpKSB7XHJcbiAgICAgICAgICAgIGNoaWxkID0gcmVwZWF0LnZpZXcoaSk7XHJcbiAgICAgICAgICAgIGlmIChjaGlsZC5iaW5kaW5nQ29udGV4dFtyZXBlYXQubG9jYWxdID09PSB2YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcclxuICAgIH07XHJcbiAgICByZXR1cm4gU2V0UmVwZWF0U3RyYXRlZ3k7XHJcbn0oKSk7XG5cbnZhciBSZXBlYXRTdHJhdGVneUxvY2F0b3IgPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gUmVwZWF0U3RyYXRlZ3lMb2NhdG9yKCkge1xyXG4gICAgICAgIHRoaXMubWF0Y2hlcnMgPSBbXTtcclxuICAgICAgICB0aGlzLnN0cmF0ZWdpZXMgPSBbXTtcclxuICAgICAgICB0aGlzLmFkZFN0cmF0ZWd5KGZ1bmN0aW9uIChpdGVtcykgeyByZXR1cm4gaXRlbXMgPT09IG51bGwgfHwgaXRlbXMgPT09IHVuZGVmaW5lZDsgfSwgbmV3IE51bGxSZXBlYXRTdHJhdGVneSgpKTtcclxuICAgICAgICB0aGlzLmFkZFN0cmF0ZWd5KGZ1bmN0aW9uIChpdGVtcykgeyByZXR1cm4gaXRlbXMgaW5zdGFuY2VvZiBBcnJheTsgfSwgbmV3IEFycmF5UmVwZWF0U3RyYXRlZ3koKSk7XHJcbiAgICAgICAgdGhpcy5hZGRTdHJhdGVneShmdW5jdGlvbiAoaXRlbXMpIHsgcmV0dXJuIGl0ZW1zIGluc3RhbmNlb2YgTWFwOyB9LCBuZXcgTWFwUmVwZWF0U3RyYXRlZ3koKSk7XHJcbiAgICAgICAgdGhpcy5hZGRTdHJhdGVneShmdW5jdGlvbiAoaXRlbXMpIHsgcmV0dXJuIGl0ZW1zIGluc3RhbmNlb2YgU2V0OyB9LCBuZXcgU2V0UmVwZWF0U3RyYXRlZ3koKSk7XHJcbiAgICAgICAgdGhpcy5hZGRTdHJhdGVneShmdW5jdGlvbiAoaXRlbXMpIHsgcmV0dXJuIHR5cGVvZiBpdGVtcyA9PT0gJ251bWJlcic7IH0sIG5ldyBOdW1iZXJSZXBlYXRTdHJhdGVneSgpKTtcclxuICAgIH1cclxuICAgIFJlcGVhdFN0cmF0ZWd5TG9jYXRvci5wcm90b3R5cGUuYWRkU3RyYXRlZ3kgPSBmdW5jdGlvbiAobWF0Y2hlciwgc3RyYXRlZ3kpIHtcclxuICAgICAgICB0aGlzLm1hdGNoZXJzLnB1c2gobWF0Y2hlcik7XHJcbiAgICAgICAgdGhpcy5zdHJhdGVnaWVzLnB1c2goc3RyYXRlZ3kpO1xyXG4gICAgfTtcclxuICAgIFJlcGVhdFN0cmF0ZWd5TG9jYXRvci5wcm90b3R5cGUuZ2V0U3RyYXRlZ3kgPSBmdW5jdGlvbiAoaXRlbXMpIHtcclxuICAgICAgICB2YXIgbWF0Y2hlcnMgPSB0aGlzLm1hdGNoZXJzO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBpaSA9IG1hdGNoZXJzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHtcclxuICAgICAgICAgICAgaWYgKG1hdGNoZXJzW2ldKGl0ZW1zKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3RyYXRlZ2llc1tpXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH07XHJcbiAgICByZXR1cm4gUmVwZWF0U3RyYXRlZ3lMb2NhdG9yO1xyXG59KCkpO1xuXG52YXIgbGlmZWN5Y2xlT3B0aW9uYWxCZWhhdmlvcnMgPSBbJ2ZvY3VzJywgJ2lmJywgJ2Vsc2UnLCAncmVwZWF0JywgJ3Nob3cnLCAnaGlkZScsICd3aXRoJ107XHJcbmZ1bmN0aW9uIGJlaGF2aW9yUmVxdWlyZXNMaWZlY3ljbGUoaW5zdHJ1Y3Rpb24pIHtcclxuICAgIHZhciB0ID0gaW5zdHJ1Y3Rpb24udHlwZTtcclxuICAgIHZhciBuYW1lID0gdC5lbGVtZW50TmFtZSAhPT0gbnVsbCA/IHQuZWxlbWVudE5hbWUgOiB0LmF0dHJpYnV0ZU5hbWU7XHJcbiAgICByZXR1cm4gbGlmZWN5Y2xlT3B0aW9uYWxCZWhhdmlvcnMuaW5kZXhPZihuYW1lKSA9PT0gLTEgJiYgKHQuaGFuZGxlc0F0dGFjaGVkIHx8IHQuaGFuZGxlc0JpbmQgfHwgdC5oYW5kbGVzQ3JlYXRlZCB8fCB0LmhhbmRsZXNEZXRhY2hlZCB8fCB0LmhhbmRsZXNVbmJpbmQpXHJcbiAgICAgICAgfHwgdC52aWV3RmFjdG9yeSAmJiB2aWV3c1JlcXVpcmVMaWZlY3ljbGUodC52aWV3RmFjdG9yeSlcclxuICAgICAgICB8fCBpbnN0cnVjdGlvbi52aWV3RmFjdG9yeSAmJiB2aWV3c1JlcXVpcmVMaWZlY3ljbGUoaW5zdHJ1Y3Rpb24udmlld0ZhY3RvcnkpO1xyXG59XHJcbmZ1bmN0aW9uIHRhcmdldFJlcXVpcmVzTGlmZWN5Y2xlKGluc3RydWN0aW9uKSB7XHJcbiAgICB2YXIgYmVoYXZpb3JzID0gaW5zdHJ1Y3Rpb24uYmVoYXZpb3JJbnN0cnVjdGlvbnM7XHJcbiAgICBpZiAoYmVoYXZpb3JzKSB7XHJcbiAgICAgICAgdmFyIGkgPSBiZWhhdmlvcnMubGVuZ3RoO1xyXG4gICAgICAgIHdoaWxlIChpLS0pIHtcclxuICAgICAgICAgICAgaWYgKGJlaGF2aW9yUmVxdWlyZXNMaWZlY3ljbGUoYmVoYXZpb3JzW2ldKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gaW5zdHJ1Y3Rpb24udmlld0ZhY3RvcnkgJiYgdmlld3NSZXF1aXJlTGlmZWN5Y2xlKGluc3RydWN0aW9uLnZpZXdGYWN0b3J5KTtcclxufVxyXG5mdW5jdGlvbiB2aWV3c1JlcXVpcmVMaWZlY3ljbGUodmlld0ZhY3RvcnkpIHtcclxuICAgIGlmICgnX3ZpZXdzUmVxdWlyZUxpZmVjeWNsZScgaW4gdmlld0ZhY3RvcnkpIHtcclxuICAgICAgICByZXR1cm4gdmlld0ZhY3RvcnkuX3ZpZXdzUmVxdWlyZUxpZmVjeWNsZTtcclxuICAgIH1cclxuICAgIHZpZXdGYWN0b3J5Ll92aWV3c1JlcXVpcmVMaWZlY3ljbGUgPSBmYWxzZTtcclxuICAgIGlmICh2aWV3RmFjdG9yeS52aWV3RmFjdG9yeSkge1xyXG4gICAgICAgIHZpZXdGYWN0b3J5Ll92aWV3c1JlcXVpcmVMaWZlY3ljbGUgPSB2aWV3c1JlcXVpcmVMaWZlY3ljbGUodmlld0ZhY3Rvcnkudmlld0ZhY3RvcnkpO1xyXG4gICAgICAgIHJldHVybiB2aWV3RmFjdG9yeS5fdmlld3NSZXF1aXJlTGlmZWN5Y2xlO1xyXG4gICAgfVxyXG4gICAgaWYgKHZpZXdGYWN0b3J5LnRlbXBsYXRlLnF1ZXJ5U2VsZWN0b3IoJy5hdS1hbmltYXRlJykpIHtcclxuICAgICAgICB2aWV3RmFjdG9yeS5fdmlld3NSZXF1aXJlTGlmZWN5Y2xlID0gdHJ1ZTtcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxuICAgIGZvciAodmFyIGlkIGluIHZpZXdGYWN0b3J5Lmluc3RydWN0aW9ucykge1xyXG4gICAgICAgIGlmICh0YXJnZXRSZXF1aXJlc0xpZmVjeWNsZSh2aWV3RmFjdG9yeS5pbnN0cnVjdGlvbnNbaWRdKSkge1xyXG4gICAgICAgICAgICB2aWV3RmFjdG9yeS5fdmlld3NSZXF1aXJlTGlmZWN5Y2xlID0gdHJ1ZTtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgdmlld0ZhY3RvcnkuX3ZpZXdzUmVxdWlyZUxpZmVjeWNsZSA9IGZhbHNlO1xyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG59XG5cbnZhciBBYnN0cmFjdFJlcGVhdGVyID0gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEFic3RyYWN0UmVwZWF0ZXIob3B0aW9ucykge1xyXG4gICAgICAgIE9iamVjdC5hc3NpZ24odGhpcywge1xyXG4gICAgICAgICAgICBsb2NhbDogJ2l0ZW1zJyxcclxuICAgICAgICAgICAgdmlld3NSZXF1aXJlTGlmZWN5Y2xlOiB0cnVlXHJcbiAgICAgICAgfSwgb3B0aW9ucyk7XHJcbiAgICB9XHJcbiAgICBBYnN0cmFjdFJlcGVhdGVyLnByb3RvdHlwZS52aWV3Q291bnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdzdWJjbGFzcyBtdXN0IGltcGxlbWVudCBgdmlld0NvdW50YCcpO1xyXG4gICAgfTtcclxuICAgIEFic3RyYWN0UmVwZWF0ZXIucHJvdG90eXBlLnZpZXdzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcignc3ViY2xhc3MgbXVzdCBpbXBsZW1lbnQgYHZpZXdzYCcpO1xyXG4gICAgfTtcclxuICAgIEFic3RyYWN0UmVwZWF0ZXIucHJvdG90eXBlLnZpZXcgPSBmdW5jdGlvbiAoaW5kZXgpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ3N1YmNsYXNzIG11c3QgaW1wbGVtZW50IGB2aWV3YCcpO1xyXG4gICAgfTtcclxuICAgIEFic3RyYWN0UmVwZWF0ZXIucHJvdG90eXBlLm1hdGNoZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdzdWJjbGFzcyBtdXN0IGltcGxlbWVudCBgbWF0Y2hlcmAnKTtcclxuICAgIH07XHJcbiAgICBBYnN0cmFjdFJlcGVhdGVyLnByb3RvdHlwZS5hZGRWaWV3ID0gZnVuY3Rpb24gKGJpbmRpbmdDb250ZXh0LCBvdmVycmlkZUNvbnRleHQpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ3N1YmNsYXNzIG11c3QgaW1wbGVtZW50IGBhZGRWaWV3YCcpO1xyXG4gICAgfTtcclxuICAgIEFic3RyYWN0UmVwZWF0ZXIucHJvdG90eXBlLmluc2VydFZpZXcgPSBmdW5jdGlvbiAoaW5kZXgsIGJpbmRpbmdDb250ZXh0LCBvdmVycmlkZUNvbnRleHQpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ3N1YmNsYXNzIG11c3QgaW1wbGVtZW50IGBpbnNlcnRWaWV3YCcpO1xyXG4gICAgfTtcclxuICAgIEFic3RyYWN0UmVwZWF0ZXIucHJvdG90eXBlLm1vdmVWaWV3ID0gZnVuY3Rpb24gKHNvdXJjZUluZGV4LCB0YXJnZXRJbmRleCkge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcignc3ViY2xhc3MgbXVzdCBpbXBsZW1lbnQgYG1vdmVWaWV3YCcpO1xyXG4gICAgfTtcclxuICAgIEFic3RyYWN0UmVwZWF0ZXIucHJvdG90eXBlLnJlbW92ZUFsbFZpZXdzID0gZnVuY3Rpb24gKHJldHVyblRvQ2FjaGUsIHNraXBBbmltYXRpb24pIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ3N1YmNsYXNzIG11c3QgaW1wbGVtZW50IGByZW1vdmVBbGxWaWV3c2AnKTtcclxuICAgIH07XHJcbiAgICBBYnN0cmFjdFJlcGVhdGVyLnByb3RvdHlwZS5yZW1vdmVWaWV3cyA9IGZ1bmN0aW9uICh2aWV3c1RvUmVtb3ZlLCByZXR1cm5Ub0NhY2hlLCBza2lwQW5pbWF0aW9uKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdzdWJjbGFzcyBtdXN0IGltcGxlbWVudCBgcmVtb3ZlVmlld2AnKTtcclxuICAgIH07XHJcbiAgICBBYnN0cmFjdFJlcGVhdGVyLnByb3RvdHlwZS5yZW1vdmVWaWV3ID0gZnVuY3Rpb24gKGluZGV4LCByZXR1cm5Ub0NhY2hlLCBza2lwQW5pbWF0aW9uKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdzdWJjbGFzcyBtdXN0IGltcGxlbWVudCBgcmVtb3ZlVmlld2AnKTtcclxuICAgIH07XHJcbiAgICBBYnN0cmFjdFJlcGVhdGVyLnByb3RvdHlwZS51cGRhdGVCaW5kaW5ncyA9IGZ1bmN0aW9uICh2aWV3KSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdzdWJjbGFzcyBtdXN0IGltcGxlbWVudCBgdXBkYXRlQmluZGluZ3NgJyk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEFic3RyYWN0UmVwZWF0ZXI7XHJcbn0oKSk7XG5cbnZhciBtYXRjaGVyRXh0cmFjdGlvbk1hcmtlciA9ICdfX21hcmtlcl9leHRyYWN0ZWRfXyc7XHJcbnZhciBSZXBlYXQgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgX19leHRlbmRzKFJlcGVhdCwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIFJlcGVhdCh2aWV3RmFjdG9yeSwgaW5zdHJ1Y3Rpb24sIHZpZXdTbG90LCB2aWV3UmVzb3VyY2VzLCBvYnNlcnZlckxvY2F0b3IsIHN0cmF0ZWd5TG9jYXRvcikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIHtcclxuICAgICAgICAgICAgbG9jYWw6ICdpdGVtJyxcclxuICAgICAgICAgICAgdmlld3NSZXF1aXJlTGlmZWN5Y2xlOiB2aWV3c1JlcXVpcmVMaWZlY3ljbGUodmlld0ZhY3RvcnkpXHJcbiAgICAgICAgfSkgfHwgdGhpcztcclxuICAgICAgICBfdGhpcy52aWV3RmFjdG9yeSA9IHZpZXdGYWN0b3J5O1xyXG4gICAgICAgIF90aGlzLmluc3RydWN0aW9uID0gaW5zdHJ1Y3Rpb247XHJcbiAgICAgICAgX3RoaXMudmlld1Nsb3QgPSB2aWV3U2xvdDtcclxuICAgICAgICBfdGhpcy5sb29rdXBGdW5jdGlvbnMgPSB2aWV3UmVzb3VyY2VzLmxvb2t1cEZ1bmN0aW9ucztcclxuICAgICAgICBfdGhpcy5vYnNlcnZlckxvY2F0b3IgPSBvYnNlcnZlckxvY2F0b3I7XHJcbiAgICAgICAgX3RoaXMua2V5ID0gJ2tleSc7XHJcbiAgICAgICAgX3RoaXMudmFsdWUgPSAndmFsdWUnO1xyXG4gICAgICAgIF90aGlzLnN0cmF0ZWd5TG9jYXRvciA9IHN0cmF0ZWd5TG9jYXRvcjtcclxuICAgICAgICBfdGhpcy5pZ25vcmVNdXRhdGlvbiA9IGZhbHNlO1xyXG4gICAgICAgIF90aGlzLnNvdXJjZUV4cHJlc3Npb24gPSBnZXRJdGVtc1NvdXJjZUV4cHJlc3Npb24oX3RoaXMuaW5zdHJ1Y3Rpb24sICdyZXBlYXQuZm9yJyk7XHJcbiAgICAgICAgX3RoaXMuaXNPbmVUaW1lID0gaXNPbmVUaW1lKF90aGlzLnNvdXJjZUV4cHJlc3Npb24pO1xyXG4gICAgICAgIF90aGlzLnZpZXdzUmVxdWlyZUxpZmVjeWNsZSA9IHZpZXdzUmVxdWlyZUxpZmVjeWNsZSh2aWV3RmFjdG9yeSk7XHJcbiAgICAgICAgcmV0dXJuIF90aGlzO1xyXG4gICAgfVxyXG4gICAgUmVwZWF0XzEgPSBSZXBlYXQ7XHJcbiAgICBSZXBlYXQucHJvdG90eXBlLmNhbGwgPSBmdW5jdGlvbiAoY29udGV4dCwgY2hhbmdlcykge1xyXG4gICAgICAgIHRoaXNbY29udGV4dF0odGhpcy5pdGVtcywgY2hhbmdlcyk7XHJcbiAgICB9O1xyXG4gICAgUmVwZWF0LnByb3RvdHlwZS5iaW5kID0gZnVuY3Rpb24gKGJpbmRpbmdDb250ZXh0LCBvdmVycmlkZUNvbnRleHQpIHtcclxuICAgICAgICB0aGlzLnNjb3BlID0geyBiaW5kaW5nQ29udGV4dDogYmluZGluZ0NvbnRleHQsIG92ZXJyaWRlQ29udGV4dDogb3ZlcnJpZGVDb250ZXh0IH07XHJcbiAgICAgICAgdmFyIGluc3RydWN0aW9uID0gdGhpcy5pbnN0cnVjdGlvbjtcclxuICAgICAgICBpZiAoIShtYXRjaGVyRXh0cmFjdGlvbk1hcmtlciBpbiBpbnN0cnVjdGlvbikpIHtcclxuICAgICAgICAgICAgaW5zdHJ1Y3Rpb25bbWF0Y2hlckV4dHJhY3Rpb25NYXJrZXJdID0gdGhpcy5fY2FwdHVyZUFuZFJlbW92ZU1hdGNoZXJCaW5kaW5nKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMubWF0Y2hlckJpbmRpbmcgPSBpbnN0cnVjdGlvblttYXRjaGVyRXh0cmFjdGlvbk1hcmtlcl07XHJcbiAgICAgICAgdGhpcy5pdGVtc0NoYW5nZWQoKTtcclxuICAgIH07XHJcbiAgICBSZXBlYXQucHJvdG90eXBlLnVuYmluZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLnNjb3BlID0gbnVsbDtcclxuICAgICAgICB0aGlzLml0ZW1zID0gbnVsbDtcclxuICAgICAgICB0aGlzLm1hdGNoZXJCaW5kaW5nID0gbnVsbDtcclxuICAgICAgICB0aGlzLnZpZXdTbG90LnJlbW92ZUFsbCh0cnVlLCB0cnVlKTtcclxuICAgICAgICB0aGlzLl91bnN1YnNjcmliZUNvbGxlY3Rpb24oKTtcclxuICAgIH07XHJcbiAgICBSZXBlYXQucHJvdG90eXBlLl91bnN1YnNjcmliZUNvbGxlY3Rpb24gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuY29sbGVjdGlvbk9ic2VydmVyKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY29sbGVjdGlvbk9ic2VydmVyLnVuc3Vic2NyaWJlKHRoaXMuY2FsbENvbnRleHQsIHRoaXMpO1xyXG4gICAgICAgICAgICB0aGlzLmNvbGxlY3Rpb25PYnNlcnZlciA9IG51bGw7XHJcbiAgICAgICAgICAgIHRoaXMuY2FsbENvbnRleHQgPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBSZXBlYXQucHJvdG90eXBlLml0ZW1zQ2hhbmdlZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMuX3Vuc3Vic2NyaWJlQ29sbGVjdGlvbigpO1xyXG4gICAgICAgIGlmICghdGhpcy5zY29wZSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBpdGVtcyA9IHRoaXMuaXRlbXM7XHJcbiAgICAgICAgdGhpcy5zdHJhdGVneSA9IHRoaXMuc3RyYXRlZ3lMb2NhdG9yLmdldFN0cmF0ZWd5KGl0ZW1zKTtcclxuICAgICAgICBpZiAoIXRoaXMuc3RyYXRlZ3kpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVmFsdWUgZm9yICdcIi5jb25jYXQodGhpcy5zb3VyY2VFeHByZXNzaW9uLCBcIicgaXMgbm9uLXJlcGVhdGFibGVcIikpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIXRoaXMuaXNPbmVUaW1lICYmICF0aGlzLl9vYnNlcnZlSW5uZXJDb2xsZWN0aW9uKCkpIHtcclxuICAgICAgICAgICAgdGhpcy5fb2JzZXJ2ZUNvbGxlY3Rpb24oKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5pZ25vcmVNdXRhdGlvbiA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5zdHJhdGVneS5pbnN0YW5jZUNoYW5nZWQodGhpcywgaXRlbXMpO1xyXG4gICAgICAgIHRoaXMub2JzZXJ2ZXJMb2NhdG9yLnRhc2tRdWV1ZS5xdWV1ZU1pY3JvVGFzayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIF90aGlzLmlnbm9yZU11dGF0aW9uID0gZmFsc2U7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgUmVwZWF0LnByb3RvdHlwZS5fZ2V0SW5uZXJDb2xsZWN0aW9uID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBleHByZXNzaW9uID0gdW53cmFwRXhwcmVzc2lvbih0aGlzLnNvdXJjZUV4cHJlc3Npb24pO1xyXG4gICAgICAgIGlmICghZXhwcmVzc2lvbikge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGV4cHJlc3Npb24uZXZhbHVhdGUodGhpcy5zY29wZSwgbnVsbCk7XHJcbiAgICB9O1xyXG4gICAgUmVwZWF0LnByb3RvdHlwZS5oYW5kbGVDb2xsZWN0aW9uTXV0YXRlZCA9IGZ1bmN0aW9uIChjb2xsZWN0aW9uLCBjaGFuZ2VzKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmNvbGxlY3Rpb25PYnNlcnZlcikge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLmlnbm9yZU11dGF0aW9uKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5zdHJhdGVneS5pbnN0YW5jZU11dGF0ZWQodGhpcywgY29sbGVjdGlvbiwgY2hhbmdlcyk7XHJcbiAgICB9O1xyXG4gICAgUmVwZWF0LnByb3RvdHlwZS5oYW5kbGVJbm5lckNvbGxlY3Rpb25NdXRhdGVkID0gZnVuY3Rpb24gKGNvbGxlY3Rpb24sIGNoYW5nZXMpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIGlmICghdGhpcy5jb2xsZWN0aW9uT2JzZXJ2ZXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5pZ25vcmVNdXRhdGlvbikge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuaWdub3JlTXV0YXRpb24gPSB0cnVlO1xyXG4gICAgICAgIHZhciBuZXdJdGVtcyA9IHRoaXMuc291cmNlRXhwcmVzc2lvbi5ldmFsdWF0ZSh0aGlzLnNjb3BlLCB0aGlzLmxvb2t1cEZ1bmN0aW9ucyk7XHJcbiAgICAgICAgdGhpcy5vYnNlcnZlckxvY2F0b3IudGFza1F1ZXVlLnF1ZXVlTWljcm9UYXNrKGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLmlnbm9yZU11dGF0aW9uID0gZmFsc2U7IH0pO1xyXG4gICAgICAgIGlmIChuZXdJdGVtcyA9PT0gdGhpcy5pdGVtcykge1xyXG4gICAgICAgICAgICB0aGlzLml0ZW1zQ2hhbmdlZCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5pdGVtcyA9IG5ld0l0ZW1zO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBSZXBlYXQucHJvdG90eXBlLl9vYnNlcnZlSW5uZXJDb2xsZWN0aW9uID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBpdGVtcyA9IHRoaXMuX2dldElubmVyQ29sbGVjdGlvbigpO1xyXG4gICAgICAgIHZhciBzdHJhdGVneSA9IHRoaXMuc3RyYXRlZ3lMb2NhdG9yLmdldFN0cmF0ZWd5KGl0ZW1zKTtcclxuICAgICAgICBpZiAoIXN0cmF0ZWd5KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jb2xsZWN0aW9uT2JzZXJ2ZXIgPSBzdHJhdGVneS5nZXRDb2xsZWN0aW9uT2JzZXJ2ZXIodGhpcy5vYnNlcnZlckxvY2F0b3IsIGl0ZW1zKTtcclxuICAgICAgICBpZiAoIXRoaXMuY29sbGVjdGlvbk9ic2VydmVyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jYWxsQ29udGV4dCA9ICdoYW5kbGVJbm5lckNvbGxlY3Rpb25NdXRhdGVkJztcclxuICAgICAgICB0aGlzLmNvbGxlY3Rpb25PYnNlcnZlci5zdWJzY3JpYmUodGhpcy5jYWxsQ29udGV4dCwgdGhpcyk7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9O1xyXG4gICAgUmVwZWF0LnByb3RvdHlwZS5fb2JzZXJ2ZUNvbGxlY3Rpb24gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGl0ZW1zID0gdGhpcy5pdGVtcztcclxuICAgICAgICB0aGlzLmNvbGxlY3Rpb25PYnNlcnZlciA9IHRoaXMuc3RyYXRlZ3kuZ2V0Q29sbGVjdGlvbk9ic2VydmVyKHRoaXMub2JzZXJ2ZXJMb2NhdG9yLCBpdGVtcyk7XHJcbiAgICAgICAgaWYgKHRoaXMuY29sbGVjdGlvbk9ic2VydmVyKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2FsbENvbnRleHQgPSAnaGFuZGxlQ29sbGVjdGlvbk11dGF0ZWQnO1xyXG4gICAgICAgICAgICB0aGlzLmNvbGxlY3Rpb25PYnNlcnZlci5zdWJzY3JpYmUodGhpcy5jYWxsQ29udGV4dCwgdGhpcyk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIFJlcGVhdC5wcm90b3R5cGUuX2NhcHR1cmVBbmRSZW1vdmVNYXRjaGVyQmluZGluZyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgdmlld0ZhY3RvcnkgPSB0aGlzLnZpZXdGYWN0b3J5LnZpZXdGYWN0b3J5O1xyXG4gICAgICAgIGlmICh2aWV3RmFjdG9yeSkge1xyXG4gICAgICAgICAgICB2YXIgdGVtcGxhdGUgPSB2aWV3RmFjdG9yeS50ZW1wbGF0ZTtcclxuICAgICAgICAgICAgdmFyIGluc3RydWN0aW9ucyA9IHZpZXdGYWN0b3J5Lmluc3RydWN0aW9ucztcclxuICAgICAgICAgICAgaWYgKFJlcGVhdF8xLnVzZUlubmVyTWF0Y2hlcikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGV4dHJhY3RNYXRjaGVyQmluZGluZ0V4cHJlc3Npb24oaW5zdHJ1Y3Rpb25zKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoZ2V0Q2hpbGRyZW5Db3VudCh0ZW1wbGF0ZSkgPiAxKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciByZXBlYXRlZEVsZW1lbnQgPSBnZXRGaXJzdEVsZW1lbnRDaGlsZCh0ZW1wbGF0ZSk7XHJcbiAgICAgICAgICAgIGlmICghcmVwZWF0ZWRFbGVtZW50Lmhhc0F0dHJpYnV0ZSgnYXUtdGFyZ2V0LWlkJykpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIHJlcGVhdGVkRWxlbWVudFRhcmdldElkID0gcmVwZWF0ZWRFbGVtZW50LmdldEF0dHJpYnV0ZSgnYXUtdGFyZ2V0LWlkJyk7XHJcbiAgICAgICAgICAgIHJldHVybiBleHRyYWN0TWF0Y2hlckJpbmRpbmdFeHByZXNzaW9uKGluc3RydWN0aW9ucywgcmVwZWF0ZWRFbGVtZW50VGFyZ2V0SWQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgfTtcclxuICAgIFJlcGVhdC5wcm90b3R5cGUudmlld0NvdW50ID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy52aWV3U2xvdC5jaGlsZHJlbi5sZW5ndGg7IH07XHJcbiAgICBSZXBlYXQucHJvdG90eXBlLnZpZXdzID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy52aWV3U2xvdC5jaGlsZHJlbjsgfTtcclxuICAgIFJlcGVhdC5wcm90b3R5cGUudmlldyA9IGZ1bmN0aW9uIChpbmRleCkgeyByZXR1cm4gdGhpcy52aWV3U2xvdC5jaGlsZHJlbltpbmRleF07IH07XHJcbiAgICBSZXBlYXQucHJvdG90eXBlLm1hdGNoZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIG1hdGNoZXJCaW5kaW5nID0gdGhpcy5tYXRjaGVyQmluZGluZztcclxuICAgICAgICByZXR1cm4gbWF0Y2hlckJpbmRpbmdcclxuICAgICAgICAgICAgPyBtYXRjaGVyQmluZGluZy5zb3VyY2VFeHByZXNzaW9uLmV2YWx1YXRlKHRoaXMuc2NvcGUsIG1hdGNoZXJCaW5kaW5nLmxvb2t1cEZ1bmN0aW9ucylcclxuICAgICAgICAgICAgOiBudWxsO1xyXG4gICAgfTtcclxuICAgIFJlcGVhdC5wcm90b3R5cGUuYWRkVmlldyA9IGZ1bmN0aW9uIChiaW5kaW5nQ29udGV4dCwgb3ZlcnJpZGVDb250ZXh0KSB7XHJcbiAgICAgICAgdmFyIHZpZXcgPSB0aGlzLnZpZXdGYWN0b3J5LmNyZWF0ZSgpO1xyXG4gICAgICAgIHZpZXcuYmluZChiaW5kaW5nQ29udGV4dCwgb3ZlcnJpZGVDb250ZXh0KTtcclxuICAgICAgICB0aGlzLnZpZXdTbG90LmFkZCh2aWV3KTtcclxuICAgIH07XHJcbiAgICBSZXBlYXQucHJvdG90eXBlLmluc2VydFZpZXcgPSBmdW5jdGlvbiAoaW5kZXgsIGJpbmRpbmdDb250ZXh0LCBvdmVycmlkZUNvbnRleHQpIHtcclxuICAgICAgICB2YXIgdmlldyA9IHRoaXMudmlld0ZhY3RvcnkuY3JlYXRlKCk7XHJcbiAgICAgICAgdmlldy5iaW5kKGJpbmRpbmdDb250ZXh0LCBvdmVycmlkZUNvbnRleHQpO1xyXG4gICAgICAgIHRoaXMudmlld1Nsb3QuaW5zZXJ0KGluZGV4LCB2aWV3KTtcclxuICAgIH07XHJcbiAgICBSZXBlYXQucHJvdG90eXBlLm1vdmVWaWV3ID0gZnVuY3Rpb24gKHNvdXJjZUluZGV4LCB0YXJnZXRJbmRleCkge1xyXG4gICAgICAgIHRoaXMudmlld1Nsb3QubW92ZShzb3VyY2VJbmRleCwgdGFyZ2V0SW5kZXgpO1xyXG4gICAgfTtcclxuICAgIFJlcGVhdC5wcm90b3R5cGUucmVtb3ZlQWxsVmlld3MgPSBmdW5jdGlvbiAocmV0dXJuVG9DYWNoZSwgc2tpcEFuaW1hdGlvbikge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnZpZXdTbG90LnJlbW92ZUFsbChyZXR1cm5Ub0NhY2hlLCBza2lwQW5pbWF0aW9uKTtcclxuICAgIH07XHJcbiAgICBSZXBlYXQucHJvdG90eXBlLnJlbW92ZVZpZXdzID0gZnVuY3Rpb24gKHZpZXdzVG9SZW1vdmUsIHJldHVyblRvQ2FjaGUsIHNraXBBbmltYXRpb24pIHtcclxuICAgICAgICByZXR1cm4gdGhpcy52aWV3U2xvdC5yZW1vdmVNYW55KHZpZXdzVG9SZW1vdmUsIHJldHVyblRvQ2FjaGUsIHNraXBBbmltYXRpb24pO1xyXG4gICAgfTtcclxuICAgIFJlcGVhdC5wcm90b3R5cGUucmVtb3ZlVmlldyA9IGZ1bmN0aW9uIChpbmRleCwgcmV0dXJuVG9DYWNoZSwgc2tpcEFuaW1hdGlvbikge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnZpZXdTbG90LnJlbW92ZUF0KGluZGV4LCByZXR1cm5Ub0NhY2hlLCBza2lwQW5pbWF0aW9uKTtcclxuICAgIH07XHJcbiAgICBSZXBlYXQucHJvdG90eXBlLnVwZGF0ZUJpbmRpbmdzID0gZnVuY3Rpb24gKHZpZXcpIHtcclxuICAgICAgICB2YXIgJHZpZXcgPSB2aWV3O1xyXG4gICAgICAgIHZhciBqID0gJHZpZXcuYmluZGluZ3MubGVuZ3RoO1xyXG4gICAgICAgIHdoaWxlIChqLS0pIHtcclxuICAgICAgICAgICAgdXBkYXRlT25lVGltZUJpbmRpbmcoJHZpZXcuYmluZGluZ3Nbal0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBqID0gJHZpZXcuY29udHJvbGxlcnMubGVuZ3RoO1xyXG4gICAgICAgIHdoaWxlIChqLS0pIHtcclxuICAgICAgICAgICAgdmFyIGsgPSAkdmlldy5jb250cm9sbGVyc1tqXS5ib3VuZFByb3BlcnRpZXMubGVuZ3RoO1xyXG4gICAgICAgICAgICB3aGlsZSAoay0tKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYmluZGluZyA9ICR2aWV3LmNvbnRyb2xsZXJzW2pdLmJvdW5kUHJvcGVydGllc1trXS5iaW5kaW5nO1xyXG4gICAgICAgICAgICAgICAgdXBkYXRlT25lVGltZUJpbmRpbmcoYmluZGluZyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgdmFyIFJlcGVhdF8xO1xyXG4gICAgUmVwZWF0LnVzZUlubmVyTWF0Y2hlciA9IHRydWU7XHJcbiAgICBfX2RlY29yYXRlKFtcclxuICAgICAgICBiaW5kYWJsZVxyXG4gICAgXSwgUmVwZWF0LnByb3RvdHlwZSwgXCJpdGVtc1wiLCB2b2lkIDApO1xyXG4gICAgX19kZWNvcmF0ZShbXHJcbiAgICAgICAgYmluZGFibGVcclxuICAgIF0sIFJlcGVhdC5wcm90b3R5cGUsIFwibG9jYWxcIiwgdm9pZCAwKTtcclxuICAgIF9fZGVjb3JhdGUoW1xyXG4gICAgICAgIGJpbmRhYmxlXHJcbiAgICBdLCBSZXBlYXQucHJvdG90eXBlLCBcImtleVwiLCB2b2lkIDApO1xyXG4gICAgX19kZWNvcmF0ZShbXHJcbiAgICAgICAgYmluZGFibGVcclxuICAgIF0sIFJlcGVhdC5wcm90b3R5cGUsIFwidmFsdWVcIiwgdm9pZCAwKTtcclxuICAgIFJlcGVhdCA9IFJlcGVhdF8xID0gX19kZWNvcmF0ZShbXHJcbiAgICAgICAgY3VzdG9tQXR0cmlidXRlKCdyZXBlYXQnKSxcclxuICAgICAgICB0ZW1wbGF0ZUNvbnRyb2xsZXIsXHJcbiAgICAgICAgaW5qZWN0KEJvdW5kVmlld0ZhY3RvcnksIFRhcmdldEluc3RydWN0aW9uLCBWaWV3U2xvdCwgVmlld1Jlc291cmNlcywgT2JzZXJ2ZXJMb2NhdG9yLCBSZXBlYXRTdHJhdGVneUxvY2F0b3IpXHJcbiAgICBdLCBSZXBlYXQpO1xyXG4gICAgcmV0dXJuIFJlcGVhdDtcclxufShBYnN0cmFjdFJlcGVhdGVyKSk7XHJcbnZhciBleHRyYWN0TWF0Y2hlckJpbmRpbmdFeHByZXNzaW9uID0gZnVuY3Rpb24gKGluc3RydWN0aW9ucywgdGFyZ2V0ZWRFbGVtZW50SWQpIHtcclxuICAgIHZhciBpbnN0cnVjdGlvbklkcyA9IE9iamVjdC5rZXlzKGluc3RydWN0aW9ucyk7XHJcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGluc3RydWN0aW9uSWRzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgdmFyIGluc3RydWN0aW9uSWQgPSBpbnN0cnVjdGlvbklkc1tpXTtcclxuICAgICAgICBpZiAodGFyZ2V0ZWRFbGVtZW50SWQgIT09IHVuZGVmaW5lZCAmJiBpbnN0cnVjdGlvbklkICE9PSB0YXJnZXRlZEVsZW1lbnRJZCkge1xyXG4gICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGV4cHJlc3Npb25zID0gaW5zdHJ1Y3Rpb25zW2luc3RydWN0aW9uSWRdLmV4cHJlc3Npb25zO1xyXG4gICAgICAgIGlmIChleHByZXNzaW9ucykge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpaSA9IDA7IGlpIDwgZXhwcmVzc2lvbnMubGVuZ3RoOyBpaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZXhwcmVzc2lvbnNbaWldLnRhcmdldFByb3BlcnR5ID09PSAnbWF0Y2hlcicpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgbWF0Y2hlckJpbmRpbmdFeHByZXNzaW9uID0gZXhwcmVzc2lvbnNbaWldO1xyXG4gICAgICAgICAgICAgICAgICAgIGV4cHJlc3Npb25zLnNwbGljZShpaSwgMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1hdGNoZXJCaW5kaW5nRXhwcmVzc2lvbjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufTtcclxudmFyIGdldENoaWxkcmVuQ291bnQgPSBmdW5jdGlvbiAoZWwpIHtcclxuICAgIHZhciBjaGlsZE5vZGVzID0gZWwuY2hpbGROb2RlcztcclxuICAgIHZhciBjb3VudCA9IDA7XHJcbiAgICBmb3IgKHZhciBpID0gMCwgaWkgPSBjaGlsZE5vZGVzLmxlbmd0aDsgaWkgPiBpOyArK2kpIHtcclxuICAgICAgICBpZiAoY2hpbGROb2Rlc1tpXS5ub2RlVHlwZSA9PT0gMSkge1xyXG4gICAgICAgICAgICArK2NvdW50O1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBjb3VudDtcclxufTtcclxudmFyIGdldEZpcnN0RWxlbWVudENoaWxkID0gZnVuY3Rpb24gKGVsKSB7XHJcbiAgICB2YXIgZmlyc3RDaGlsZCA9IGVsLmZpcnN0Q2hpbGQ7XHJcbiAgICB3aGlsZSAoZmlyc3RDaGlsZCAhPT0gbnVsbCkge1xyXG4gICAgICAgIGlmIChmaXJzdENoaWxkLm5vZGVUeXBlID09PSAxKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmaXJzdENoaWxkO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmaXJzdENoaWxkID0gZmlyc3RDaGlsZC5uZXh0U2libGluZztcclxuICAgIH1cclxuICAgIHJldHVybiBudWxsO1xyXG59O1xuXG52YXIgYXVyZWxpYUhpZGVDbGFzc05hbWUgPSAnYXVyZWxpYS1oaWRlJztcclxudmFyIGF1cmVsaWFIaWRlQ2xhc3MgPSBcIi5cIi5jb25jYXQoYXVyZWxpYUhpZGVDbGFzc05hbWUsIFwiIHsgZGlzcGxheTpub25lICFpbXBvcnRhbnQ7IH1cIik7XHJcbmZ1bmN0aW9uIGluamVjdEF1cmVsaWFIaWRlU3R5bGVBdEhlYWQoKSB7XHJcbiAgICBET00uaW5qZWN0U3R5bGVzKGF1cmVsaWFIaWRlQ2xhc3MpO1xyXG59XHJcbmZ1bmN0aW9uIGluamVjdEF1cmVsaWFIaWRlU3R5bGVBdEJvdW5kYXJ5KGRvbUJvdW5kYXJ5KSB7XHJcbiAgICBpZiAoRkVBVFVSRS5zaGFkb3dET00gJiYgZG9tQm91bmRhcnkgJiYgIWRvbUJvdW5kYXJ5Lmhhc0F1cmVsaWFIaWRlU3R5bGUpIHtcclxuICAgICAgICBkb21Cb3VuZGFyeS5oYXNBdXJlbGlhSGlkZVN0eWxlID0gdHJ1ZTtcclxuICAgICAgICBET00uaW5qZWN0U3R5bGVzKGF1cmVsaWFIaWRlQ2xhc3MsIGRvbUJvdW5kYXJ5KTtcclxuICAgIH1cclxufVxuXG52YXIgU2hvdyA9IChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBTaG93KGVsZW1lbnQsIGFuaW1hdG9yLCBkb21Cb3VuZGFyeSkge1xyXG4gICAgICAgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XHJcbiAgICAgICAgdGhpcy5hbmltYXRvciA9IGFuaW1hdG9yO1xyXG4gICAgICAgIHRoaXMuZG9tQm91bmRhcnkgPSBkb21Cb3VuZGFyeTtcclxuICAgIH1cclxuICAgIFNob3cuaW5qZWN0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiBbRE9NLkVsZW1lbnQsIEFuaW1hdG9yLCBPcHRpb25hbC5vZihET00uYm91bmRhcnksIHRydWUpXTtcclxuICAgIH07XHJcbiAgICBTaG93LnByb3RvdHlwZS5jcmVhdGVkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGluamVjdEF1cmVsaWFIaWRlU3R5bGVBdEJvdW5kYXJ5KHRoaXMuZG9tQm91bmRhcnkpO1xyXG4gICAgfTtcclxuICAgIFNob3cucHJvdG90eXBlLnZhbHVlQ2hhbmdlZCA9IGZ1bmN0aW9uIChuZXdWYWx1ZSkge1xyXG4gICAgICAgIHZhciBlbGVtZW50ID0gdGhpcy5lbGVtZW50O1xyXG4gICAgICAgIHZhciBhbmltYXRvciA9IHRoaXMuYW5pbWF0b3I7XHJcbiAgICAgICAgaWYgKG5ld1ZhbHVlKSB7XHJcbiAgICAgICAgICAgIGFuaW1hdG9yLnJlbW92ZUNsYXNzKGVsZW1lbnQsIGF1cmVsaWFIaWRlQ2xhc3NOYW1lKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGFuaW1hdG9yLmFkZENsYXNzKGVsZW1lbnQsIGF1cmVsaWFIaWRlQ2xhc3NOYW1lKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgU2hvdy5wcm90b3R5cGUuYmluZCA9IGZ1bmN0aW9uIChiaW5kaW5nQ29udGV4dCkge1xyXG4gICAgICAgIHRoaXMudmFsdWVDaGFuZ2VkKHRoaXMudmFsdWUpO1xyXG4gICAgfTtcclxuICAgIFNob3cgPSBfX2RlY29yYXRlKFtcclxuICAgICAgICBjdXN0b21BdHRyaWJ1dGUoJ3Nob3cnKVxyXG4gICAgXSwgU2hvdyk7XHJcbiAgICByZXR1cm4gU2hvdztcclxufSgpKTtcblxudmFyIEhpZGUgPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gSGlkZShlbGVtZW50LCBhbmltYXRvciwgZG9tQm91bmRhcnkpIHtcclxuICAgICAgICB0aGlzLmVsZW1lbnQgPSBlbGVtZW50O1xyXG4gICAgICAgIHRoaXMuYW5pbWF0b3IgPSBhbmltYXRvcjtcclxuICAgICAgICB0aGlzLmRvbUJvdW5kYXJ5ID0gZG9tQm91bmRhcnk7XHJcbiAgICB9XHJcbiAgICBIaWRlLmluamVjdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gW0RPTS5FbGVtZW50LCBBbmltYXRvciwgT3B0aW9uYWwub2YoRE9NLmJvdW5kYXJ5LCB0cnVlKV07XHJcbiAgICB9O1xyXG4gICAgSGlkZS5wcm90b3R5cGUuY3JlYXRlZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpbmplY3RBdXJlbGlhSGlkZVN0eWxlQXRCb3VuZGFyeSh0aGlzLmRvbUJvdW5kYXJ5KTtcclxuICAgIH07XHJcbiAgICBIaWRlLnByb3RvdHlwZS52YWx1ZUNoYW5nZWQgPSBmdW5jdGlvbiAobmV3VmFsdWUpIHtcclxuICAgICAgICBpZiAobmV3VmFsdWUpIHtcclxuICAgICAgICAgICAgdGhpcy5hbmltYXRvci5hZGRDbGFzcyh0aGlzLmVsZW1lbnQsIGF1cmVsaWFIaWRlQ2xhc3NOYW1lKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuYW5pbWF0b3IucmVtb3ZlQ2xhc3ModGhpcy5lbGVtZW50LCBhdXJlbGlhSGlkZUNsYXNzTmFtZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIEhpZGUucHJvdG90eXBlLmJpbmQgPSBmdW5jdGlvbiAoYmluZGluZ0NvbnRleHQpIHtcclxuICAgICAgICB0aGlzLnZhbHVlQ2hhbmdlZCh0aGlzLnZhbHVlKTtcclxuICAgIH07XHJcbiAgICBIaWRlLnByb3RvdHlwZS52YWx1ZSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcignTWV0aG9kIG5vdCBpbXBsZW1lbnRlZC4nKTtcclxuICAgIH07XHJcbiAgICBIaWRlID0gX19kZWNvcmF0ZShbXHJcbiAgICAgICAgY3VzdG9tQXR0cmlidXRlKCdoaWRlJylcclxuICAgIF0sIEhpZGUpO1xyXG4gICAgcmV0dXJuIEhpZGU7XHJcbn0oKSk7XG5cbnZhciBIVE1MU2FuaXRpemVyID0gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEhUTUxTYW5pdGl6ZXIoKSB7XHJcbiAgICB9XHJcbiAgICBIVE1MU2FuaXRpemVyLnByb3RvdHlwZS5zYW5pdGl6ZSA9IGZ1bmN0aW9uIChpbnB1dCkge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIlRvIHByb3RlY3QgdGhlIGFwcGxpY2F0aW9uIGFnYWluc3QgYSB3aWRlIHZhcmlldHkgb2Ygc29waGlzdGljYXRlZCBYU1MgYXR0YWNrcy5cXG5QbGVhc2Ugc2VlIGh0dHBzOi8vYXVyZWxpYS5pby9kb2NzL2JpbmRpbmcvYmFzaWNzI2VsZW1lbnQtY29udGVudCBmb3IgaW5zdHJ1Y3Rpb25zIG9uIGhvdyB0byB1c2UgYSBzZWN1cmUgc29sdXRpb24gbGlrZSBET01QdXJpZnkgb3Igc2FuaXRpemUtaHRtbC5cIik7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEhUTUxTYW5pdGl6ZXI7XHJcbn0oKSk7XG5cbnZhciBTYW5pdGl6ZUhUTUxWYWx1ZUNvbnZlcnRlciA9IChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBTYW5pdGl6ZUhUTUxWYWx1ZUNvbnZlcnRlcihzYW5pdGl6ZXIpIHtcclxuICAgICAgICB0aGlzLnNhbml0aXplciA9IHNhbml0aXplcjtcclxuICAgIH1cclxuICAgIFNhbml0aXplSFRNTFZhbHVlQ29udmVydGVyLnByb3RvdHlwZS50b1ZpZXcgPSBmdW5jdGlvbiAodW50cnVzdGVkTWFya3VwKSB7XHJcbiAgICAgICAgaWYgKHVudHJ1c3RlZE1hcmt1cCA9PT0gbnVsbCB8fCB1bnRydXN0ZWRNYXJrdXAgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc2FuaXRpemVyLnNhbml0aXplKHVudHJ1c3RlZE1hcmt1cCk7XHJcbiAgICB9O1xyXG4gICAgU2FuaXRpemVIVE1MVmFsdWVDb252ZXJ0ZXIgPSBfX2RlY29yYXRlKFtcclxuICAgICAgICB2YWx1ZUNvbnZlcnRlcignc2FuaXRpemVIVE1MJyksXHJcbiAgICAgICAgaW5qZWN0KEhUTUxTYW5pdGl6ZXIpXHJcbiAgICBdLCBTYW5pdGl6ZUhUTUxWYWx1ZUNvbnZlcnRlcik7XHJcbiAgICByZXR1cm4gU2FuaXRpemVIVE1MVmFsdWVDb252ZXJ0ZXI7XHJcbn0oKSk7XG5cbnZhciBSZXBsYWNlYWJsZSA9IChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBSZXBsYWNlYWJsZSh2aWV3RmFjdG9yeSwgdmlld1Nsb3QpIHtcclxuICAgICAgICB0aGlzLnZpZXdGYWN0b3J5ID0gdmlld0ZhY3Rvcnk7XHJcbiAgICAgICAgdGhpcy52aWV3U2xvdCA9IHZpZXdTbG90O1xyXG4gICAgICAgIHRoaXMudmlldyA9IG51bGw7XHJcbiAgICB9XHJcbiAgICBSZXBsYWNlYWJsZS5wcm90b3R5cGUuYmluZCA9IGZ1bmN0aW9uIChiaW5kaW5nQ29udGV4dCwgb3ZlcnJpZGVDb250ZXh0KSB7XHJcbiAgICAgICAgaWYgKHRoaXMudmlldyA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aGlzLnZpZXcgPSB0aGlzLnZpZXdGYWN0b3J5LmNyZWF0ZSgpO1xyXG4gICAgICAgICAgICB0aGlzLnZpZXdTbG90LmFkZCh0aGlzLnZpZXcpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnZpZXcuYmluZChiaW5kaW5nQ29udGV4dCwgb3ZlcnJpZGVDb250ZXh0KTtcclxuICAgIH07XHJcbiAgICBSZXBsYWNlYWJsZS5wcm90b3R5cGUudW5iaW5kID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMudmlldy51bmJpbmQoKTtcclxuICAgIH07XHJcbiAgICBSZXBsYWNlYWJsZSA9IF9fZGVjb3JhdGUoW1xyXG4gICAgICAgIGN1c3RvbUF0dHJpYnV0ZSgncmVwbGFjZWFibGUnKSxcclxuICAgICAgICB0ZW1wbGF0ZUNvbnRyb2xsZXIsXHJcbiAgICAgICAgaW5qZWN0KEJvdW5kVmlld0ZhY3RvcnksIFZpZXdTbG90KVxyXG4gICAgXSwgUmVwbGFjZWFibGUpO1xyXG4gICAgcmV0dXJuIFJlcGxhY2VhYmxlO1xyXG59KCkpO1xuXG52YXIgRm9jdXMgPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRm9jdXMoZWxlbWVudCwgdGFza1F1ZXVlKSB7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDtcclxuICAgICAgICB0aGlzLnRhc2tRdWV1ZSA9IHRhc2tRdWV1ZTtcclxuICAgICAgICB0aGlzLmlzQXR0YWNoZWQgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLm5lZWRzQXBwbHkgPSBmYWxzZTtcclxuICAgIH1cclxuICAgIEZvY3VzLmluamVjdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gW0RPTS5FbGVtZW50LCBUYXNrUXVldWVdO1xyXG4gICAgfTtcclxuICAgIEZvY3VzLnByb3RvdHlwZS52YWx1ZUNoYW5nZWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuaXNBdHRhY2hlZCkge1xyXG4gICAgICAgICAgICB0aGlzLl9hcHBseSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5uZWVkc0FwcGx5ID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgRm9jdXMucHJvdG90eXBlLl9hcHBseSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIGlmICh0aGlzLnZhbHVlKSB7XHJcbiAgICAgICAgICAgIHRoaXMudGFza1F1ZXVlLnF1ZXVlTWljcm9UYXNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGlmIChfdGhpcy52YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIF90aGlzLmVsZW1lbnQuZm9jdXMoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQuYmx1cigpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBGb2N1cy5wcm90b3R5cGUuYXR0YWNoZWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5pc0F0dGFjaGVkID0gdHJ1ZTtcclxuICAgICAgICBpZiAodGhpcy5uZWVkc0FwcGx5KSB7XHJcbiAgICAgICAgICAgIHRoaXMubmVlZHNBcHBseSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB0aGlzLl9hcHBseSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZm9jdXMnLCB0aGlzKTtcclxuICAgICAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignYmx1cicsIHRoaXMpO1xyXG4gICAgfTtcclxuICAgIEZvY3VzLnByb3RvdHlwZS5kZXRhY2hlZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLmlzQXR0YWNoZWQgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignZm9jdXMnLCB0aGlzKTtcclxuICAgICAgICB0aGlzLmVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignYmx1cicsIHRoaXMpO1xyXG4gICAgfTtcclxuICAgIEZvY3VzLnByb3RvdHlwZS5oYW5kbGVFdmVudCA9IGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgaWYgKGUudHlwZSA9PT0gJ2ZvY3VzJykge1xyXG4gICAgICAgICAgICB0aGlzLnZhbHVlID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoRE9NLmFjdGl2ZUVsZW1lbnQgIT09IHRoaXMuZWxlbWVudCkge1xyXG4gICAgICAgICAgICB0aGlzLnZhbHVlID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIEZvY3VzID0gX19kZWNvcmF0ZShbXHJcbiAgICAgICAgY3VzdG9tQXR0cmlidXRlKCdmb2N1cycsIGJpbmRpbmdNb2RlLnR3b1dheSlcclxuICAgIF0sIEZvY3VzKTtcclxuICAgIHJldHVybiBGb2N1cztcclxufSgpKTtcblxudmFyIGNzc1VybE1hdGNoZXIgPSAvdXJsXFwoKD8hWydcIl1kYXRhKShbXildKylcXCkvZ2k7XHJcbmZ1bmN0aW9uIGZpeHVwQ1NTVXJscyhhZGRyZXNzLCBjc3MpIHtcclxuICAgIGlmICh0eXBlb2YgY3NzICE9PSAnc3RyaW5nJykge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIkZhaWxlZCBsb2FkaW5nIHJlcXVpcmVkIENTUyBmaWxlOiBcIi5jb25jYXQoYWRkcmVzcykpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGNzcy5yZXBsYWNlKGNzc1VybE1hdGNoZXIsIGZ1bmN0aW9uIChtYXRjaCwgcDEpIHtcclxuICAgICAgICB2YXIgcXVvdGUgPSBwMS5jaGFyQXQoMCk7XHJcbiAgICAgICAgaWYgKHF1b3RlID09PSAnXFwnJyB8fCBxdW90ZSA9PT0gJ1wiJykge1xyXG4gICAgICAgICAgICBwMSA9IHAxLnN1YnN0cigxLCBwMS5sZW5ndGggLSAyKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuICd1cmwoXFwnJyArIHJlbGF0aXZlVG9GaWxlKHAxLCBhZGRyZXNzKSArICdcXCcpJztcclxuICAgIH0pO1xyXG59XHJcbnZhciBDU1NSZXNvdXJjZSA9IChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBDU1NSZXNvdXJjZShhZGRyZXNzKSB7XHJcbiAgICAgICAgdGhpcy5hZGRyZXNzID0gYWRkcmVzcztcclxuICAgICAgICB0aGlzLl9zY29wZWQgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuX2dsb2JhbCA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuX2FscmVhZHlHbG9iYWxseUluamVjdGVkID0gZmFsc2U7XHJcbiAgICB9XHJcbiAgICBDU1NSZXNvdXJjZS5wcm90b3R5cGUuaW5pdGlhbGl6ZSA9IGZ1bmN0aW9uIChjb250YWluZXIsIFRhcmdldCkge1xyXG4gICAgICAgIHRoaXMuX3Njb3BlZCA9IG5ldyBUYXJnZXQodGhpcyk7XHJcbiAgICB9O1xyXG4gICAgQ1NTUmVzb3VyY2UucHJvdG90eXBlLnJlZ2lzdGVyID0gZnVuY3Rpb24gKHJlZ2lzdHJ5LCBuYW1lKSB7XHJcbiAgICAgICAgaWYgKG5hbWUgPT09ICdzY29wZWQnKSB7XHJcbiAgICAgICAgICAgIHJlZ2lzdHJ5LnJlZ2lzdGVyVmlld0VuZ2luZUhvb2tzKHRoaXMuX3Njb3BlZCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl9nbG9iYWwgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBDU1NSZXNvdXJjZS5wcm90b3R5cGUubG9hZCA9IGZ1bmN0aW9uIChjb250YWluZXIpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiBjb250YWluZXIuZ2V0KExvYWRlcilcclxuICAgICAgICAgICAgLmxvYWRUZXh0KHRoaXMuYWRkcmVzcylcclxuICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uICgpIHsgcmV0dXJuIG51bGw7IH0pXHJcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICh0ZXh0KSB7XHJcbiAgICAgICAgICAgIHRleHQgPSBmaXh1cENTU1VybHMoX3RoaXMuYWRkcmVzcywgdGV4dCk7XHJcbiAgICAgICAgICAgIF90aGlzLl9zY29wZWQuY3NzID0gdGV4dDtcclxuICAgICAgICAgICAgaWYgKF90aGlzLl9nbG9iYWwpIHtcclxuICAgICAgICAgICAgICAgIF90aGlzLl9hbHJlYWR5R2xvYmFsbHlJbmplY3RlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBET00uaW5qZWN0U3R5bGVzKHRleHQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcztcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gQ1NTUmVzb3VyY2U7XHJcbn0oKSk7XHJcbnZhciBDU1NWaWV3RW5naW5lSG9va3MgPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gQ1NTVmlld0VuZ2luZUhvb2tzKG93bmVyKSB7XHJcbiAgICAgICAgdGhpcy5vd25lciA9IG93bmVyO1xyXG4gICAgICAgIHRoaXMuY3NzID0gbnVsbDtcclxuICAgIH1cclxuICAgIENTU1ZpZXdFbmdpbmVIb29rcy5wcm90b3R5cGUuYmVmb3JlQ29tcGlsZSA9IGZ1bmN0aW9uIChjb250ZW50LCByZXNvdXJjZXMsIGluc3RydWN0aW9uKSB7XHJcbiAgICAgICAgaWYgKGluc3RydWN0aW9uLnRhcmdldFNoYWRvd0RPTSkge1xyXG4gICAgICAgICAgICBET00uaW5qZWN0U3R5bGVzKHRoaXMuY3NzLCBjb250ZW50LCB0cnVlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoRkVBVFVSRS5zY29wZWRDU1MpIHtcclxuICAgICAgICAgICAgdmFyIHN0eWxlTm9kZSA9IERPTS5pbmplY3RTdHlsZXModGhpcy5jc3MsIGNvbnRlbnQsIHRydWUpO1xyXG4gICAgICAgICAgICBzdHlsZU5vZGUuc2V0QXR0cmlidXRlKCdzY29wZWQnLCAnc2NvcGVkJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHRoaXMuX2dsb2JhbCAmJiAhdGhpcy5vd25lci5fYWxyZWFkeUdsb2JhbGx5SW5qZWN0ZWQpIHtcclxuICAgICAgICAgICAgRE9NLmluamVjdFN0eWxlcyh0aGlzLmNzcyk7XHJcbiAgICAgICAgICAgIHRoaXMub3duZXIuX2FscmVhZHlHbG9iYWxseUluamVjdGVkID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIENTU1ZpZXdFbmdpbmVIb29rcztcclxufSgpKTtcclxuZnVuY3Rpb24gX2NyZWF0ZUNTU1Jlc291cmNlKGFkZHJlc3MpIHtcclxuICAgIHZhciBWaWV3Q1NTID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgICAgICBfX2V4dGVuZHMoVmlld0NTUywgX3N1cGVyKTtcclxuICAgICAgICBmdW5jdGlvbiBWaWV3Q1NTKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFZpZXdDU1MgPSBfX2RlY29yYXRlKFtcclxuICAgICAgICAgICAgcmVzb3VyY2UobmV3IENTU1Jlc291cmNlKGFkZHJlc3MpKVxyXG4gICAgICAgIF0sIFZpZXdDU1MpO1xyXG4gICAgICAgIHJldHVybiBWaWV3Q1NTO1xyXG4gICAgfShDU1NWaWV3RW5naW5lSG9va3MpKTtcclxuICAgIHJldHVybiBWaWV3Q1NTO1xyXG59XG5cbnZhciBBdHRyQmluZGluZ0JlaGF2aW9yID0gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEF0dHJCaW5kaW5nQmVoYXZpb3IoKSB7XHJcbiAgICB9XHJcbiAgICBBdHRyQmluZGluZ0JlaGF2aW9yLnByb3RvdHlwZS5iaW5kID0gZnVuY3Rpb24gKGJpbmRpbmcsIHNvdXJjZSkge1xyXG4gICAgICAgIGJpbmRpbmcudGFyZ2V0T2JzZXJ2ZXIgPSBuZXcgRGF0YUF0dHJpYnV0ZU9ic2VydmVyKGJpbmRpbmcudGFyZ2V0LCBiaW5kaW5nLnRhcmdldFByb3BlcnR5KTtcclxuICAgIH07XHJcbiAgICBBdHRyQmluZGluZ0JlaGF2aW9yLnByb3RvdHlwZS51bmJpbmQgPSBmdW5jdGlvbiAoYmluZGluZywgc291cmNlKSB7XHJcbiAgICB9O1xyXG4gICAgQXR0ckJpbmRpbmdCZWhhdmlvciA9IF9fZGVjb3JhdGUoW1xyXG4gICAgICAgIGJpbmRpbmdCZWhhdmlvcignYXR0cicpXHJcbiAgICBdLCBBdHRyQmluZGluZ0JlaGF2aW9yKTtcclxuICAgIHJldHVybiBBdHRyQmluZGluZ0JlaGF2aW9yO1xyXG59KCkpO1xuXG52YXIgbW9kZUJpbmRpbmdCZWhhdmlvciA9IHtcclxuICAgIGJpbmQ6IGZ1bmN0aW9uIChiaW5kaW5nLCBzb3VyY2UsIGxvb2t1cEZ1bmN0aW9ucykge1xyXG4gICAgICAgIGJpbmRpbmcub3JpZ2luYWxNb2RlID0gYmluZGluZy5tb2RlO1xyXG4gICAgICAgIGJpbmRpbmcubW9kZSA9IHRoaXMubW9kZTtcclxuICAgIH0sXHJcbiAgICB1bmJpbmQ6IGZ1bmN0aW9uIChiaW5kaW5nLCBzb3VyY2UpIHtcclxuICAgICAgICBiaW5kaW5nLm1vZGUgPSBiaW5kaW5nLm9yaWdpbmFsTW9kZTtcclxuICAgICAgICBiaW5kaW5nLm9yaWdpbmFsTW9kZSA9IG51bGw7XHJcbiAgICB9XHJcbn07XHJcbnZhciBPbmVUaW1lQmluZGluZ0JlaGF2aW9yID0gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIE9uZVRpbWVCaW5kaW5nQmVoYXZpb3IoKSB7XHJcbiAgICAgICAgdGhpcy5tb2RlID0gYmluZGluZ01vZGUub25lVGltZTtcclxuICAgIH1cclxuICAgIE9uZVRpbWVCaW5kaW5nQmVoYXZpb3IgPSBfX2RlY29yYXRlKFtcclxuICAgICAgICBtaXhpbihtb2RlQmluZGluZ0JlaGF2aW9yKSxcclxuICAgICAgICBiaW5kaW5nQmVoYXZpb3IoJ29uZVRpbWUnKVxyXG4gICAgXSwgT25lVGltZUJpbmRpbmdCZWhhdmlvcik7XHJcbiAgICByZXR1cm4gT25lVGltZUJpbmRpbmdCZWhhdmlvcjtcclxufSgpKTtcclxudmFyIE9uZVdheUJpbmRpbmdCZWhhdmlvciA9IChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBPbmVXYXlCaW5kaW5nQmVoYXZpb3IoKSB7XHJcbiAgICAgICAgdGhpcy5tb2RlID0gYmluZGluZ01vZGUudG9WaWV3O1xyXG4gICAgfVxyXG4gICAgT25lV2F5QmluZGluZ0JlaGF2aW9yID0gX19kZWNvcmF0ZShbXHJcbiAgICAgICAgbWl4aW4obW9kZUJpbmRpbmdCZWhhdmlvciksXHJcbiAgICAgICAgYmluZGluZ0JlaGF2aW9yKCdvbmVXYXknKVxyXG4gICAgXSwgT25lV2F5QmluZGluZ0JlaGF2aW9yKTtcclxuICAgIHJldHVybiBPbmVXYXlCaW5kaW5nQmVoYXZpb3I7XHJcbn0oKSk7XHJcbnZhciBUb1ZpZXdCaW5kaW5nQmVoYXZpb3IgPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gVG9WaWV3QmluZGluZ0JlaGF2aW9yKCkge1xyXG4gICAgICAgIHRoaXMubW9kZSA9IGJpbmRpbmdNb2RlLnRvVmlldztcclxuICAgIH1cclxuICAgIFRvVmlld0JpbmRpbmdCZWhhdmlvciA9IF9fZGVjb3JhdGUoW1xyXG4gICAgICAgIG1peGluKG1vZGVCaW5kaW5nQmVoYXZpb3IpLFxyXG4gICAgICAgIGJpbmRpbmdCZWhhdmlvcigndG9WaWV3JylcclxuICAgIF0sIFRvVmlld0JpbmRpbmdCZWhhdmlvcik7XHJcbiAgICByZXR1cm4gVG9WaWV3QmluZGluZ0JlaGF2aW9yO1xyXG59KCkpO1xyXG52YXIgRnJvbVZpZXdCaW5kaW5nQmVoYXZpb3IgPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRnJvbVZpZXdCaW5kaW5nQmVoYXZpb3IoKSB7XHJcbiAgICAgICAgdGhpcy5tb2RlID0gYmluZGluZ01vZGUuZnJvbVZpZXc7XHJcbiAgICB9XHJcbiAgICBGcm9tVmlld0JpbmRpbmdCZWhhdmlvciA9IF9fZGVjb3JhdGUoW1xyXG4gICAgICAgIG1peGluKG1vZGVCaW5kaW5nQmVoYXZpb3IpLFxyXG4gICAgICAgIGJpbmRpbmdCZWhhdmlvcignZnJvbVZpZXcnKVxyXG4gICAgXSwgRnJvbVZpZXdCaW5kaW5nQmVoYXZpb3IpO1xyXG4gICAgcmV0dXJuIEZyb21WaWV3QmluZGluZ0JlaGF2aW9yO1xyXG59KCkpO1xyXG52YXIgVHdvV2F5QmluZGluZ0JlaGF2aW9yID0gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFR3b1dheUJpbmRpbmdCZWhhdmlvcigpIHtcclxuICAgICAgICB0aGlzLm1vZGUgPSBiaW5kaW5nTW9kZS50d29XYXk7XHJcbiAgICB9XHJcbiAgICBUd29XYXlCaW5kaW5nQmVoYXZpb3IgPSBfX2RlY29yYXRlKFtcclxuICAgICAgICBtaXhpbihtb2RlQmluZGluZ0JlaGF2aW9yKSxcclxuICAgICAgICBiaW5kaW5nQmVoYXZpb3IoJ3R3b1dheScpXHJcbiAgICBdLCBUd29XYXlCaW5kaW5nQmVoYXZpb3IpO1xyXG4gICAgcmV0dXJuIFR3b1dheUJpbmRpbmdCZWhhdmlvcjtcclxufSgpKTtcblxuZnVuY3Rpb24gdGhyb3R0bGUobmV3VmFsdWUpIHtcclxuICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICB2YXIgc3RhdGUgPSB0aGlzLnRocm90dGxlU3RhdGU7XHJcbiAgICB2YXIgZWxhcHNlZCA9ICtuZXcgRGF0ZSgpIC0gc3RhdGUubGFzdDtcclxuICAgIGlmIChlbGFwc2VkID49IHN0YXRlLmRlbGF5KSB7XHJcbiAgICAgICAgY2xlYXJUaW1lb3V0KHN0YXRlLnRpbWVvdXRJZCk7XHJcbiAgICAgICAgc3RhdGUudGltZW91dElkID0gbnVsbDtcclxuICAgICAgICBzdGF0ZS5sYXN0ID0gK25ldyBEYXRlKCk7XHJcbiAgICAgICAgdGhpcy50aHJvdHRsZWRNZXRob2QobmV3VmFsdWUpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIHN0YXRlLm5ld1ZhbHVlID0gbmV3VmFsdWU7XHJcbiAgICBpZiAoc3RhdGUudGltZW91dElkID09PSBudWxsKSB7XHJcbiAgICAgICAgc3RhdGUudGltZW91dElkID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHN0YXRlLnRpbWVvdXRJZCA9IG51bGw7XHJcbiAgICAgICAgICAgIHN0YXRlLmxhc3QgPSArbmV3IERhdGUoKTtcclxuICAgICAgICAgICAgX3RoaXMudGhyb3R0bGVkTWV0aG9kKHN0YXRlLm5ld1ZhbHVlKTtcclxuICAgICAgICB9LCBzdGF0ZS5kZWxheSAtIGVsYXBzZWQpO1xyXG4gICAgfVxyXG59XHJcbnZhciBUaHJvdHRsZUJpbmRpbmdCZWhhdmlvciA9IChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBUaHJvdHRsZUJpbmRpbmdCZWhhdmlvcigpIHtcclxuICAgIH1cclxuICAgIFRocm90dGxlQmluZGluZ0JlaGF2aW9yLnByb3RvdHlwZS5iaW5kID0gZnVuY3Rpb24gKGJpbmRpbmcsIHNvdXJjZSwgZGVsYXkpIHtcclxuICAgICAgICBpZiAoZGVsYXkgPT09IHZvaWQgMCkgeyBkZWxheSA9IDIwMDsgfVxyXG4gICAgICAgIHZhciBtZXRob2RUb1Rocm90dGxlID0gJ3VwZGF0ZVRhcmdldCc7XHJcbiAgICAgICAgaWYgKGJpbmRpbmcuY2FsbFNvdXJjZSkge1xyXG4gICAgICAgICAgICBtZXRob2RUb1Rocm90dGxlID0gJ2NhbGxTb3VyY2UnO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChiaW5kaW5nLnVwZGF0ZVNvdXJjZSAmJiBiaW5kaW5nLm1vZGUgPT09IGJpbmRpbmdNb2RlLnR3b1dheSkge1xyXG4gICAgICAgICAgICBtZXRob2RUb1Rocm90dGxlID0gJ3VwZGF0ZVNvdXJjZSc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGJpbmRpbmcudGhyb3R0bGVkTWV0aG9kID0gYmluZGluZ1ttZXRob2RUb1Rocm90dGxlXTtcclxuICAgICAgICBiaW5kaW5nLnRocm90dGxlZE1ldGhvZC5vcmlnaW5hbE5hbWUgPSBtZXRob2RUb1Rocm90dGxlO1xyXG4gICAgICAgIGJpbmRpbmdbbWV0aG9kVG9UaHJvdHRsZV0gPSB0aHJvdHRsZTtcclxuICAgICAgICBiaW5kaW5nLnRocm90dGxlU3RhdGUgPSB7XHJcbiAgICAgICAgICAgIGRlbGF5OiBkZWxheSxcclxuICAgICAgICAgICAgbGFzdDogMCxcclxuICAgICAgICAgICAgdGltZW91dElkOiBudWxsXHJcbiAgICAgICAgfTtcclxuICAgIH07XHJcbiAgICBUaHJvdHRsZUJpbmRpbmdCZWhhdmlvci5wcm90b3R5cGUudW5iaW5kID0gZnVuY3Rpb24gKGJpbmRpbmcsIHNvdXJjZSkge1xyXG4gICAgICAgIHZhciBtZXRob2RUb1Jlc3RvcmUgPSBiaW5kaW5nLnRocm90dGxlZE1ldGhvZC5vcmlnaW5hbE5hbWU7XHJcbiAgICAgICAgYmluZGluZ1ttZXRob2RUb1Jlc3RvcmVdID0gYmluZGluZy50aHJvdHRsZWRNZXRob2Q7XHJcbiAgICAgICAgYmluZGluZy50aHJvdHRsZWRNZXRob2QgPSBudWxsO1xyXG4gICAgICAgIGNsZWFyVGltZW91dChiaW5kaW5nLnRocm90dGxlU3RhdGUudGltZW91dElkKTtcclxuICAgICAgICBiaW5kaW5nLnRocm90dGxlU3RhdGUgPSBudWxsO1xyXG4gICAgfTtcclxuICAgIFRocm90dGxlQmluZGluZ0JlaGF2aW9yID0gX19kZWNvcmF0ZShbXHJcbiAgICAgICAgYmluZGluZ0JlaGF2aW9yKCd0aHJvdHRsZScpXHJcbiAgICBdLCBUaHJvdHRsZUJpbmRpbmdCZWhhdmlvcik7XHJcbiAgICByZXR1cm4gVGhyb3R0bGVCaW5kaW5nQmVoYXZpb3I7XHJcbn0oKSk7XG5cbnZhciB1bnNldCA9IHt9O1xyXG5mdW5jdGlvbiBkZWJvdW5jZUNhbGxTb3VyY2UoZXZlbnQpIHtcclxuICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICB2YXIgc3RhdGUgPSB0aGlzLmRlYm91bmNlU3RhdGU7XHJcbiAgICBjbGVhclRpbWVvdXQoc3RhdGUudGltZW91dElkKTtcclxuICAgIHN0YXRlLnRpbWVvdXRJZCA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMuZGVib3VuY2VkTWV0aG9kKGV2ZW50KTsgfSwgc3RhdGUuZGVsYXkpO1xyXG59XHJcbmZ1bmN0aW9uIGRlYm91bmNlQ2FsbChjb250ZXh0LCBuZXdWYWx1ZSwgb2xkVmFsdWUpIHtcclxuICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICB2YXIgc3RhdGUgPSB0aGlzLmRlYm91bmNlU3RhdGU7XHJcbiAgICBjbGVhclRpbWVvdXQoc3RhdGUudGltZW91dElkKTtcclxuICAgIGlmIChjb250ZXh0ICE9PSBzdGF0ZS5jYWxsQ29udGV4dFRvRGVib3VuY2UpIHtcclxuICAgICAgICBzdGF0ZS5vbGRWYWx1ZSA9IHVuc2V0O1xyXG4gICAgICAgIHRoaXMuZGVib3VuY2VkTWV0aG9kKGNvbnRleHQsIG5ld1ZhbHVlLCBvbGRWYWx1ZSk7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgaWYgKHN0YXRlLm9sZFZhbHVlID09PSB1bnNldCkge1xyXG4gICAgICAgIHN0YXRlLm9sZFZhbHVlID0gb2xkVmFsdWU7XHJcbiAgICB9XHJcbiAgICBzdGF0ZS50aW1lb3V0SWQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgX29sZFZhbHVlID0gc3RhdGUub2xkVmFsdWU7XHJcbiAgICAgICAgc3RhdGUub2xkVmFsdWUgPSB1bnNldDtcclxuICAgICAgICBfdGhpcy5kZWJvdW5jZWRNZXRob2QoY29udGV4dCwgbmV3VmFsdWUsIF9vbGRWYWx1ZSk7XHJcbiAgICB9LCBzdGF0ZS5kZWxheSk7XHJcbn1cclxudmFyIERlYm91bmNlQmluZGluZ0JlaGF2aW9yID0gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIERlYm91bmNlQmluZGluZ0JlaGF2aW9yKCkge1xyXG4gICAgfVxyXG4gICAgRGVib3VuY2VCaW5kaW5nQmVoYXZpb3IucHJvdG90eXBlLmJpbmQgPSBmdW5jdGlvbiAoYmluZGluZywgc291cmNlLCBkZWxheSkge1xyXG4gICAgICAgIGlmIChkZWxheSA9PT0gdm9pZCAwKSB7IGRlbGF5ID0gMjAwOyB9XHJcbiAgICAgICAgdmFyIGlzQ2FsbFNvdXJjZSA9IGJpbmRpbmcuY2FsbFNvdXJjZSAhPT0gdW5kZWZpbmVkO1xyXG4gICAgICAgIHZhciBtZXRob2RUb0RlYm91bmNlID0gaXNDYWxsU291cmNlID8gJ2NhbGxTb3VyY2UnIDogJ2NhbGwnO1xyXG4gICAgICAgIHZhciBkZWJvdW5jZXIgPSBpc0NhbGxTb3VyY2UgPyBkZWJvdW5jZUNhbGxTb3VyY2UgOiBkZWJvdW5jZUNhbGw7XHJcbiAgICAgICAgdmFyIG1vZGUgPSBiaW5kaW5nLm1vZGU7XHJcbiAgICAgICAgdmFyIGNhbGxDb250ZXh0VG9EZWJvdW5jZSA9IG1vZGUgPT09IGJpbmRpbmdNb2RlLnR3b1dheSB8fCBtb2RlID09PSBiaW5kaW5nTW9kZS5mcm9tVmlldyA/IHRhcmdldENvbnRleHQgOiBzb3VyY2VDb250ZXh0O1xyXG4gICAgICAgIGJpbmRpbmcuZGVib3VuY2VkTWV0aG9kID0gYmluZGluZ1ttZXRob2RUb0RlYm91bmNlXTtcclxuICAgICAgICBiaW5kaW5nLmRlYm91bmNlZE1ldGhvZC5vcmlnaW5hbE5hbWUgPSBtZXRob2RUb0RlYm91bmNlO1xyXG4gICAgICAgIGJpbmRpbmdbbWV0aG9kVG9EZWJvdW5jZV0gPSBkZWJvdW5jZXI7XHJcbiAgICAgICAgYmluZGluZy5kZWJvdW5jZVN0YXRlID0ge1xyXG4gICAgICAgICAgICBjYWxsQ29udGV4dFRvRGVib3VuY2U6IGNhbGxDb250ZXh0VG9EZWJvdW5jZSxcclxuICAgICAgICAgICAgZGVsYXk6IGRlbGF5LFxyXG4gICAgICAgICAgICB0aW1lb3V0SWQ6IDAsXHJcbiAgICAgICAgICAgIG9sZFZhbHVlOiB1bnNldFxyXG4gICAgICAgIH07XHJcbiAgICB9O1xyXG4gICAgRGVib3VuY2VCaW5kaW5nQmVoYXZpb3IucHJvdG90eXBlLnVuYmluZCA9IGZ1bmN0aW9uIChiaW5kaW5nLCBzb3VyY2UpIHtcclxuICAgICAgICB2YXIgbWV0aG9kVG9SZXN0b3JlID0gYmluZGluZy5kZWJvdW5jZWRNZXRob2Qub3JpZ2luYWxOYW1lO1xyXG4gICAgICAgIGJpbmRpbmdbbWV0aG9kVG9SZXN0b3JlXSA9IGJpbmRpbmcuZGVib3VuY2VkTWV0aG9kO1xyXG4gICAgICAgIGJpbmRpbmcuZGVib3VuY2VkTWV0aG9kID0gbnVsbDtcclxuICAgICAgICBjbGVhclRpbWVvdXQoYmluZGluZy5kZWJvdW5jZVN0YXRlLnRpbWVvdXRJZCk7XHJcbiAgICAgICAgYmluZGluZy5kZWJvdW5jZVN0YXRlID0gbnVsbDtcclxuICAgIH07XHJcbiAgICBEZWJvdW5jZUJpbmRpbmdCZWhhdmlvciA9IF9fZGVjb3JhdGUoW1xyXG4gICAgICAgIGJpbmRpbmdCZWhhdmlvcignZGVib3VuY2UnKVxyXG4gICAgXSwgRGVib3VuY2VCaW5kaW5nQmVoYXZpb3IpO1xyXG4gICAgcmV0dXJuIERlYm91bmNlQmluZGluZ0JlaGF2aW9yO1xyXG59KCkpO1xuXG5mdW5jdGlvbiBmaW5kT3JpZ2luYWxFdmVudFRhcmdldChldmVudCkge1xyXG4gICAgcmV0dXJuIChldmVudC5wYXRoICYmIGV2ZW50LnBhdGhbMF0pIHx8IChldmVudC5kZWVwUGF0aCAmJiBldmVudC5kZWVwUGF0aFswXSkgfHwgZXZlbnQudGFyZ2V0O1xyXG59XHJcbmZ1bmN0aW9uIGhhbmRsZVNlbGZFdmVudChldmVudCkge1xyXG4gICAgdmFyIHRhcmdldCA9IGZpbmRPcmlnaW5hbEV2ZW50VGFyZ2V0KGV2ZW50KTtcclxuICAgIGlmICh0aGlzLnRhcmdldCAhPT0gdGFyZ2V0KSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgdGhpcy5zZWxmRXZlbnRDYWxsU291cmNlKGV2ZW50KTtcclxufVxyXG52YXIgU2VsZkJpbmRpbmdCZWhhdmlvciA9IChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBTZWxmQmluZGluZ0JlaGF2aW9yKCkge1xyXG4gICAgfVxyXG4gICAgU2VsZkJpbmRpbmdCZWhhdmlvci5wcm90b3R5cGUuYmluZCA9IGZ1bmN0aW9uIChiaW5kaW5nLCBzb3VyY2UpIHtcclxuICAgICAgICBpZiAoIWJpbmRpbmcuY2FsbFNvdXJjZSB8fCAhYmluZGluZy50YXJnZXRFdmVudCkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1NlbGYgYmluZGluZyBiZWhhdmlvciBvbmx5IHN1cHBvcnRzIGV2ZW50LicpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBiaW5kaW5nLnNlbGZFdmVudENhbGxTb3VyY2UgPSBiaW5kaW5nLmNhbGxTb3VyY2U7XHJcbiAgICAgICAgYmluZGluZy5jYWxsU291cmNlID0gaGFuZGxlU2VsZkV2ZW50O1xyXG4gICAgfTtcclxuICAgIFNlbGZCaW5kaW5nQmVoYXZpb3IucHJvdG90eXBlLnVuYmluZCA9IGZ1bmN0aW9uIChiaW5kaW5nLCBzb3VyY2UpIHtcclxuICAgICAgICBiaW5kaW5nLmNhbGxTb3VyY2UgPSBiaW5kaW5nLnNlbGZFdmVudENhbGxTb3VyY2U7XHJcbiAgICAgICAgYmluZGluZy5zZWxmRXZlbnRDYWxsU291cmNlID0gbnVsbDtcclxuICAgIH07XHJcbiAgICBTZWxmQmluZGluZ0JlaGF2aW9yID0gX19kZWNvcmF0ZShbXHJcbiAgICAgICAgYmluZGluZ0JlaGF2aW9yKCdzZWxmJylcclxuICAgIF0sIFNlbGZCaW5kaW5nQmVoYXZpb3IpO1xyXG4gICAgcmV0dXJuIFNlbGZCaW5kaW5nQmVoYXZpb3I7XHJcbn0oKSk7XG5cbnZhciBCaW5kaW5nU2lnbmFsZXIgPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gQmluZGluZ1NpZ25hbGVyKCkge1xyXG4gICAgICAgIHRoaXMuc2lnbmFscyA9IHt9O1xyXG4gICAgfVxyXG4gICAgQmluZGluZ1NpZ25hbGVyLnByb3RvdHlwZS5zaWduYWwgPSBmdW5jdGlvbiAobmFtZSkge1xyXG4gICAgICAgIHZhciBiaW5kaW5ncyA9IHRoaXMuc2lnbmFsc1tuYW1lXTtcclxuICAgICAgICBpZiAoIWJpbmRpbmdzKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGkgPSBiaW5kaW5ncy5sZW5ndGg7XHJcbiAgICAgICAgd2hpbGUgKGktLSkge1xyXG4gICAgICAgICAgICBiaW5kaW5nc1tpXS5jYWxsKHNvdXJjZUNvbnRleHQpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICByZXR1cm4gQmluZGluZ1NpZ25hbGVyO1xyXG59KCkpO1xuXG52YXIgU2lnbmFsQmluZGluZ0JlaGF2aW9yID0gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFNpZ25hbEJpbmRpbmdCZWhhdmlvcihiaW5kaW5nU2lnbmFsZXIpIHtcclxuICAgICAgICB0aGlzLnNpZ25hbHMgPSBiaW5kaW5nU2lnbmFsZXIuc2lnbmFscztcclxuICAgIH1cclxuICAgIFNpZ25hbEJpbmRpbmdCZWhhdmlvci5pbmplY3QgPSBmdW5jdGlvbiAoKSB7IHJldHVybiBbQmluZGluZ1NpZ25hbGVyXTsgfTtcclxuICAgIFNpZ25hbEJpbmRpbmdCZWhhdmlvci5wcm90b3R5cGUuYmluZCA9IGZ1bmN0aW9uIChiaW5kaW5nLCBzb3VyY2UpIHtcclxuICAgICAgICB2YXIgbmFtZXMgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDI7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICBuYW1lc1tfaSAtIDJdID0gYXJndW1lbnRzW19pXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCFiaW5kaW5nLnVwZGF0ZVRhcmdldCkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ09ubHkgcHJvcGVydHkgYmluZGluZ3MgYW5kIHN0cmluZyBpbnRlcnBvbGF0aW9uIGJpbmRpbmdzIGNhbiBiZSBzaWduYWxlZC4gIFRyaWdnZXIsIGRlbGVnYXRlIGFuZCBjYWxsIGJpbmRpbmdzIGNhbm5vdCBiZSBzaWduYWxlZC4nKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHNpZ25hbHMgPSB0aGlzLnNpZ25hbHM7XHJcbiAgICAgICAgaWYgKG5hbWVzLmxlbmd0aCA9PT0gMSkge1xyXG4gICAgICAgICAgICB2YXIgbmFtZV8xID0gbmFtZXNbMF07XHJcbiAgICAgICAgICAgIHZhciBiaW5kaW5ncyA9IHNpZ25hbHNbbmFtZV8xXSB8fCAoc2lnbmFsc1tuYW1lXzFdID0gW10pO1xyXG4gICAgICAgICAgICBiaW5kaW5ncy5wdXNoKGJpbmRpbmcpO1xyXG4gICAgICAgICAgICBiaW5kaW5nLnNpZ25hbE5hbWUgPSBuYW1lXzE7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKG5hbWVzLmxlbmd0aCA+IDEpIHtcclxuICAgICAgICAgICAgdmFyIGkgPSBuYW1lcy5sZW5ndGg7XHJcbiAgICAgICAgICAgIHdoaWxlIChpLS0pIHtcclxuICAgICAgICAgICAgICAgIHZhciBuYW1lXzIgPSBuYW1lc1tpXTtcclxuICAgICAgICAgICAgICAgIHZhciBiaW5kaW5ncyA9IHNpZ25hbHNbbmFtZV8yXSB8fCAoc2lnbmFsc1tuYW1lXzJdID0gW10pO1xyXG4gICAgICAgICAgICAgICAgYmluZGluZ3MucHVzaChiaW5kaW5nKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBiaW5kaW5nLnNpZ25hbE5hbWUgPSBuYW1lcztcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignU2lnbmFsIG5hbWUgaXMgcmVxdWlyZWQuJyk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIFNpZ25hbEJpbmRpbmdCZWhhdmlvci5wcm90b3R5cGUudW5iaW5kID0gZnVuY3Rpb24gKGJpbmRpbmcsIHNvdXJjZSkge1xyXG4gICAgICAgIHZhciBzaWduYWxzID0gdGhpcy5zaWduYWxzO1xyXG4gICAgICAgIHZhciBuYW1lID0gYmluZGluZy5zaWduYWxOYW1lO1xyXG4gICAgICAgIGJpbmRpbmcuc2lnbmFsTmFtZSA9IG51bGw7XHJcbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkobmFtZSkpIHtcclxuICAgICAgICAgICAgdmFyIG5hbWVzID0gbmFtZTtcclxuICAgICAgICAgICAgdmFyIGkgPSBuYW1lcy5sZW5ndGg7XHJcbiAgICAgICAgICAgIHdoaWxlIChpLS0pIHtcclxuICAgICAgICAgICAgICAgIHZhciBuID0gbmFtZXNbaV07XHJcbiAgICAgICAgICAgICAgICB2YXIgYmluZGluZ3MgPSBzaWduYWxzW25dO1xyXG4gICAgICAgICAgICAgICAgYmluZGluZ3Muc3BsaWNlKGJpbmRpbmdzLmluZGV4T2YoYmluZGluZyksIDEpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB2YXIgYmluZGluZ3MgPSBzaWduYWxzW25hbWVdO1xyXG4gICAgICAgICAgICBiaW5kaW5ncy5zcGxpY2UoYmluZGluZ3MuaW5kZXhPZihiaW5kaW5nKSwgMSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIFNpZ25hbEJpbmRpbmdCZWhhdmlvciA9IF9fZGVjb3JhdGUoW1xyXG4gICAgICAgIGJpbmRpbmdCZWhhdmlvcignc2lnbmFsJylcclxuICAgIF0sIFNpZ25hbEJpbmRpbmdCZWhhdmlvcik7XHJcbiAgICByZXR1cm4gU2lnbmFsQmluZGluZ0JlaGF2aW9yO1xyXG59KCkpO1xuXG52YXIgZXZlbnROYW1lc1JlcXVpcmVkID0gJ1RoZSB1cGRhdGVUcmlnZ2VyIGJpbmRpbmcgYmVoYXZpb3IgcmVxdWlyZXMgYXQgbGVhc3Qgb25lIGV2ZW50IG5hbWUgYXJndW1lbnQ6IGVnIDxpbnB1dCB2YWx1ZS5iaW5kPVwiZmlyc3ROYW1lICYgdXBkYXRlVHJpZ2dlcjpcXCdibHVyXFwnXCI+JztcclxudmFyIG5vdEFwcGxpY2FibGVNZXNzYWdlID0gJ1RoZSB1cGRhdGVUcmlnZ2VyIGJpbmRpbmcgYmVoYXZpb3IgY2FuIG9ubHkgYmUgYXBwbGllZCB0byB0d28td2F5LyBmcm9tLXZpZXcgYmluZGluZ3Mgb24gaW5wdXQvc2VsZWN0IGVsZW1lbnRzLic7XHJcbnZhciBVcGRhdGVUcmlnZ2VyQmluZGluZ0JlaGF2aW9yID0gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFVwZGF0ZVRyaWdnZXJCaW5kaW5nQmVoYXZpb3IoKSB7XHJcbiAgICB9XHJcbiAgICBVcGRhdGVUcmlnZ2VyQmluZGluZ0JlaGF2aW9yLnByb3RvdHlwZS5iaW5kID0gZnVuY3Rpb24gKGJpbmRpbmcsIHNvdXJjZSkge1xyXG4gICAgICAgIHZhciBldmVudHMgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDI7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICBldmVudHNbX2kgLSAyXSA9IGFyZ3VtZW50c1tfaV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChldmVudHMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihldmVudE5hbWVzUmVxdWlyZWQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoYmluZGluZy5tb2RlICE9PSBiaW5kaW5nTW9kZS50d29XYXkgJiYgYmluZGluZy5tb2RlICE9PSBiaW5kaW5nTW9kZS5mcm9tVmlldykge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3Iobm90QXBwbGljYWJsZU1lc3NhZ2UpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgdGFyZ2V0T2JzZXJ2ZXIgPSBiaW5kaW5nLm9ic2VydmVyTG9jYXRvci5nZXRPYnNlcnZlcihiaW5kaW5nLnRhcmdldCwgYmluZGluZy50YXJnZXRQcm9wZXJ0eSk7XHJcbiAgICAgICAgaWYgKCF0YXJnZXRPYnNlcnZlci5oYW5kbGVyKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihub3RBcHBsaWNhYmxlTWVzc2FnZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGJpbmRpbmcudGFyZ2V0T2JzZXJ2ZXIgPSB0YXJnZXRPYnNlcnZlcjtcclxuICAgICAgICB0YXJnZXRPYnNlcnZlci5vcmlnaW5hbEhhbmRsZXIgPSBiaW5kaW5nLnRhcmdldE9ic2VydmVyLmhhbmRsZXI7XHJcbiAgICAgICAgdmFyIGhhbmRsZXIgPSBuZXcgRXZlbnRTdWJzY3JpYmVyKGV2ZW50cyk7XHJcbiAgICAgICAgdGFyZ2V0T2JzZXJ2ZXIuaGFuZGxlciA9IGhhbmRsZXI7XHJcbiAgICB9O1xyXG4gICAgVXBkYXRlVHJpZ2dlckJpbmRpbmdCZWhhdmlvci5wcm90b3R5cGUudW5iaW5kID0gZnVuY3Rpb24gKGJpbmRpbmcsIHNvdXJjZSkge1xyXG4gICAgICAgIHZhciB0YXJnZXRPYnNlcnZlciA9IGJpbmRpbmcudGFyZ2V0T2JzZXJ2ZXI7XHJcbiAgICAgICAgdGFyZ2V0T2JzZXJ2ZXIuaGFuZGxlci5kaXNwb3NlKCk7XHJcbiAgICAgICAgdGFyZ2V0T2JzZXJ2ZXIuaGFuZGxlciA9IHRhcmdldE9ic2VydmVyLm9yaWdpbmFsSGFuZGxlcjtcclxuICAgICAgICB0YXJnZXRPYnNlcnZlci5vcmlnaW5hbEhhbmRsZXIgPSBudWxsO1xyXG4gICAgfTtcclxuICAgIFVwZGF0ZVRyaWdnZXJCaW5kaW5nQmVoYXZpb3IgPSBfX2RlY29yYXRlKFtcclxuICAgICAgICBiaW5kaW5nQmVoYXZpb3IoJ3VwZGF0ZVRyaWdnZXInKVxyXG4gICAgXSwgVXBkYXRlVHJpZ2dlckJpbmRpbmdCZWhhdmlvcik7XHJcbiAgICByZXR1cm4gVXBkYXRlVHJpZ2dlckJpbmRpbmdCZWhhdmlvcjtcclxufSgpKTtcblxuZnVuY3Rpb24gX2NyZWF0ZUR5bmFtaWNFbGVtZW50KF9hKSB7XHJcbiAgICB2YXIgbmFtZSA9IF9hLm5hbWUsIHZpZXdVcmwgPSBfYS52aWV3VXJsLCBiaW5kYWJsZU5hbWVzID0gX2EuYmluZGFibGVOYW1lcywgdXNlU2hhZG93RE9NbW9kZSA9IF9hLnVzZVNoYWRvd0RPTW1vZGU7XHJcbiAgICB2YXIgRHluYW1pY0VsZW1lbnQgPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGZ1bmN0aW9uIER5bmFtaWNFbGVtZW50KCkge1xyXG4gICAgICAgIH1cclxuICAgICAgICBEeW5hbWljRWxlbWVudC5wcm90b3R5cGUuYmluZCA9IGZ1bmN0aW9uIChiaW5kaW5nQ29udGV4dCkge1xyXG4gICAgICAgICAgICB0aGlzLiRwYXJlbnQgPSBiaW5kaW5nQ29udGV4dDtcclxuICAgICAgICB9O1xyXG4gICAgICAgIER5bmFtaWNFbGVtZW50ID0gX19kZWNvcmF0ZShbXHJcbiAgICAgICAgICAgIGN1c3RvbUVsZW1lbnQobmFtZSksXHJcbiAgICAgICAgICAgIHVzZVZpZXcodmlld1VybClcclxuICAgICAgICBdLCBEeW5hbWljRWxlbWVudCk7XHJcbiAgICAgICAgcmV0dXJuIER5bmFtaWNFbGVtZW50O1xyXG4gICAgfSgpKTtcclxuICAgIGZvciAodmFyIGkgPSAwLCBpaSA9IGJpbmRhYmxlTmFtZXMubGVuZ3RoOyBpIDwgaWk7ICsraSkge1xyXG4gICAgICAgIGJpbmRhYmxlKGJpbmRhYmxlTmFtZXNbaV0pKER5bmFtaWNFbGVtZW50KTtcclxuICAgIH1cclxuICAgIHN3aXRjaCAodXNlU2hhZG93RE9NbW9kZSkge1xyXG4gICAgICAgIGNhc2UgJ29wZW4nOlxyXG4gICAgICAgICAgICB1c2VTaGFkb3dET00oeyBtb2RlOiAnb3BlbicgfSkoRHluYW1pY0VsZW1lbnQpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlICdjbG9zZWQnOlxyXG4gICAgICAgICAgICB1c2VTaGFkb3dET00oeyBtb2RlOiAnY2xvc2VkJyB9KShEeW5hbWljRWxlbWVudCk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgJyc6XHJcbiAgICAgICAgICAgIHVzZVNoYWRvd0RPTShEeW5hbWljRWxlbWVudCk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgbnVsbDpcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgZ2V0TG9nZ2VyKCdhdXJlbGlhLWh0bWwtb25seS1lbGVtZW50JylcclxuICAgICAgICAgICAgICAgIC53YXJuKFwiRXhwZWN0ZWQgJ3VzZS1zaGFkb3ctZG9tJyB2YWx1ZSB0byBiZSBcXFwiY2xvc2VcXFwiLCBcXFwib3BlblxcXCIgb3IgXFxcIlxcXCIsIHJlY2VpdmVkIFwiLmNvbmNhdCh1c2VTaGFkb3dET01tb2RlKSk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIER5bmFtaWNFbGVtZW50O1xyXG59XG5cbmZ1bmN0aW9uIGdldEVsZW1lbnROYW1lKGFkZHJlc3MpIHtcclxuICAgIHJldHVybiAvKFteXFwvXlxcP10rKVxcLmh0bWwvaS5leGVjKGFkZHJlc3MpWzFdLnRvTG93ZXJDYXNlKCk7XHJcbn1cclxuZnVuY3Rpb24gY29uZmlndXJlJDEoY29uZmlnKSB7XHJcbiAgICB2YXIgdmlld0VuZ2luZSA9IGNvbmZpZy5jb250YWluZXIuZ2V0KFZpZXdFbmdpbmUpO1xyXG4gICAgdmFyIGxvYWRlciA9IGNvbmZpZy5hdXJlbGlhLmxvYWRlcjtcclxuICAgIHZpZXdFbmdpbmUuYWRkUmVzb3VyY2VQbHVnaW4oJy5odG1sJywge1xyXG4gICAgICAgICdmZXRjaCc6IGZ1bmN0aW9uICh2aWV3VXJsKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBsb2FkZXIubG9hZFRlbXBsYXRlKHZpZXdVcmwpLnRoZW4oZnVuY3Rpb24gKHJlZ2lzdHJ5RW50cnkpIHtcclxuICAgICAgICAgICAgICAgIHZhciBfYTtcclxuICAgICAgICAgICAgICAgIHZhciBiaW5kYWJsZU5hbWVzID0gcmVnaXN0cnlFbnRyeS50ZW1wbGF0ZS5nZXRBdHRyaWJ1dGUoJ2JpbmRhYmxlJyk7XHJcbiAgICAgICAgICAgICAgICB2YXIgdXNlU2hhZG93RE9NbW9kZSA9IHJlZ2lzdHJ5RW50cnkudGVtcGxhdGUuZ2V0QXR0cmlidXRlKCd1c2Utc2hhZG93LWRvbScpO1xyXG4gICAgICAgICAgICAgICAgdmFyIG5hbWUgPSBnZXRFbGVtZW50TmFtZSh2aWV3VXJsKTtcclxuICAgICAgICAgICAgICAgIGlmIChiaW5kYWJsZU5hbWVzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYmluZGFibGVOYW1lcyA9IGJpbmRhYmxlTmFtZXMuc3BsaXQoJywnKS5tYXAoZnVuY3Rpb24gKHgpIHsgcmV0dXJuIHgudHJpbSgpOyB9KTtcclxuICAgICAgICAgICAgICAgICAgICByZWdpc3RyeUVudHJ5LnRlbXBsYXRlLnJlbW92ZUF0dHJpYnV0ZSgnYmluZGFibGUnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGJpbmRhYmxlTmFtZXMgPSBbXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBfYSA9IHt9LCBfYVtuYW1lXSA9IF9jcmVhdGVEeW5hbWljRWxlbWVudCh7IG5hbWU6IG5hbWUsIHZpZXdVcmw6IHZpZXdVcmwsIGJpbmRhYmxlTmFtZXM6IGJpbmRhYmxlTmFtZXMsIHVzZVNoYWRvd0RPTW1vZGU6IHVzZVNoYWRvd0RPTW1vZGUgfSksIF9hO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxufVxuXG5mdW5jdGlvbiBjb25maWd1cmUoY29uZmlnKSB7XHJcbiAgICBpbmplY3RBdXJlbGlhSGlkZVN0eWxlQXRIZWFkKCk7XHJcbiAgICBjb25maWcuZ2xvYmFsUmVzb3VyY2VzKENvbXBvc2UsIElmLCBFbHNlLCBXaXRoLCBSZXBlYXQsIFNob3csIEhpZGUsIFJlcGxhY2VhYmxlLCBGb2N1cywgU2FuaXRpemVIVE1MVmFsdWVDb252ZXJ0ZXIsIE9uZVRpbWVCaW5kaW5nQmVoYXZpb3IsIE9uZVdheUJpbmRpbmdCZWhhdmlvciwgVG9WaWV3QmluZGluZ0JlaGF2aW9yLCBGcm9tVmlld0JpbmRpbmdCZWhhdmlvciwgVHdvV2F5QmluZGluZ0JlaGF2aW9yLCBUaHJvdHRsZUJpbmRpbmdCZWhhdmlvciwgRGVib3VuY2VCaW5kaW5nQmVoYXZpb3IsIFNlbGZCaW5kaW5nQmVoYXZpb3IsIFNpZ25hbEJpbmRpbmdCZWhhdmlvciwgVXBkYXRlVHJpZ2dlckJpbmRpbmdCZWhhdmlvciwgQXR0ckJpbmRpbmdCZWhhdmlvcik7XHJcbiAgICBjb25maWd1cmUkMShjb25maWcpO1xyXG4gICAgdmFyIHZpZXdFbmdpbmUgPSBjb25maWcuY29udGFpbmVyLmdldChWaWV3RW5naW5lKTtcclxuICAgIHZhciBzdHlsZVJlc291cmNlUGx1Z2luID0ge1xyXG4gICAgICAgIGZldGNoOiBmdW5jdGlvbiAoYWRkcmVzcykge1xyXG4gICAgICAgICAgICB2YXIgX2E7XHJcbiAgICAgICAgICAgIHJldHVybiBfYSA9IHt9LCBfYVthZGRyZXNzXSA9IF9jcmVhdGVDU1NSZXNvdXJjZShhZGRyZXNzKSwgX2E7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIFsnLmNzcycsICcubGVzcycsICcuc2FzcycsICcuc2NzcycsICcuc3R5bCddLmZvckVhY2goZnVuY3Rpb24gKGV4dCkgeyByZXR1cm4gdmlld0VuZ2luZS5hZGRSZXNvdXJjZVBsdWdpbihleHQsIHN0eWxlUmVzb3VyY2VQbHVnaW4pOyB9KTtcclxufVxuXG5leHBvcnQgeyBBYnN0cmFjdFJlcGVhdGVyLCBBcnJheVJlcGVhdFN0cmF0ZWd5LCBBdHRyQmluZGluZ0JlaGF2aW9yLCBCaW5kaW5nU2lnbmFsZXIsIENvbXBvc2UsIERlYm91bmNlQmluZGluZ0JlaGF2aW9yLCBFbHNlLCBGb2N1cywgRnJvbVZpZXdCaW5kaW5nQmVoYXZpb3IsIEhUTUxTYW5pdGl6ZXIsIEhpZGUsIElmLCBNYXBSZXBlYXRTdHJhdGVneSwgTnVsbFJlcGVhdFN0cmF0ZWd5LCBOdW1iZXJSZXBlYXRTdHJhdGVneSwgT25lVGltZUJpbmRpbmdCZWhhdmlvciwgT25lV2F5QmluZGluZ0JlaGF2aW9yLCBSZXBlYXQsIFJlcGVhdFN0cmF0ZWd5TG9jYXRvciwgUmVwbGFjZWFibGUsIFNhbml0aXplSFRNTFZhbHVlQ29udmVydGVyLCBTZWxmQmluZGluZ0JlaGF2aW9yLCBTZXRSZXBlYXRTdHJhdGVneSwgU2hvdywgU2lnbmFsQmluZGluZ0JlaGF2aW9yLCBUaHJvdHRsZUJpbmRpbmdCZWhhdmlvciwgVG9WaWV3QmluZGluZ0JlaGF2aW9yLCBUd29XYXlCaW5kaW5nQmVoYXZpb3IsIFVwZGF0ZVRyaWdnZXJCaW5kaW5nQmVoYXZpb3IsIFdpdGgsIGNvbmZpZ3VyZSwgY3JlYXRlRnVsbE92ZXJyaWRlQ29udGV4dCwgZ2V0SXRlbXNTb3VyY2VFeHByZXNzaW9uLCBpc09uZVRpbWUsIHVud3JhcEV4cHJlc3Npb24sIHVwZGF0ZU9uZVRpbWVCaW5kaW5nLCB1cGRhdGVPdmVycmlkZUNvbnRleHQsIHZpZXdzUmVxdWlyZUxpZmVjeWNsZSB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXVyZWxpYS10ZW1wbGF0aW5nLXJlc291cmNlcy5qcy5tYXBcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///aurelia-templating-resources\n");

/***/ }),

/***/ "aurelia-templating-router":
/*!*************************************************************************************************!*\
  !*** ./node_modules/aurelia-templating-router/dist/native-modules/aurelia-templating-router.js ***!
  \*************************************************************************************************/
/*! exports provided: RouteHref, RouterView, RouterViewLocator, TemplatingRouteLoader, configure */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"RouteHref\", function() { return RouteHref; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"RouterView\", function() { return RouterView; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"RouterViewLocator\", function() { return RouterViewLocator; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"TemplatingRouteLoader\", function() { return TemplatingRouteLoader; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"configure\", function() { return configure; });\n/* harmony import */ var aurelia_router__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! aurelia-router */ \"4ysu\");\n/* harmony import */ var aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! aurelia-metadata */ \"qrcG\");\n/* harmony import */ var aurelia_path__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! aurelia-path */ \"iD3O\");\n/* harmony import */ var aurelia_templating__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! aurelia-templating */ \"hij8\");\n/* harmony import */ var aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! aurelia-dependency-injection */ \"3U8n\");\n/* harmony import */ var aurelia_binding__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! aurelia-binding */ \"X5gX\");\n/* harmony import */ var aurelia_pal__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! aurelia-pal */ \"70NS\");\n/* harmony import */ var aurelia_logging__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! aurelia-logging */ \"MP1E\");\n\n\n\n\n\n\n\n\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nfunction __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\n\nvar EmptyLayoutViewModel = (function () {\r\n    function EmptyLayoutViewModel() {\r\n    }\r\n    return EmptyLayoutViewModel;\r\n}());\r\nvar RouterView = (function () {\r\n    function RouterView(element, container, viewSlot, router, viewLocator, compositionTransaction, compositionEngine) {\r\n        this.element = element;\r\n        this.container = container;\r\n        this.viewSlot = viewSlot;\r\n        this.router = router;\r\n        this.viewLocator = viewLocator;\r\n        this.compositionTransaction = compositionTransaction;\r\n        this.compositionEngine = compositionEngine;\r\n        this.router.registerViewPort(this, this.element.getAttribute('name'));\r\n        if (!('initialComposition' in compositionTransaction)) {\r\n            compositionTransaction.initialComposition = true;\r\n            this.compositionTransactionNotifier = compositionTransaction.enlist();\r\n        }\r\n    }\r\n    RouterView.inject = function () {\r\n        return [aurelia_pal__WEBPACK_IMPORTED_MODULE_6__[\"DOM\"].Element, aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_4__[\"Container\"], aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ViewSlot\"], aurelia_router__WEBPACK_IMPORTED_MODULE_0__[\"Router\"], aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ViewLocator\"], aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"CompositionTransaction\"], aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"CompositionEngine\"]];\r\n    };\r\n    RouterView.prototype.created = function (owningView) {\r\n        this.owningView = owningView;\r\n    };\r\n    RouterView.prototype.bind = function (bindingContext, overrideContext) {\r\n        this.container.viewModel = bindingContext;\r\n        this.overrideContext = overrideContext;\r\n    };\r\n    RouterView.prototype.process = function ($viewPortInstruction, waitToSwap) {\r\n        var _this = this;\r\n        var viewPortInstruction = $viewPortInstruction;\r\n        var component = viewPortInstruction.component;\r\n        var childContainer = component.childContainer;\r\n        var viewModel = component.viewModel;\r\n        var viewModelResource = component.viewModelResource;\r\n        var metadata = viewModelResource.metadata;\r\n        var config = component.router.currentInstruction.config;\r\n        var viewPortConfig = config.viewPorts ? (config.viewPorts[viewPortInstruction.name] || {}) : {};\r\n        childContainer.get(RouterViewLocator)._notify(this);\r\n        var layoutInstruction = {\r\n            viewModel: viewPortConfig.layoutViewModel || config.layoutViewModel || this.layoutViewModel,\r\n            view: viewPortConfig.layoutView || config.layoutView || this.layoutView,\r\n            model: viewPortConfig.layoutModel || config.layoutModel || this.layoutModel,\r\n            router: viewPortInstruction.component.router,\r\n            childContainer: childContainer,\r\n            viewSlot: this.viewSlot\r\n        };\r\n        var viewStrategy = this.viewLocator.getViewStrategy(component.view || viewModel);\r\n        if (viewStrategy && component.view) {\r\n            viewStrategy.makeRelativeTo(aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"Origin\"].get(component.router.container.viewModel.constructor).moduleId);\r\n        }\r\n        return metadata\r\n            .load(childContainer, viewModelResource.value, null, viewStrategy, true)\r\n            .then(function (viewFactory) {\r\n            if (!_this.compositionTransactionNotifier) {\r\n                _this.compositionTransactionOwnershipToken = _this.compositionTransaction.tryCapture();\r\n            }\r\n            if (layoutInstruction.viewModel || layoutInstruction.view) {\r\n                viewPortInstruction.layoutInstruction = layoutInstruction;\r\n            }\r\n            var viewPortComponentBehaviorInstruction = aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"BehaviorInstruction\"].dynamic(_this.element, viewModel, viewFactory);\r\n            viewPortInstruction.controller = metadata.create(childContainer, viewPortComponentBehaviorInstruction);\r\n            if (waitToSwap) {\r\n                return null;\r\n            }\r\n            _this.swap(viewPortInstruction);\r\n        });\r\n    };\r\n    RouterView.prototype.swap = function ($viewPortInstruction) {\r\n        var _this = this;\r\n        var viewPortInstruction = $viewPortInstruction;\r\n        var viewPortController = viewPortInstruction.controller;\r\n        var layoutInstruction = viewPortInstruction.layoutInstruction;\r\n        var previousView = this.view;\r\n        var work = function () {\r\n            var swapStrategy = aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"SwapStrategies\"][_this.swapOrder] || aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"SwapStrategies\"].after;\r\n            var viewSlot = _this.viewSlot;\r\n            swapStrategy(viewSlot, previousView, function () { return Promise.resolve(viewSlot.add(_this.view)); }).then(function () {\r\n                _this._notify();\r\n            });\r\n        };\r\n        var ready = function (owningView_or_layoutView) {\r\n            viewPortController.automate(_this.overrideContext, owningView_or_layoutView);\r\n            var transactionOwnerShipToken = _this.compositionTransactionOwnershipToken;\r\n            if (transactionOwnerShipToken) {\r\n                return transactionOwnerShipToken\r\n                    .waitForCompositionComplete()\r\n                    .then(function () {\r\n                    _this.compositionTransactionOwnershipToken = null;\r\n                    return work();\r\n                });\r\n            }\r\n            return work();\r\n        };\r\n        if (layoutInstruction) {\r\n            if (!layoutInstruction.viewModel) {\r\n                layoutInstruction.viewModel = new EmptyLayoutViewModel();\r\n            }\r\n            return this.compositionEngine\r\n                .createController(layoutInstruction)\r\n                .then(function (layoutController) {\r\n                var layoutView = layoutController.view;\r\n                aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ShadowDOM\"].distributeView(viewPortController.view, layoutController.slots || layoutView.slots);\r\n                layoutController.automate(Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_5__[\"createOverrideContext\"])(layoutInstruction.viewModel), _this.owningView);\r\n                layoutView.children.push(viewPortController.view);\r\n                return layoutView || layoutController;\r\n            })\r\n                .then(function (newView) {\r\n                _this.view = newView;\r\n                return ready(newView);\r\n            });\r\n        }\r\n        this.view = viewPortController.view;\r\n        return ready(this.owningView);\r\n    };\r\n    RouterView.prototype._notify = function () {\r\n        var notifier = this.compositionTransactionNotifier;\r\n        if (notifier) {\r\n            notifier.done();\r\n            this.compositionTransactionNotifier = null;\r\n        }\r\n    };\r\n    RouterView.$view = null;\r\n    RouterView.$resource = {\r\n        name: 'router-view',\r\n        bindables: ['swapOrder', 'layoutView', 'layoutViewModel', 'layoutModel', 'inherit-binding-context']\r\n    };\r\n    return RouterView;\r\n}());\r\nvar RouterViewLocator = (function () {\r\n    function RouterViewLocator() {\r\n        var _this = this;\r\n        this.promise = new Promise(function (resolve) { return _this.resolve = resolve; });\r\n    }\r\n    RouterViewLocator.prototype.findNearest = function () {\r\n        return this.promise;\r\n    };\r\n    RouterViewLocator.prototype._notify = function (routerView) {\r\n        this.resolve(routerView);\r\n    };\r\n    return RouterViewLocator;\r\n}());\n\nvar EmptyClass = (function () {\r\n    function EmptyClass() {\r\n    }\r\n    return EmptyClass;\r\n}());\r\naurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"inlineView\"]('<template></template>')(EmptyClass);\r\nvar TemplatingRouteLoader = (function (_super) {\r\n    __extends(TemplatingRouteLoader, _super);\r\n    function TemplatingRouteLoader(compositionEngine) {\r\n        var _this = _super.call(this) || this;\r\n        _this.compositionEngine = compositionEngine;\r\n        return _this;\r\n    }\r\n    TemplatingRouteLoader.prototype.resolveViewModel = function (router, config) {\r\n        return new Promise(function (resolve, reject) {\r\n            var viewModel;\r\n            if ('moduleId' in config) {\r\n                var moduleId = config.moduleId;\r\n                if (moduleId === null) {\r\n                    viewModel = EmptyClass;\r\n                }\r\n                else {\r\n                    moduleId = Object(aurelia_path__WEBPACK_IMPORTED_MODULE_2__[\"relativeToFile\"])(moduleId, aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"Origin\"].get(router.container.viewModel.constructor).moduleId);\r\n                    if (/\\.html/i.test(moduleId)) {\r\n                        viewModel = createDynamicClass(moduleId);\r\n                    }\r\n                    else {\r\n                        viewModel = moduleId;\r\n                    }\r\n                }\r\n                return resolve(viewModel);\r\n            }\r\n            reject(new Error('Invalid route config. No \"moduleId\" found.'));\r\n        });\r\n    };\r\n    TemplatingRouteLoader.prototype.createChildContainer = function (router) {\r\n        var childContainer = router.container.createChild();\r\n        childContainer.registerSingleton(RouterViewLocator);\r\n        childContainer.getChildRouter = function () {\r\n            var childRouter;\r\n            childContainer.registerHandler(aurelia_router__WEBPACK_IMPORTED_MODULE_0__[\"Router\"], function () { return childRouter || (childRouter = router.createChild(childContainer)); });\r\n            return childContainer.get(aurelia_router__WEBPACK_IMPORTED_MODULE_0__[\"Router\"]);\r\n        };\r\n        return childContainer;\r\n    };\r\n    TemplatingRouteLoader.prototype.loadRoute = function (router, config, navInstruction) {\r\n        var _this = this;\r\n        return this\r\n            .resolveViewModel(router, config)\r\n            .then(function (viewModel) { return _this.compositionEngine.ensureViewModel({\r\n            viewModel: viewModel,\r\n            childContainer: _this.createChildContainer(router),\r\n            view: config.view || config.viewStrategy,\r\n            router: router\r\n        }); });\r\n    };\r\n    TemplatingRouteLoader.inject = [aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"CompositionEngine\"]];\r\n    return TemplatingRouteLoader;\r\n}(aurelia_router__WEBPACK_IMPORTED_MODULE_0__[\"RouteLoader\"]));\r\nfunction createDynamicClass(moduleId) {\r\n    var name = /([^\\/^\\?]+)\\.html/i.exec(moduleId)[1];\r\n    var DynamicClass = (function () {\r\n        function DynamicClass() {\r\n        }\r\n        DynamicClass.prototype.bind = function (bindingContext) {\r\n            this.$parent = bindingContext;\r\n        };\r\n        return DynamicClass;\r\n    }());\r\n    Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"customElement\"])(name)(DynamicClass);\r\n    Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"useView\"])(moduleId)(DynamicClass);\r\n    return DynamicClass;\r\n}\n\nvar logger = aurelia_logging__WEBPACK_IMPORTED_MODULE_7__[\"getLogger\"]('route-href');\r\nvar RouteHref = (function () {\r\n    function RouteHref(router, element) {\r\n        this.router = router;\r\n        this.element = element;\r\n        this.attribute = 'href';\r\n    }\r\n    RouteHref.inject = function () {\r\n        return [aurelia_router__WEBPACK_IMPORTED_MODULE_0__[\"Router\"], aurelia_pal__WEBPACK_IMPORTED_MODULE_6__[\"DOM\"].Element];\r\n    };\r\n    RouteHref.prototype.bind = function () {\r\n        this.isActive = true;\r\n        this.processChange();\r\n    };\r\n    RouteHref.prototype.unbind = function () {\r\n        this.isActive = false;\r\n    };\r\n    RouteHref.prototype.attributeChanged = function (value, previous) {\r\n        if (previous) {\r\n            this.element.removeAttribute(previous);\r\n        }\r\n        return this.processChange();\r\n    };\r\n    RouteHref.prototype.processChange = function () {\r\n        var _this = this;\r\n        return this.router\r\n            .ensureConfigured()\r\n            .then(function () {\r\n            if (!_this.isActive) {\r\n                return null;\r\n            }\r\n            var element = _this.element;\r\n            var href = _this.router.generate(_this.route, _this.params);\r\n            if (element.au.controller) {\r\n                element.au.controller.viewModel[_this.attribute] = href;\r\n            }\r\n            else {\r\n                element.setAttribute(_this.attribute, href);\r\n            }\r\n            return null;\r\n        })\r\n            .catch(function (reason) {\r\n            logger.error(reason);\r\n        });\r\n    };\r\n    RouteHref.$resource = {\r\n        type: 'attribute',\r\n        name: 'route-href',\r\n        bindables: [\r\n            { name: 'route', changeHandler: 'processChange', primaryProperty: true },\r\n            { name: 'params', changeHandler: 'processChange' },\r\n            'attribute'\r\n        ]\r\n    };\r\n    return RouteHref;\r\n}());\n\nfunction configure(config) {\r\n    config\r\n        .singleton(aurelia_router__WEBPACK_IMPORTED_MODULE_0__[\"RouteLoader\"], TemplatingRouteLoader)\r\n        .singleton(aurelia_router__WEBPACK_IMPORTED_MODULE_0__[\"Router\"], aurelia_router__WEBPACK_IMPORTED_MODULE_0__[\"AppRouter\"])\r\n        .globalResources(RouterView, RouteHref);\r\n    config.container.registerAlias(aurelia_router__WEBPACK_IMPORTED_MODULE_0__[\"Router\"], aurelia_router__WEBPACK_IMPORTED_MODULE_0__[\"AppRouter\"]);\r\n}\n\n\n//# sourceMappingURL=aurelia-templating-router.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXVyZWxpYS10ZW1wbGF0aW5nLXJvdXRlci5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9hdXJlbGlhLXRlbXBsYXRpbmctcm91dGVyL2Rpc3QvbmF0aXZlLW1vZHVsZXMvYXVyZWxpYS10ZW1wbGF0aW5nLXJvdXRlci5qcz9hYjMwIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFJvdXRlciwgUm91dGVMb2FkZXIsIEFwcFJvdXRlciB9IGZyb20gJ2F1cmVsaWEtcm91dGVyJztcbmltcG9ydCB7IE9yaWdpbiB9IGZyb20gJ2F1cmVsaWEtbWV0YWRhdGEnO1xuaW1wb3J0IHsgcmVsYXRpdmVUb0ZpbGUgfSBmcm9tICdhdXJlbGlhLXBhdGgnO1xuaW1wb3J0IHsgQmVoYXZpb3JJbnN0cnVjdGlvbiwgU2hhZG93RE9NLCBWaWV3U2xvdCwgVmlld0xvY2F0b3IsIENvbXBvc2l0aW9uVHJhbnNhY3Rpb24sIENvbXBvc2l0aW9uRW5naW5lLCBTd2FwU3RyYXRlZ2llcywgaW5saW5lVmlldywgY3VzdG9tRWxlbWVudCwgdXNlVmlldyB9IGZyb20gJ2F1cmVsaWEtdGVtcGxhdGluZyc7XG5pbXBvcnQgeyBDb250YWluZXIgfSBmcm9tICdhdXJlbGlhLWRlcGVuZGVuY3ktaW5qZWN0aW9uJztcbmltcG9ydCB7IGNyZWF0ZU92ZXJyaWRlQ29udGV4dCB9IGZyb20gJ2F1cmVsaWEtYmluZGluZyc7XG5pbXBvcnQgeyBET00gfSBmcm9tICdhdXJlbGlhLXBhbCc7XG5pbXBvcnQgKiBhcyBMb2dNYW5hZ2VyIGZyb20gJ2F1cmVsaWEtbG9nZ2luZyc7XG5cbi8qISAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxyXG5Db3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi5cclxuXHJcblBlcm1pc3Npb24gdG8gdXNlLCBjb3B5LCBtb2RpZnksIGFuZC9vciBkaXN0cmlidXRlIHRoaXMgc29mdHdhcmUgZm9yIGFueVxyXG5wdXJwb3NlIHdpdGggb3Igd2l0aG91dCBmZWUgaXMgaGVyZWJ5IGdyYW50ZWQuXHJcblxyXG5USEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiIEFORCBUSEUgQVVUSE9SIERJU0NMQUlNUyBBTEwgV0FSUkFOVElFUyBXSVRIXHJcblJFR0FSRCBUTyBUSElTIFNPRlRXQVJFIElOQ0xVRElORyBBTEwgSU1QTElFRCBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWVxyXG5BTkQgRklUTkVTUy4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUiBCRSBMSUFCTEUgRk9SIEFOWSBTUEVDSUFMLCBESVJFQ1QsXHJcbklORElSRUNULCBPUiBDT05TRVFVRU5USUFMIERBTUFHRVMgT1IgQU5ZIERBTUFHRVMgV0hBVFNPRVZFUiBSRVNVTFRJTkcgRlJPTVxyXG5MT1NTIE9GIFVTRSwgREFUQSBPUiBQUk9GSVRTLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgTkVHTElHRU5DRSBPUlxyXG5PVEhFUiBUT1JUSU9VUyBBQ1RJT04sIEFSSVNJTkcgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgVVNFIE9SXHJcblBFUkZPUk1BTkNFIE9GIFRISVMgU09GVFdBUkUuXHJcbioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqICovXHJcbi8qIGdsb2JhbCBSZWZsZWN0LCBQcm9taXNlICovXHJcblxyXG52YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uKGQsIGIpIHtcclxuICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcclxuICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XHJcbiAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGIsIHApKSBkW3BdID0gYltwXTsgfTtcclxuICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG59O1xyXG5cclxuZnVuY3Rpb24gX19leHRlbmRzKGQsIGIpIHtcclxuICAgIGlmICh0eXBlb2YgYiAhPT0gXCJmdW5jdGlvblwiICYmIGIgIT09IG51bGwpXHJcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNsYXNzIGV4dGVuZHMgdmFsdWUgXCIgKyBTdHJpbmcoYikgKyBcIiBpcyBub3QgYSBjb25zdHJ1Y3RvciBvciBudWxsXCIpO1xyXG4gICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcclxuICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxyXG4gICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xyXG59XG5cbnZhciBFbXB0eUxheW91dFZpZXdNb2RlbCA9IChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBFbXB0eUxheW91dFZpZXdNb2RlbCgpIHtcclxuICAgIH1cclxuICAgIHJldHVybiBFbXB0eUxheW91dFZpZXdNb2RlbDtcclxufSgpKTtcclxudmFyIFJvdXRlclZpZXcgPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gUm91dGVyVmlldyhlbGVtZW50LCBjb250YWluZXIsIHZpZXdTbG90LCByb3V0ZXIsIHZpZXdMb2NhdG9yLCBjb21wb3NpdGlvblRyYW5zYWN0aW9uLCBjb21wb3NpdGlvbkVuZ2luZSkge1xyXG4gICAgICAgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XHJcbiAgICAgICAgdGhpcy5jb250YWluZXIgPSBjb250YWluZXI7XHJcbiAgICAgICAgdGhpcy52aWV3U2xvdCA9IHZpZXdTbG90O1xyXG4gICAgICAgIHRoaXMucm91dGVyID0gcm91dGVyO1xyXG4gICAgICAgIHRoaXMudmlld0xvY2F0b3IgPSB2aWV3TG9jYXRvcjtcclxuICAgICAgICB0aGlzLmNvbXBvc2l0aW9uVHJhbnNhY3Rpb24gPSBjb21wb3NpdGlvblRyYW5zYWN0aW9uO1xyXG4gICAgICAgIHRoaXMuY29tcG9zaXRpb25FbmdpbmUgPSBjb21wb3NpdGlvbkVuZ2luZTtcclxuICAgICAgICB0aGlzLnJvdXRlci5yZWdpc3RlclZpZXdQb3J0KHRoaXMsIHRoaXMuZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ25hbWUnKSk7XHJcbiAgICAgICAgaWYgKCEoJ2luaXRpYWxDb21wb3NpdGlvbicgaW4gY29tcG9zaXRpb25UcmFuc2FjdGlvbikpIHtcclxuICAgICAgICAgICAgY29tcG9zaXRpb25UcmFuc2FjdGlvbi5pbml0aWFsQ29tcG9zaXRpb24gPSB0cnVlO1xyXG4gICAgICAgICAgICB0aGlzLmNvbXBvc2l0aW9uVHJhbnNhY3Rpb25Ob3RpZmllciA9IGNvbXBvc2l0aW9uVHJhbnNhY3Rpb24uZW5saXN0KCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgUm91dGVyVmlldy5pbmplY3QgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIFtET00uRWxlbWVudCwgQ29udGFpbmVyLCBWaWV3U2xvdCwgUm91dGVyLCBWaWV3TG9jYXRvciwgQ29tcG9zaXRpb25UcmFuc2FjdGlvbiwgQ29tcG9zaXRpb25FbmdpbmVdO1xyXG4gICAgfTtcclxuICAgIFJvdXRlclZpZXcucHJvdG90eXBlLmNyZWF0ZWQgPSBmdW5jdGlvbiAob3duaW5nVmlldykge1xyXG4gICAgICAgIHRoaXMub3duaW5nVmlldyA9IG93bmluZ1ZpZXc7XHJcbiAgICB9O1xyXG4gICAgUm91dGVyVmlldy5wcm90b3R5cGUuYmluZCA9IGZ1bmN0aW9uIChiaW5kaW5nQ29udGV4dCwgb3ZlcnJpZGVDb250ZXh0KSB7XHJcbiAgICAgICAgdGhpcy5jb250YWluZXIudmlld01vZGVsID0gYmluZGluZ0NvbnRleHQ7XHJcbiAgICAgICAgdGhpcy5vdmVycmlkZUNvbnRleHQgPSBvdmVycmlkZUNvbnRleHQ7XHJcbiAgICB9O1xyXG4gICAgUm91dGVyVmlldy5wcm90b3R5cGUucHJvY2VzcyA9IGZ1bmN0aW9uICgkdmlld1BvcnRJbnN0cnVjdGlvbiwgd2FpdFRvU3dhcCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIHZpZXdQb3J0SW5zdHJ1Y3Rpb24gPSAkdmlld1BvcnRJbnN0cnVjdGlvbjtcclxuICAgICAgICB2YXIgY29tcG9uZW50ID0gdmlld1BvcnRJbnN0cnVjdGlvbi5jb21wb25lbnQ7XHJcbiAgICAgICAgdmFyIGNoaWxkQ29udGFpbmVyID0gY29tcG9uZW50LmNoaWxkQ29udGFpbmVyO1xyXG4gICAgICAgIHZhciB2aWV3TW9kZWwgPSBjb21wb25lbnQudmlld01vZGVsO1xyXG4gICAgICAgIHZhciB2aWV3TW9kZWxSZXNvdXJjZSA9IGNvbXBvbmVudC52aWV3TW9kZWxSZXNvdXJjZTtcclxuICAgICAgICB2YXIgbWV0YWRhdGEgPSB2aWV3TW9kZWxSZXNvdXJjZS5tZXRhZGF0YTtcclxuICAgICAgICB2YXIgY29uZmlnID0gY29tcG9uZW50LnJvdXRlci5jdXJyZW50SW5zdHJ1Y3Rpb24uY29uZmlnO1xyXG4gICAgICAgIHZhciB2aWV3UG9ydENvbmZpZyA9IGNvbmZpZy52aWV3UG9ydHMgPyAoY29uZmlnLnZpZXdQb3J0c1t2aWV3UG9ydEluc3RydWN0aW9uLm5hbWVdIHx8IHt9KSA6IHt9O1xyXG4gICAgICAgIGNoaWxkQ29udGFpbmVyLmdldChSb3V0ZXJWaWV3TG9jYXRvcikuX25vdGlmeSh0aGlzKTtcclxuICAgICAgICB2YXIgbGF5b3V0SW5zdHJ1Y3Rpb24gPSB7XHJcbiAgICAgICAgICAgIHZpZXdNb2RlbDogdmlld1BvcnRDb25maWcubGF5b3V0Vmlld01vZGVsIHx8IGNvbmZpZy5sYXlvdXRWaWV3TW9kZWwgfHwgdGhpcy5sYXlvdXRWaWV3TW9kZWwsXHJcbiAgICAgICAgICAgIHZpZXc6IHZpZXdQb3J0Q29uZmlnLmxheW91dFZpZXcgfHwgY29uZmlnLmxheW91dFZpZXcgfHwgdGhpcy5sYXlvdXRWaWV3LFxyXG4gICAgICAgICAgICBtb2RlbDogdmlld1BvcnRDb25maWcubGF5b3V0TW9kZWwgfHwgY29uZmlnLmxheW91dE1vZGVsIHx8IHRoaXMubGF5b3V0TW9kZWwsXHJcbiAgICAgICAgICAgIHJvdXRlcjogdmlld1BvcnRJbnN0cnVjdGlvbi5jb21wb25lbnQucm91dGVyLFxyXG4gICAgICAgICAgICBjaGlsZENvbnRhaW5lcjogY2hpbGRDb250YWluZXIsXHJcbiAgICAgICAgICAgIHZpZXdTbG90OiB0aGlzLnZpZXdTbG90XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgdmlld1N0cmF0ZWd5ID0gdGhpcy52aWV3TG9jYXRvci5nZXRWaWV3U3RyYXRlZ3koY29tcG9uZW50LnZpZXcgfHwgdmlld01vZGVsKTtcclxuICAgICAgICBpZiAodmlld1N0cmF0ZWd5ICYmIGNvbXBvbmVudC52aWV3KSB7XHJcbiAgICAgICAgICAgIHZpZXdTdHJhdGVneS5tYWtlUmVsYXRpdmVUbyhPcmlnaW4uZ2V0KGNvbXBvbmVudC5yb3V0ZXIuY29udGFpbmVyLnZpZXdNb2RlbC5jb25zdHJ1Y3RvcikubW9kdWxlSWQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbWV0YWRhdGFcclxuICAgICAgICAgICAgLmxvYWQoY2hpbGRDb250YWluZXIsIHZpZXdNb2RlbFJlc291cmNlLnZhbHVlLCBudWxsLCB2aWV3U3RyYXRlZ3ksIHRydWUpXHJcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICh2aWV3RmFjdG9yeSkge1xyXG4gICAgICAgICAgICBpZiAoIV90aGlzLmNvbXBvc2l0aW9uVHJhbnNhY3Rpb25Ob3RpZmllcikge1xyXG4gICAgICAgICAgICAgICAgX3RoaXMuY29tcG9zaXRpb25UcmFuc2FjdGlvbk93bmVyc2hpcFRva2VuID0gX3RoaXMuY29tcG9zaXRpb25UcmFuc2FjdGlvbi50cnlDYXB0dXJlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGxheW91dEluc3RydWN0aW9uLnZpZXdNb2RlbCB8fCBsYXlvdXRJbnN0cnVjdGlvbi52aWV3KSB7XHJcbiAgICAgICAgICAgICAgICB2aWV3UG9ydEluc3RydWN0aW9uLmxheW91dEluc3RydWN0aW9uID0gbGF5b3V0SW5zdHJ1Y3Rpb247XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIHZpZXdQb3J0Q29tcG9uZW50QmVoYXZpb3JJbnN0cnVjdGlvbiA9IEJlaGF2aW9ySW5zdHJ1Y3Rpb24uZHluYW1pYyhfdGhpcy5lbGVtZW50LCB2aWV3TW9kZWwsIHZpZXdGYWN0b3J5KTtcclxuICAgICAgICAgICAgdmlld1BvcnRJbnN0cnVjdGlvbi5jb250cm9sbGVyID0gbWV0YWRhdGEuY3JlYXRlKGNoaWxkQ29udGFpbmVyLCB2aWV3UG9ydENvbXBvbmVudEJlaGF2aW9ySW5zdHJ1Y3Rpb24pO1xyXG4gICAgICAgICAgICBpZiAod2FpdFRvU3dhcCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgX3RoaXMuc3dhcCh2aWV3UG9ydEluc3RydWN0aW9uKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBSb3V0ZXJWaWV3LnByb3RvdHlwZS5zd2FwID0gZnVuY3Rpb24gKCR2aWV3UG9ydEluc3RydWN0aW9uKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgdmlld1BvcnRJbnN0cnVjdGlvbiA9ICR2aWV3UG9ydEluc3RydWN0aW9uO1xyXG4gICAgICAgIHZhciB2aWV3UG9ydENvbnRyb2xsZXIgPSB2aWV3UG9ydEluc3RydWN0aW9uLmNvbnRyb2xsZXI7XHJcbiAgICAgICAgdmFyIGxheW91dEluc3RydWN0aW9uID0gdmlld1BvcnRJbnN0cnVjdGlvbi5sYXlvdXRJbnN0cnVjdGlvbjtcclxuICAgICAgICB2YXIgcHJldmlvdXNWaWV3ID0gdGhpcy52aWV3O1xyXG4gICAgICAgIHZhciB3b3JrID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgc3dhcFN0cmF0ZWd5ID0gU3dhcFN0cmF0ZWdpZXNbX3RoaXMuc3dhcE9yZGVyXSB8fCBTd2FwU3RyYXRlZ2llcy5hZnRlcjtcclxuICAgICAgICAgICAgdmFyIHZpZXdTbG90ID0gX3RoaXMudmlld1Nsb3Q7XHJcbiAgICAgICAgICAgIHN3YXBTdHJhdGVneSh2aWV3U2xvdCwgcHJldmlvdXNWaWV3LCBmdW5jdGlvbiAoKSB7IHJldHVybiBQcm9taXNlLnJlc29sdmUodmlld1Nsb3QuYWRkKF90aGlzLnZpZXcpKTsgfSkudGhlbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5fbm90aWZ5KCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIHJlYWR5ID0gZnVuY3Rpb24gKG93bmluZ1ZpZXdfb3JfbGF5b3V0Vmlldykge1xyXG4gICAgICAgICAgICB2aWV3UG9ydENvbnRyb2xsZXIuYXV0b21hdGUoX3RoaXMub3ZlcnJpZGVDb250ZXh0LCBvd25pbmdWaWV3X29yX2xheW91dFZpZXcpO1xyXG4gICAgICAgICAgICB2YXIgdHJhbnNhY3Rpb25Pd25lclNoaXBUb2tlbiA9IF90aGlzLmNvbXBvc2l0aW9uVHJhbnNhY3Rpb25Pd25lcnNoaXBUb2tlbjtcclxuICAgICAgICAgICAgaWYgKHRyYW5zYWN0aW9uT3duZXJTaGlwVG9rZW4pIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cmFuc2FjdGlvbk93bmVyU2hpcFRva2VuXHJcbiAgICAgICAgICAgICAgICAgICAgLndhaXRGb3JDb21wb3NpdGlvbkNvbXBsZXRlKClcclxuICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuY29tcG9zaXRpb25UcmFuc2FjdGlvbk93bmVyc2hpcFRva2VuID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gd29yaygpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHdvcmsoKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIGlmIChsYXlvdXRJbnN0cnVjdGlvbikge1xyXG4gICAgICAgICAgICBpZiAoIWxheW91dEluc3RydWN0aW9uLnZpZXdNb2RlbCkge1xyXG4gICAgICAgICAgICAgICAgbGF5b3V0SW5zdHJ1Y3Rpb24udmlld01vZGVsID0gbmV3IEVtcHR5TGF5b3V0Vmlld01vZGVsKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29tcG9zaXRpb25FbmdpbmVcclxuICAgICAgICAgICAgICAgIC5jcmVhdGVDb250cm9sbGVyKGxheW91dEluc3RydWN0aW9uKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGxheW91dENvbnRyb2xsZXIpIHtcclxuICAgICAgICAgICAgICAgIHZhciBsYXlvdXRWaWV3ID0gbGF5b3V0Q29udHJvbGxlci52aWV3O1xyXG4gICAgICAgICAgICAgICAgU2hhZG93RE9NLmRpc3RyaWJ1dGVWaWV3KHZpZXdQb3J0Q29udHJvbGxlci52aWV3LCBsYXlvdXRDb250cm9sbGVyLnNsb3RzIHx8IGxheW91dFZpZXcuc2xvdHMpO1xyXG4gICAgICAgICAgICAgICAgbGF5b3V0Q29udHJvbGxlci5hdXRvbWF0ZShjcmVhdGVPdmVycmlkZUNvbnRleHQobGF5b3V0SW5zdHJ1Y3Rpb24udmlld01vZGVsKSwgX3RoaXMub3duaW5nVmlldyk7XHJcbiAgICAgICAgICAgICAgICBsYXlvdXRWaWV3LmNoaWxkcmVuLnB1c2godmlld1BvcnRDb250cm9sbGVyLnZpZXcpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGxheW91dFZpZXcgfHwgbGF5b3V0Q29udHJvbGxlcjtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChuZXdWaWV3KSB7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy52aWV3ID0gbmV3VmlldztcclxuICAgICAgICAgICAgICAgIHJldHVybiByZWFkeShuZXdWaWV3KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMudmlldyA9IHZpZXdQb3J0Q29udHJvbGxlci52aWV3O1xyXG4gICAgICAgIHJldHVybiByZWFkeSh0aGlzLm93bmluZ1ZpZXcpO1xyXG4gICAgfTtcclxuICAgIFJvdXRlclZpZXcucHJvdG90eXBlLl9ub3RpZnkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIG5vdGlmaWVyID0gdGhpcy5jb21wb3NpdGlvblRyYW5zYWN0aW9uTm90aWZpZXI7XHJcbiAgICAgICAgaWYgKG5vdGlmaWVyKSB7XHJcbiAgICAgICAgICAgIG5vdGlmaWVyLmRvbmUoKTtcclxuICAgICAgICAgICAgdGhpcy5jb21wb3NpdGlvblRyYW5zYWN0aW9uTm90aWZpZXIgPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBSb3V0ZXJWaWV3LiR2aWV3ID0gbnVsbDtcclxuICAgIFJvdXRlclZpZXcuJHJlc291cmNlID0ge1xyXG4gICAgICAgIG5hbWU6ICdyb3V0ZXItdmlldycsXHJcbiAgICAgICAgYmluZGFibGVzOiBbJ3N3YXBPcmRlcicsICdsYXlvdXRWaWV3JywgJ2xheW91dFZpZXdNb2RlbCcsICdsYXlvdXRNb2RlbCcsICdpbmhlcml0LWJpbmRpbmctY29udGV4dCddXHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFJvdXRlclZpZXc7XHJcbn0oKSk7XHJcbnZhciBSb3V0ZXJWaWV3TG9jYXRvciA9IChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBSb3V0ZXJWaWV3TG9jYXRvcigpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMucHJvbWlzZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJldHVybiBfdGhpcy5yZXNvbHZlID0gcmVzb2x2ZTsgfSk7XHJcbiAgICB9XHJcbiAgICBSb3V0ZXJWaWV3TG9jYXRvci5wcm90b3R5cGUuZmluZE5lYXJlc3QgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucHJvbWlzZTtcclxuICAgIH07XHJcbiAgICBSb3V0ZXJWaWV3TG9jYXRvci5wcm90b3R5cGUuX25vdGlmeSA9IGZ1bmN0aW9uIChyb3V0ZXJWaWV3KSB7XHJcbiAgICAgICAgdGhpcy5yZXNvbHZlKHJvdXRlclZpZXcpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBSb3V0ZXJWaWV3TG9jYXRvcjtcclxufSgpKTtcblxudmFyIEVtcHR5Q2xhc3MgPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRW1wdHlDbGFzcygpIHtcclxuICAgIH1cclxuICAgIHJldHVybiBFbXB0eUNsYXNzO1xyXG59KCkpO1xyXG5pbmxpbmVWaWV3KCc8dGVtcGxhdGU+PC90ZW1wbGF0ZT4nKShFbXB0eUNsYXNzKTtcclxudmFyIFRlbXBsYXRpbmdSb3V0ZUxvYWRlciA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICBfX2V4dGVuZHMoVGVtcGxhdGluZ1JvdXRlTG9hZGVyLCBfc3VwZXIpO1xyXG4gICAgZnVuY3Rpb24gVGVtcGxhdGluZ1JvdXRlTG9hZGVyKGNvbXBvc2l0aW9uRW5naW5lKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcclxuICAgICAgICBfdGhpcy5jb21wb3NpdGlvbkVuZ2luZSA9IGNvbXBvc2l0aW9uRW5naW5lO1xyXG4gICAgICAgIHJldHVybiBfdGhpcztcclxuICAgIH1cclxuICAgIFRlbXBsYXRpbmdSb3V0ZUxvYWRlci5wcm90b3R5cGUucmVzb2x2ZVZpZXdNb2RlbCA9IGZ1bmN0aW9uIChyb3V0ZXIsIGNvbmZpZykge1xyXG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgICAgIHZhciB2aWV3TW9kZWw7XHJcbiAgICAgICAgICAgIGlmICgnbW9kdWxlSWQnIGluIGNvbmZpZykge1xyXG4gICAgICAgICAgICAgICAgdmFyIG1vZHVsZUlkID0gY29uZmlnLm1vZHVsZUlkO1xyXG4gICAgICAgICAgICAgICAgaWYgKG1vZHVsZUlkID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmlld01vZGVsID0gRW1wdHlDbGFzcztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIG1vZHVsZUlkID0gcmVsYXRpdmVUb0ZpbGUobW9kdWxlSWQsIE9yaWdpbi5nZXQocm91dGVyLmNvbnRhaW5lci52aWV3TW9kZWwuY29uc3RydWN0b3IpLm1vZHVsZUlkKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoL1xcLmh0bWwvaS50ZXN0KG1vZHVsZUlkKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2aWV3TW9kZWwgPSBjcmVhdGVEeW5hbWljQ2xhc3MobW9kdWxlSWQpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmlld01vZGVsID0gbW9kdWxlSWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc29sdmUodmlld01vZGVsKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZWplY3QobmV3IEVycm9yKCdJbnZhbGlkIHJvdXRlIGNvbmZpZy4gTm8gXCJtb2R1bGVJZFwiIGZvdW5kLicpKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBUZW1wbGF0aW5nUm91dGVMb2FkZXIucHJvdG90eXBlLmNyZWF0ZUNoaWxkQ29udGFpbmVyID0gZnVuY3Rpb24gKHJvdXRlcikge1xyXG4gICAgICAgIHZhciBjaGlsZENvbnRhaW5lciA9IHJvdXRlci5jb250YWluZXIuY3JlYXRlQ2hpbGQoKTtcclxuICAgICAgICBjaGlsZENvbnRhaW5lci5yZWdpc3RlclNpbmdsZXRvbihSb3V0ZXJWaWV3TG9jYXRvcik7XHJcbiAgICAgICAgY2hpbGRDb250YWluZXIuZ2V0Q2hpbGRSb3V0ZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBjaGlsZFJvdXRlcjtcclxuICAgICAgICAgICAgY2hpbGRDb250YWluZXIucmVnaXN0ZXJIYW5kbGVyKFJvdXRlciwgZnVuY3Rpb24gKCkgeyByZXR1cm4gY2hpbGRSb3V0ZXIgfHwgKGNoaWxkUm91dGVyID0gcm91dGVyLmNyZWF0ZUNoaWxkKGNoaWxkQ29udGFpbmVyKSk7IH0pO1xyXG4gICAgICAgICAgICByZXR1cm4gY2hpbGRDb250YWluZXIuZ2V0KFJvdXRlcik7XHJcbiAgICAgICAgfTtcclxuICAgICAgICByZXR1cm4gY2hpbGRDb250YWluZXI7XHJcbiAgICB9O1xyXG4gICAgVGVtcGxhdGluZ1JvdXRlTG9hZGVyLnByb3RvdHlwZS5sb2FkUm91dGUgPSBmdW5jdGlvbiAocm91dGVyLCBjb25maWcsIG5hdkluc3RydWN0aW9uKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICByZXR1cm4gdGhpc1xyXG4gICAgICAgICAgICAucmVzb2x2ZVZpZXdNb2RlbChyb3V0ZXIsIGNvbmZpZylcclxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHZpZXdNb2RlbCkgeyByZXR1cm4gX3RoaXMuY29tcG9zaXRpb25FbmdpbmUuZW5zdXJlVmlld01vZGVsKHtcclxuICAgICAgICAgICAgdmlld01vZGVsOiB2aWV3TW9kZWwsXHJcbiAgICAgICAgICAgIGNoaWxkQ29udGFpbmVyOiBfdGhpcy5jcmVhdGVDaGlsZENvbnRhaW5lcihyb3V0ZXIpLFxyXG4gICAgICAgICAgICB2aWV3OiBjb25maWcudmlldyB8fCBjb25maWcudmlld1N0cmF0ZWd5LFxyXG4gICAgICAgICAgICByb3V0ZXI6IHJvdXRlclxyXG4gICAgICAgIH0pOyB9KTtcclxuICAgIH07XHJcbiAgICBUZW1wbGF0aW5nUm91dGVMb2FkZXIuaW5qZWN0ID0gW0NvbXBvc2l0aW9uRW5naW5lXTtcclxuICAgIHJldHVybiBUZW1wbGF0aW5nUm91dGVMb2FkZXI7XHJcbn0oUm91dGVMb2FkZXIpKTtcclxuZnVuY3Rpb24gY3JlYXRlRHluYW1pY0NsYXNzKG1vZHVsZUlkKSB7XHJcbiAgICB2YXIgbmFtZSA9IC8oW15cXC9eXFw/XSspXFwuaHRtbC9pLmV4ZWMobW9kdWxlSWQpWzFdO1xyXG4gICAgdmFyIER5bmFtaWNDbGFzcyA9IChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgZnVuY3Rpb24gRHluYW1pY0NsYXNzKCkge1xyXG4gICAgICAgIH1cclxuICAgICAgICBEeW5hbWljQ2xhc3MucHJvdG90eXBlLmJpbmQgPSBmdW5jdGlvbiAoYmluZGluZ0NvbnRleHQpIHtcclxuICAgICAgICAgICAgdGhpcy4kcGFyZW50ID0gYmluZGluZ0NvbnRleHQ7XHJcbiAgICAgICAgfTtcclxuICAgICAgICByZXR1cm4gRHluYW1pY0NsYXNzO1xyXG4gICAgfSgpKTtcclxuICAgIGN1c3RvbUVsZW1lbnQobmFtZSkoRHluYW1pY0NsYXNzKTtcclxuICAgIHVzZVZpZXcobW9kdWxlSWQpKER5bmFtaWNDbGFzcyk7XHJcbiAgICByZXR1cm4gRHluYW1pY0NsYXNzO1xyXG59XG5cbnZhciBsb2dnZXIgPSBMb2dNYW5hZ2VyLmdldExvZ2dlcigncm91dGUtaHJlZicpO1xyXG52YXIgUm91dGVIcmVmID0gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFJvdXRlSHJlZihyb3V0ZXIsIGVsZW1lbnQpIHtcclxuICAgICAgICB0aGlzLnJvdXRlciA9IHJvdXRlcjtcclxuICAgICAgICB0aGlzLmVsZW1lbnQgPSBlbGVtZW50O1xyXG4gICAgICAgIHRoaXMuYXR0cmlidXRlID0gJ2hyZWYnO1xyXG4gICAgfVxyXG4gICAgUm91dGVIcmVmLmluamVjdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gW1JvdXRlciwgRE9NLkVsZW1lbnRdO1xyXG4gICAgfTtcclxuICAgIFJvdXRlSHJlZi5wcm90b3R5cGUuYmluZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLmlzQWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLnByb2Nlc3NDaGFuZ2UoKTtcclxuICAgIH07XHJcbiAgICBSb3V0ZUhyZWYucHJvdG90eXBlLnVuYmluZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLmlzQWN0aXZlID0gZmFsc2U7XHJcbiAgICB9O1xyXG4gICAgUm91dGVIcmVmLnByb3RvdHlwZS5hdHRyaWJ1dGVDaGFuZ2VkID0gZnVuY3Rpb24gKHZhbHVlLCBwcmV2aW91cykge1xyXG4gICAgICAgIGlmIChwcmV2aW91cykge1xyXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKHByZXZpb3VzKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucHJvY2Vzc0NoYW5nZSgpO1xyXG4gICAgfTtcclxuICAgIFJvdXRlSHJlZi5wcm90b3R5cGUucHJvY2Vzc0NoYW5nZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiB0aGlzLnJvdXRlclxyXG4gICAgICAgICAgICAuZW5zdXJlQ29uZmlndXJlZCgpXHJcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKCFfdGhpcy5pc0FjdGl2ZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIGVsZW1lbnQgPSBfdGhpcy5lbGVtZW50O1xyXG4gICAgICAgICAgICB2YXIgaHJlZiA9IF90aGlzLnJvdXRlci5nZW5lcmF0ZShfdGhpcy5yb3V0ZSwgX3RoaXMucGFyYW1zKTtcclxuICAgICAgICAgICAgaWYgKGVsZW1lbnQuYXUuY29udHJvbGxlcikge1xyXG4gICAgICAgICAgICAgICAgZWxlbWVudC5hdS5jb250cm9sbGVyLnZpZXdNb2RlbFtfdGhpcy5hdHRyaWJ1dGVdID0gaHJlZjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKF90aGlzLmF0dHJpYnV0ZSwgaHJlZik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uIChyZWFzb24pIHtcclxuICAgICAgICAgICAgbG9nZ2VyLmVycm9yKHJlYXNvbik7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgUm91dGVIcmVmLiRyZXNvdXJjZSA9IHtcclxuICAgICAgICB0eXBlOiAnYXR0cmlidXRlJyxcclxuICAgICAgICBuYW1lOiAncm91dGUtaHJlZicsXHJcbiAgICAgICAgYmluZGFibGVzOiBbXHJcbiAgICAgICAgICAgIHsgbmFtZTogJ3JvdXRlJywgY2hhbmdlSGFuZGxlcjogJ3Byb2Nlc3NDaGFuZ2UnLCBwcmltYXJ5UHJvcGVydHk6IHRydWUgfSxcclxuICAgICAgICAgICAgeyBuYW1lOiAncGFyYW1zJywgY2hhbmdlSGFuZGxlcjogJ3Byb2Nlc3NDaGFuZ2UnIH0sXHJcbiAgICAgICAgICAgICdhdHRyaWJ1dGUnXHJcbiAgICAgICAgXVxyXG4gICAgfTtcclxuICAgIHJldHVybiBSb3V0ZUhyZWY7XHJcbn0oKSk7XG5cbmZ1bmN0aW9uIGNvbmZpZ3VyZShjb25maWcpIHtcclxuICAgIGNvbmZpZ1xyXG4gICAgICAgIC5zaW5nbGV0b24oUm91dGVMb2FkZXIsIFRlbXBsYXRpbmdSb3V0ZUxvYWRlcilcclxuICAgICAgICAuc2luZ2xldG9uKFJvdXRlciwgQXBwUm91dGVyKVxyXG4gICAgICAgIC5nbG9iYWxSZXNvdXJjZXMoUm91dGVyVmlldywgUm91dGVIcmVmKTtcclxuICAgIGNvbmZpZy5jb250YWluZXIucmVnaXN0ZXJBbGlhcyhSb3V0ZXIsIEFwcFJvdXRlcik7XHJcbn1cblxuZXhwb3J0IHsgUm91dGVIcmVmLCBSb3V0ZXJWaWV3LCBSb3V0ZXJWaWV3TG9jYXRvciwgVGVtcGxhdGluZ1JvdXRlTG9hZGVyLCBjb25maWd1cmUgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWF1cmVsaWEtdGVtcGxhdGluZy1yb3V0ZXIuanMubWFwXG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///aurelia-templating-router\n");

/***/ })

}]);